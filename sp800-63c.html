<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
    <link rel="canonical" href="/800-63-4/sp800-63c.html">

    <!-- Google Analytics -->
    <!--<script type="text/javascript" id="_fed_an_js_tag" src="http://www.nist.gov/js/federated-analytics.all.min.js?agency=NIST&subagency=mml&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script> -->
    <!-- DAP Analytics -->
    <script type="text/javascript" id="_fed_an_ua_tag"
            src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&subagency=NIST&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>

	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
	<script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript"></script>
	<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
	<script src="https://unpkg.com/simple-jekyll-search/dest/simple-jekyll-search.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/800-63-4/static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTStyle.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTPages.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <title>NIST Special Publication 800-63C</title>
    <meta property="og:title" content="NIST Special Publication 800-63C"/>
    

    
    <meta name="description" content="NIST Special Publication 800-63C">
    <meta property="og:description" content="NIST Special Publication 800-63C"/>
    
</head>


<body>

<nav class="navbar navbar-default navbar-fixed-left" role="navigation">
	<ul class="nav navbar-nav">
      <li id="search-box">
        <input type="text" id="search-input" placeholder="Search..." onFocus="loadSearch()">
        <ul id="results-container"></ul>
      </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/">Home</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63.html">SP 800-63</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63a.html">SP 800-63A</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63b.html">SP 800-63B</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="active">
          
              <a href="/800-63-4/sp800-63c.html">SP 800-63C</a>
          
          
          
        
            
            
            
            <ul class="subnav">
            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#abstract">Abstract</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#reviewers">Reviewers</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#preface">Preface</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#introduction"><span class="section">1</span>Introduction</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#fal"><span class="section">2</span>FAL</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#common"><span class="section">3</span>Federation</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#GenIdP"><span class="section">4</span>General-Purpose IdP</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#wallet"><span class="section">5</span>Wallets</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#security"><span class="section">6</span>Security</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#privacy"><span class="section">7</span>Privacy</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#usability"><span class="section">8</span>Usability</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#equity"><span class="section">9</span>Equity</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#examples"><span class="section">10</span>Examples</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#references">References</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#abbr"><span class="section">A</span>Abbreviations</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#def-and-acr"><span class="section">B</span>Glossary</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c.html#changelog"><span class="section">C</span>Changelog</a></li>
                
              
              

            
          
            </ul>
          
          
          
        </li>
      
      
      
  </ul>

</nav>


<div class="page-switch">

View this document as: <b>a single page</b> | <a href="/800-63-4/sp800-63c/introduction/">multiple pages</a>.

</div>

<div class="container">
  <div class="row">





<p>Wed, 28 Aug 2024 20:39:12 -0500</p>

<h1 id="abstract">
  
  
    ABSTRACT <a href="#abstract" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p>This guideline focuses on the use of federated identity and the use of assertions to implement identity federations. Federation allows a given credential service provider to provide authentication attributes and (optionally) subscriber attributes to a number of separately-administered relying parties. Similarly, relying parties may use more than one credential service provider. The guidelines are not intended to constrain the development or use of standards outside of this purpose. This publication supersedes NIST Special Publication (SP) 800-63C.</p>
<h1 id="keywords">
  
  
    Keywords <a href="#keywords" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p>assertions; authentication; credential service provider; digital authentication; electronic authentication; electronic credentials; federations.</p>

<h1 id="reviewers" class="no_toc">
  
  
    Note to Reviewers <a href="#reviewers" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p>In December 2022, NIST released the Initial Public Draft (IPD) of SP 800-63, Revision 4. Over the course of a 119-day public comment period, the authors received exceptional feedback from a broad community of interested entities and individuals. The input from nearly 4,000 specific comments has helped advance the improvement of these Digital Identity Guidelines in a manner that supports NIST’s critical goals of providing foundational risk management processes and requirements that enable the implementation of secure, private, equitable, and accessible identity systems. Based on this initial wave of feedback, several substantive changes have been made across all of the volumes. These changes include but are not limited to the following:</p>

<ol>
  <li>Updated text and context setting for risk management. Specifically, the authors have modified the process defined in the IPD to include a context-setting step of defining and understanding the online service that the organization is offering and intending to potentially protect with identity systems.</li>
  <li>Added recommended continuous evaluation metrics. The continuous improvement section introduced by the IPD has been expanded to include a set of recommended metrics for holistically evaluating identity solution performance. These are recommended due to the complexities of data streams and variances in solution deployments.</li>
  <li>Expanded fraud requirements and recommendations. Programmatic fraud management requirements for credential service providers and relying parties now address issues and challenges that may result from the implementation of fraud checks.</li>
  <li>Restructured the identity proofing controls. There is a new taxonomy and structure for the requirements at each assurance level based on the means of providing the proofing: Remote Unattended, Remote Attended (e.g., video session), Onsite Unattended (e.g., kiosk), and Onsite Attended (e.g., in-person).</li>
  <li>Integrated syncable authenticators. In April 2024, NIST published interim guidance for syncable authenticators. This guidance has been integrated into SP 800-63B as normative text and is provided for public feedback as part of the Revision 4 volume set.</li>
  <li>Added user-controlled wallets to the federation model. Digital wallets and credentials (called “attribute bundles” in SP 800-63C) are seeing increased attention and adoption. At their core, they function like a federated IdP, generating signed assertions about a subject. Specific requirements for this presentation and the emerging context are presented in SP 800-63C-4.</li>
</ol>

<p>The rapid proliferation of online services over the past few years has heightened the need for reliable, equitable, secure, and privacy-protective digital identity solutions.
Revision 4 of NIST Special Publication SP 800-63, <em>Digital Identity Guidelines</em>, intends to respond to the changing digital landscape that has emerged since the last major revision of this suite was published in 2017, including the real-world implications of online risks. The guidelines present the process and technical requirements for meeting digital identity management assurance levels for identity proofing, authentication, and federation, including requirements for security and privacy as well as considerations for fostering equity and the usability of digital identity solutions and technology.</p>

<p>Based on the feedback provided in response to the June 2020 Pre-Draft Call for Comments, research into real-world implementations of the guidelines, market innovation, and the current threat environment, this draft seeks to:</p>

<ul>
  <li>Address comments received in response to the IPD of Revision 4 of SP 800-63</li>
  <li>Clarify the text to address the questions and issues raised in the public comments</li>
  <li>Update all four volumes of SP 800-63 based on current technology and market developments, the changing digital identity threat landscape, and organizational needs for digital identity solutions to address online security, privacy, usability, and equity</li>
</ul>

<p>NIST is specifically interested in comments and recommendations on the following topics:</p>

<ol>
  <li>
    <p>Federation and Assertions</p>

    <ul>
      <li>Is the concept of user-controlled wallets and attribute bundles sufficiently and clearly described to support real-world implementations? Are there additional requirements or considerations that should be added to improve the security, usability, and privacy of these technologies?</li>
    </ul>
  </li>
  <li>
    <p>General</p>

    <ul>
      <li>What specific implementation guidance, reference architectures, metrics, or other supporting resources could enable more rapid adoption and implementation of this and future iterations of the Digital Identity Guidelines?</li>
      <li>What applied research and measurement efforts would provide the greatest impacts on the identity market and advancement of these guidelines?</li>
    </ul>
  </li>
</ol>

<p>Reviewers are encouraged to comment and suggest changes to the text of all four draft volumes of the SP 800-63-4 suite. NIST requests that all comments be submitted by 11:59pm Eastern Time on October 7th, 2024. Please submit your comments to <a href="mailto:dig-comments@nist.gov">dig-comments@nist.gov</a>. NIST will review all comments and make them available on the <a href="https://www.nist.gov/identity-access-management">NIST Identity and Access Management website</a>. Commenters are encouraged to use the comment template provided on the NIST Computer Security Resource Center website for responses to these notes to reviewers and for specific comments on the text of the four-volume suite.</p>

<h1 id="preface">
  
  
    Preface <a href="#preface" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p>This publication and its companion volumes, <a href="/800-63-4/sp800-63/introduction/#introduction" latex-href="#ref-SP800-63">[SP800-63]</a>, <a href="/800-63-4/sp800-63a/introduction/#introduction" latex-href="#ref-SP800-63A">[SP800-63A]</a>, and <a href="/800-63-4/sp800-63b/introduction/#introduction" latex-href="#ref-SP800-63B">[SP800-63B]</a>, provide technical guidelines to organizations for the implementation of digital identity services.</p>

<p>This document, SP 800-63C, provides requirements to identity providers (IdPs) and relying parties (RPs) of federated identity systems. Federation allows a given IdP to provide authentication attributes and (optionally) subscriber attributes to a number of separately-administered RPs through the use of federation protocols and assertions. Similarly, RPs can use more than one IdP as sources of identities.</p>

<h1 id="introduction" data-section="1">
  
  
    Introduction <a href="#introduction" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<p>Federation is a process that enables the subscriber account defined in <a href="/800-63-4/sp800-63a/introduction/#introduction" latex-href="#ref-SP800-63A">[SP800-63A]</a> to be used with an RP that does not verify one of the authenticators bound to the subscriber account. Instead, a service known as an identity provider, or IdP, makes the subscriber account available through a federation protocol to the relying party, or RP. The IdP sends a verifiable statement, called an assertion, about the subscriber account to the RP, triggered by an authentication event of the subscriber. The RP verifies the assertion provided by the IdP and creates an authenticated session with the subscriber, granting the subscriber access to the RP’s functions.</p>

<p>The IdP works in one of two modes:</p>

<ul>
  <li>As a verifier for authenticators bound to the subscriber account as described in <a href="/800-63-4/sp800-63b/introduction/#introduction" latex-href="#ref-SP800-63B">[SP800-63B]</a> (see details in <a href="/800-63-4/sp800-63c/GenIdP/#GenIdP">Sec. 4</a>), or</li>
  <li>As a subscriber-controlled device onboarded by the CSP, often known as a digital wallet (see details in <a href="/800-63-4/sp800-63c/Wallets/#wallet">Sec. 5</a>).</li>
</ul>

<p>The federation process allows the subscriber to obtain services from multiple RPs without the need to hold or maintain separate authenticators at each RP, a process sometimes known as <em>single sign-on</em>. The federation process also is generally the preferred approach to authentication when the RP and the subscriber account are not administered together under a common security domain, since the RP does not need to verify an authenticator in the subscriber account. Even so, federation can be still applied within a single security domain for a variety of benefits including centralized account management and technical integration.</p>

<p>The federation process can be facilitated by additional parties acting in other roles, such as a federation authority to facilitate the trust agreements in place and federation proxies to facilitate the protocol connections.</p>
<h2 id="notations" data-section="1">
  
  
    Notations <a href="#notations" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>This guideline uses the following typographical conventions in text:</p>

<ul>
  <li>Specific terms in <strong>CAPITALS</strong> represent normative requirements. When these same terms are not in <strong>CAPITALS</strong>, the term does not represent a normative requirement.
    <ul>
      <li>The terms “<strong>SHALL</strong>” and “<strong>SHALL NOT</strong>” indicate requirements to be followed strictly in order to conform to the publication and from which no deviation is permitted.</li>
      <li>The terms “<strong>SHOULD</strong>” and “<strong>SHOULD NOT</strong>” indicate that among several possibilities, one is recommended as particularly suitable without mentioning or excluding others, that a certain course of action is preferred but not necessarily required, or that (in the negative form) a certain possibility or course of action is discouraged but not prohibited.</li>
      <li>The terms “<strong>MAY</strong>” and “<strong>NEED NOT</strong>” indicate a course of action permissible within the limits of the publication.</li>
      <li>The terms “<strong>CAN</strong>” and “<strong>CANNOT</strong>” indicate a possibility and capability—whether material, physical, or causal—or, in the negative, the absence of that possibility or capability.</li>
    </ul>
  </li>
</ul>
<h2 id="document-structure" data-section="1">
  
  
    Document Structure <a href="#document-structure" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>This document is organized as follows. Each section is labeled as either normative (i.e., mandatory for compliance) or informative (i.e., not mandatory).</p>

<ul>
  <li>Section 1 provides an introduction to the document. This section is <em>informative</em>.</li>
  <li>Section 2 describes requirements for Federation Assurance Levels. This section is <em>normative</em>.</li>
  <li>Section 3 describes general requirements for federation systems. This section is <em>normative</em>.</li>
  <li>Section 4 describes requirements for general-purpose IdPs. This section is <em>normative</em>.</li>
  <li>Section 5 describes requirements for subscriber-controlled wallets. This section is <em>normative</em>.</li>
  <li>Section 6 provides security considerations. This section is <em>informative</em>.</li>
  <li>Section 7 provides privacy considerations. This section is <em>informative</em>.</li>
  <li>Section 8 provides usability considerations. This section is <em>informative</em>.</li>
  <li>Section 9 provides equity considerations. This section is <em>informative</em>.</li>
  <li>Section 10 provides additional example scenarios. This section is <em>informative</em>.</li>
  <li>References contains a list of publications referred to from this document. This section is <em>informative</em>.</li>
  <li>Appendix A contains a selected list of abbreviations used in this document. This appendix is <em>informative</em>.</li>
  <li>Appendix B contains a glossary of selected terms used in this document. This appendix is <em>informative</em>.</li>
  <li>Appendix C contains a summarized list of changes in this document’s history. This appendix is <em>informative</em>.</li>
</ul>

<h1 id="fal" data-section="2">
  
  
    Federation Assurance Level (FAL) <a href="#fal" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is normative.</em></p>

<p>This section defines <em>federation assurance levels</em> (FALs) and the requirements for securing federation transactions at each FAL. In order to fulfill the requirements for a a given FAL, the federation transaction <strong>SHALL</strong> meet or exceed all requirements listed for that FAL.</p>

<p>Each FAL is characterized by a set of requirements that increase the security and complexity as the FAL increases. These requirements are listed here and expanded in other sections of this document:</p>

<dl>
  <dt>Audience Restriction</dt>
  <dd>The assertion presented in the federation protocol is targeted to a specific RP and the RP can confirm that it is the intended audience of the assertion.</dd>
  <dt>Injection Protection</dt>
  <dd>The RP is strongly protected from an attacker presenting an assertion in circumstances outside a current federation transaction request. (See <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a> for details on injection protection.)</dd>
  <dt>Trust Agreement Establishment</dt>
  <dd>The agreement to participate in a federation transaction for the purposes of creating an authenticated session for the subscriber at the RP. (See <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> for details of the trust agreement.)</dd>
  <dt>Identifier and Key Establishment</dt>
  <dd>The IdP and RP have exchanged identifiers and key material to allow for the verification of assertions and other artifacts during future federation transactions. (See <a href="/800-63-4/sp800-63c/Federation/#identifiers-keys">Sec. 3.5</a> for details of key establishment.)</dd>
  <dt>Presentation</dt>
  <dd>The assertion can be presented to the RP either on its own (as a bearer assertion) or in concert with an authenticator presented by the subscriber.</dd>
</dl>

<p><a href="/800-63-4/sp800-63c/fal/#table-1">Table 1</a> provides a non-normative summary of aspects for each FAL. Each successive level subsumes and fulfills all requirements of lower levels (e.g., a federation process at FAL3 can be accepted at FAL2 or FAL1 since FAL3 satisfies all the requirements of these lower levels). Combinations not found in <a href="/800-63-4/sp800-63c/fal/#table-1">Table 1</a> are possible, and agencies can choose to implement stronger protections in one or more areas of requirements at a given FAL.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/fal/#table-1" name="table-1">Table 1. Federation Assertion Levels</a></p>

<table latex-table="1" latex-caption="Federation Assurance Levels">
  <thead>
    <tr>
      <th style="text-align: center">Requirement</th>
      <th>FAL1</th>
      <th>FAL2</th>
      <th>FAL3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Audience Restriction</td>
      <td>Multiple RPs allowed per assertion, Single RP per assertion recommended</td>
      <td>Single RP per assertion</td>
      <td>Single RP per assertion</td>
    </tr>
    <tr>
      <td style="text-align: center">Injection Protection</td>
      <td>Recommended for all transactions</td>
      <td>Required; transaction begins at the RP</td>
      <td>Required; transaction begins at the RP</td>
    </tr>
    <tr>
      <td style="text-align: center">Trust Agreement Establishment</td>
      <td>Subscriber-driven or A priori</td>
      <td>A priori</td>
      <td>A priori</td>
    </tr>
    <tr>
      <td style="text-align: center">Identifier and Key Establishment</td>
      <td>Dynamic or Static</td>
      <td>Dynamic or Static</td>
      <td>Static</td>
    </tr>
    <tr>
      <td style="text-align: center">Presentation</td>
      <td>Bearer Assertion</td>
      <td>Bearer Assertion</td>
      <td>Holder-of-Key Assertion or Bound Authenticator</td>
    </tr>
  </tbody>
</table>

<p>While many different federation implementation options are possible, the FAL is intended to provide clear guidance representing increasingly secure deployment options. See <a href="/800-63-4/sp800-63/introduction/#introduction" latex-href="#ref-SP800-63">[SP800-63]</a> for details on how to choose the most appropriate FAL.</p>

<blockquote>
  <p>Note: In these guidelines, assertions, attribute bundles, and other elements of the federation protocol are protected by asymmetric digital signatures or symmetric MACs. When either asymmetric or symmetric cryptography is specifically required, the terms “sign” and “signature” will be qualified as appropriate to indicate the requirement. When either option is possible, the terms “sign” and “signature” are used without a qualifier.</p>
</blockquote>
<h2 id="falcommon" data-section="2">
  
  
    Common FAL Requirements <a href="#falcommon" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>At all FALs, all federation transactions <strong>SHALL</strong> comply with the requirements in <a href="/800-63-4/sp800-63c/Federation/#common">Sec. 3</a> to deliver an assertion to the RP and create an authenticated session at the RP. Examples of assertions used in federation protocols include the ID Token in OpenID Connect <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> and the Security Assertion Markup Language <a href="/800-63-4/sp800-63c/references/#ref-SAML">[SAML]</a> Assertion format.</p>

<p>At all FALs, the RP needs to trust the IdP to provide valid assertions representing the subscriber’s authentication event and <strong>SHALL</strong> validate the assertion.</p>

<p>IdPs and RPs <strong>SHALL</strong> employ appropriately tailored security controls from the moderate baseline security controls defined in <a href="/800-63-4/sp800-63c/references/#ref-SP800-53">[SP800-53]</a> or an equivalent federal (e.g., <a href="/800-63-4/sp800-63c/references/#ref-FEDRAMP">[FEDRAMP]</a>) or industry standard that the organization has determined for the information systems, applications, and online services that these guidelines are used to protect. IdPs and RPs <strong>SHALL</strong> ensure that the minimum assurance-related controls for the appropriate systems, or equivalent, are satisfied. Additional security controls are discussed in <a href="/800-63-4/sp800-63c/Federation/#security-controls">Sec. 3.10</a>.</p>

<p>If no FAL is specified by the trust agreement or federation transaction, the requirements of this section still apply.</p>

<p>An IdP or RP can be capable of operating at multiple FALs simultaneously, depending on use case and needs. For example, an IdP could provide FAL3 federation transactions to a high-risk RP while providing FAL2 to an RP with a lower risk profile. Similarly, an RP could require FAL2 for normal actions but require the subscriber to re-authenticate with FAL3 for higher impact or more sensitive actions. This capability extends to other dimensions, as an IdP could simultaneously have access to subscriber accounts that have been proofed at any IAL and allow authentication at any AAL. However, an RP talking to that IdP could have restrictions on the lowest IAL and AAL it is willing to accept for access. As a consequence, it is imperative that the trust agreement establish the xALs allowed and required for different use cases.</p>
<h2 id="fal1" data-section="2">
  
  
    Federation Assurance Level 1 (FAL1) <a href="#fal1" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>FAL1 provides a basic level of protection for federation transactions, allowing for a wide range of use cases and deployment decisions.</p>

<p>At FAL1, the IdP <strong>SHALL</strong> sign the assertion using approved cryptography. The RP <strong>SHALL</strong> validate the signature using the key associated with the expected IdP. The signature protects the integrity of the assertion contents and allows for the IdP to be verified as the source of the assertion.</p>

<p>All assertions at FAL1 <strong>SHALL</strong> be audience-restricted to a specific RP or set of RPs, and the RP <strong>SHALL</strong> validate that it is one of the targeted RPs for the given assertion.</p>

<p>At FAL1, the trust agreement <strong>MAY</strong> be established by the subscriber during the federation transaction. Note that at FAL1, it is still possible for the trust agreement to be established a priori by the RP and IdP.</p>

<p>At FAL1, the federation protocol <strong>SHOULD</strong> apply injection protection as discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>. The federation transaction <strong>SHOULD</strong> be initiated by the RP.</p>
<h2 id="fal2" data-section="2">
  
  
    Federation Assurance Level 2 (FAL2) <a href="#fal2" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>FAL2 provides a high level of protection for federation transactions, providing protections against a variety of attacks against federated systems. All the requirements for FAL1 apply at FAL2 except where overridden by more specific or stringent requirements here.</p>

<p>At FAL2, the assertion <strong>SHALL</strong> be strongly protected from injection attacks, as discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>. The federation transaction <strong>SHALL</strong> be initiated by the RP.</p>

<p>At FAL2, the assertion <strong>SHALL</strong> audience restricted to a single RP.</p>

<p>At FAL2, an a priori trust agreement <strong>SHALL</strong> be established prior to the federation transaction taking place.</p>

<p>IdPs operated by or on behalf of federal agencies that present assertions at FAL2 or higher <strong>SHALL</strong> protect keys used for signing or encrypting those assertions with mechanisms validated at <a href="/800-63-4/sp800-63c/references/#ref-FIPS140">[FIPS140]</a> Level 1 or higher.</p>
<h2 id="fal3" data-section="2">
  
  
    Federation Assurance Level 3 (FAL3) <a href="#fal3" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>FAL3 provides a very high level of protection for federation transactions, establishing very high confidence that the subscriber asserted by the IdP is the subscriber present in the authenticated session. All the requirements at FAL1 and FAL2 apply at FAL3 except where overridden by more specific or stringent requirements here.</p>

<p>At FAL3, the RP <strong>SHALL</strong> verify that the subscriber is in control of an authenticator in addition to the assertion. This authenticator is either identified in a holder-of-key assertion as described in <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec 3.14</a> or is a bound authenticator as described in <a href="/800-63-4/sp800-63c/Federation/#bound-authn">Sec. 3.15</a>.</p>

<p>At FAL3, the trust agreement <strong>SHALL</strong> be established such that the IdP can identify and trust the RP to abide by all aspects of the trust agreement prior to any federation transaction taking place. To facilitate this, the key material used to authenticate the RP and IdP to each other is associated with the identifiers for the RP and IdP in a static fashion using a trusted mechanism. For example, a public key file representing the RP is uploaded to the IdP during a static registration process, and the RP downloads the IdP’s public key from a URL indicated in the trust agreement. Alternatively, the trust agreement can dictate that the RP and IdP can upload their respective public keys to a federation authority and then download each other’s keys from that same trusted authority.</p>

<p>IdPs operated by or on behalf of federal agencies that present assertions at FAL3 <strong>SHALL</strong> protect keys used for signing or encrypting those assertions with mechanisms validated at <a href="/800-63-4/sp800-63c/references/#ref-FIPS140">[FIPS140]</a> Level 1 or higher.</p>
<h2 id="request-xals" data-section="2">
  
  
    Requesting and Processing xALs <a href="#request-xals" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Since an IdP is capable of asserting the identities of many different subscribers with a variety of authenticators using a variety of federation parameters, the IAL, AAL, and FAL could vary across different federation transactions, even to the same RP.</p>

<p>IdPs <strong>SHALL</strong> support a mechanism for RPs to specify a set of minimum acceptable xALs as part of the trust agreement and <strong>SHOULD</strong> support the RP specifying a more strict minimum set at runtime as part of the federation transaction. When an RP requests a particular xAL, the IdP <strong>SHOULD</strong> fulfill that request, if possible, and <strong>SHALL</strong> indicate the resulting xAL in the assertion. For example, if the subscriber has an active session that was authenticated at AAL1, but the RP has requested AAL2, the IdP needs to prompt the subscriber for AAL2 authentication to step up the security of the session at the IdP during the subscriber’s interaction at the IdP, if possible. The IdP sends the resulting AAL as part of the returned assertion, whether it is AAL1 (the step-up authentication was not met) or AAL2 (the step-up authentication was met successfully).</p>

<p>The IdP <strong>SHALL</strong> inform the RP of the following information for each federation transaction:</p>

<ul>
  <li>The IAL of the subscriber account being presented to the RP, or an indication that no IAL claim is being made</li>
  <li>The AAL of the currently active session of the subscriber at the IdP, or an indication that no AAL claim is being made</li>
  <li>The FAL of the federation transaction</li>
</ul>

<p>The RP gets this xAL information from a combination of the terms of the trust agreement as described in <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> and information included in the assertion as described in <a href="/800-63-4/sp800-63c/GenIdP/#assertions">Sec. 4.9</a> and <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">Sec. 5.8</a>. If the xAL is unchanging for all messages between the IdP and RP, the xAL information <strong>SHALL</strong> be included in the terms of the trust agreement between the IdP and RP. If the xAL could be within a range of possible values specified by the trust agreement, the xAL information <strong>SHALL</strong> be included as part of the assertion contents.</p>

<p>The IdP <strong>MAY</strong> indicate that no claim is made to the IAL or AAL for a given federation transaction. In such cases, no default value is assigned to the resulting xAL by the RP. That is to say, a federation transaction without an IAL declaration in either the trust agreement or the assertion is functionally considered to have “no IAL” and the RP cannot assume the account meets “IAL1”, the lowest numbered IAL described in this suite.</p>

<p>The RP <strong>SHALL</strong> determine the minimum IAL, AAL, and FAL it is willing to accept for access to any offered functionality. An RP <strong>MAY</strong> vary its functionality based on the IAL, AAL, and FAL of a specific federated authentication. For example, an RP can allow federation transactions at AAL2 for common functionality (e.g., viewing the status of a dam system) but require AAL3 be used for higher risk functionality (e.g., changing the flow rates of a dam system). Similarly, an RP could restrict management functionality to only certain subscriber accounts which have been identity proofed at IAL2, while allowing federation transactions from all subscriber accounts regardless of IAL.</p>

<p>In a federation process, only the IdP has direct access to the details of the subscriber account, which determines the applicable IAL, and the authentication event at the IdP, which determines the applicable AAL. Consequently, the IdP declares the IAL, AAL, and intended FAL for each federation transaction.</p>

<p>The RP <strong>SHALL</strong> ensure that it meets its obligations in the federation transaction for the FAL declared in the assertion. For example, the RP needs to ensure the presentation method meets the injection protection requirements at FAL2 and above, and that the appropriate bound authenticator is presented at FAL3.</p>

<h1 id="common" data-section="3">
  
  
    Common Federation Requirements <a href="#common" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is normative.</em></p>

<p>A federation transaction serves to allow the subscriber to establish an authenticated session with the RP based on a subscriber account known to the IdP. The federation transaction can also provide the RP with a set of identity attributes within the authenticated session. The authenticated session can then be used by the RP for:</p>

<ul>
  <li>logging in the subscriber to access functionality at the RP,</li>
  <li>identifying the subscriber based on presented attributes, and</li>
  <li>processing the subscriber attributes presented in the federation transaction.</li>
</ul>

<p>A federation transaction requires relatively complex multiparty protocols that have subtle security and privacy requirements. When evaluating a particular federation protocol, profile, or deployment structure, it is often instructive to break it down into its component relationships and evaluate the needs for each of these:</p>

<ul>
  <li>the subscriber to the CSP,</li>
  <li>the CSP to the IdP,</li>
  <li>the subscriber to the IdP,</li>
  <li>the IdP to the RP, and</li>
  <li>the subscriber to the RP.</li>
</ul>

<p>In addition, the subscriber often interacts with the CSP, IdP, and RP through a user agent like a web browser. The user agent is therefore often involved in the federation process, but it is not necessary for all types of applications and interactions. As such, the actions of the subscriber described throughout these guidelines can optionally be performed through a user agent. Where necessary, requirements on the user agent are called out directly.</p>

<p>Each party in a federation protocol bears specific responsibilities and expectations that must be fulfilled in order for the federated system to function as intended.</p>

<p>The subscriber account is augmented by the IdP with federation-specific items, including but not limited to the following:</p>

<ul>
  <li>One or more external subject identifiers, for use with a federation protocol</li>
  <li>A set of access rights, detailing which RPs can access which attributes of the subscriber account (such as allowlists and saved runtime decisions by the subscriber)</li>
  <li>Federated account usage information</li>
  <li>Additional attributes collected by or assigned by the IdP to the account</li>
</ul>

<p>A subset of these attributes is made available to the RP through the federation process, either in the assertion or through an identity API (see <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec 3.11.3</a>). These attributes are often used in determining access privileges for attribute-based access control (ABAC) or facilitating a transaction (e.g., providing a shipping address). The details of authorization and access control are outside the scope of these guidelines.</p>

<p>To keep and manage these attributes, the RP often maintains an <em>RP subscriber account</em> for the subscriber. The RP subscriber account also contains information local to the RP itself, as described in <a href="/800-63-4/sp800-63c/Federation/#rp-account">Sec. 3.7</a>.</p>

<p>Federation transactions take place across three dimensions:</p>

<dl>
  <dt>Trust Agreements:</dt>
  <dd>The establishment of a policy decision that allows the CSP, IdP, and RP to connect for the purposes of federation. This policy is governed by a trust agreement, which establishes the permission to connect.</dd>
  <dt>Associating Keys and Identifiers:</dt>
  <dd>The association of keys and identifiers for the CSP, IdP, and RP that take part in the federation transaction. This process enables the parties to identify each other securely for future exchanges.</dd>
  <dt>Federation Protocol:</dt>
  <dd>The verification of the subscriber’s identity by the IdP and subsequent issuance of an assertion to the RP. This results in the passing of subscriber attributes to the RP and establishing an authenticated session for the subscriber at the RP.</dd>
</dl>

<p>These dimensions all need to be fulfilled for a federation process to be complete. The exact order in which that happens, and which parties are involved in which steps, can vary depending on deployment models and other factors.</p>

<p>The requirements for IdPs in this section apply to both general-purpose IdPs as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#GenIdP">Sec. 4</a> and subscriber-controlled wallets as discussed in <a href="/800-63-4/sp800-63c/Wallets/#wallet">Sec. 5</a>.</p>
<h2 id="roles" data-section="3">
  
  
    Roles <a href="#roles" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<h3 id="credential-service-provider-csp" data-section="3">
  
  
    Credential Service Provider (CSP) <a href="#credential-service-provider-csp" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The CSP collects and verifies attributes from the subscriber and stores them in a subscriber account. The CSP also binds one or more authenticators to the subscriber account, allowing the subscriber to authenticate directly to systems capable of verifying an authenticator.</p>
<h3 id="identity-provider-idp" data-section="3">
  
  
    Identity Provider (IdP) <a href="#identity-provider-idp" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The IdP provides a bridge between the subscriber account (as established by the CSP) and the RP that the subscriber is accessing. An IdP can be deployed as a service for multiple subscriber accounts or as a component controlled by a single subscriber.</p>

<p>The IdP establishes an authentication event with the subscriber, either through the verification of an authenticator (for general-purpose IdPs) or presentation of an activation factor (for subscriber-controlled wallets). The IdP creates assertions to represent the authentication event.</p>

<p>The IdP makes identity attributes of the subscriber available within the assertion or through an identity API (see <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>).</p>

<p><em>In some systems, this is also known as the offering party (OP).</em></p>
<h3 id="relying-party-rp" data-section="3">
  
  
    Relying Party (RP) <a href="#relying-party-rp" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The RP processes assertions from the IdP and provides the service that the subscriber is trying to access. Unlike in a direct authentication model, the RP does not provide the verifier function to authenticators tied to the subscriber account.</p>

<p><em>In some systems, this is also known as the service provider (SP).</em></p>
<h2 id="functions" data-section="3">
  
  
    Functions <a href="#functions" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<h3 id="trust-agreement-management" data-section="3">
  
  
    Trust Agreement Management <a href="#trust-agreement-management" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The trust agreement (see <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a>) can be managed through a dedicated party, known as a <em>federation authority</em>. The federation authority facilitates the onboarding and management of parties fulfilling different roles and functions within a trust agreement. This management provides a transitive trust to other parties in the agreement.</p>

<p>For example, an RP can enter a trust agreement with a federation authority and decide that any IdP approved by that federation authority is suitable for its purposes. This trust can hold true whether or not the IdP was covered by the trust agreement at the time the RP joined. Federation authorities are used in multilateral trust agreements as discussed in <a href="/800-63-4/sp800-63c/Federation/#authorities">Sec. 3.4.2</a>.</p>
<h3 id="authorized-party" data-section="3">
  
  
    Authorized Party <a href="#authorized-party" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The <em>authorized party</em> in a trust agreement is the organization, person, or entity that is responsible for the specific release decisions covered by the trust agreement, including the release of subscriber attributes. The trust agreement stipulates who the expected authorized party is, as well as the parameters under which a request could be automatically granted, automatically denied, or require a runtime decision from an individual. For public-facing scenarios, the authorized party is expected to be the subscriber. For enterprise scenarios, the authorized party is expected to be the agency.</p>

<p>If the authorized party is the operator of the IdP, consent to release attributes is decided for all subscribers and established by an allowlist as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-allowlist">Sec. 4.6.1.1</a>, allowing for the disclosure of identity attribute without direct decisions and involvement by the subscriber. A trust agreement can alternatively stipulate that an individual, such as the subscriber, is to be prompted at runtime for consent to disclose certain attributes to the RP as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>. If specified by the trust agreement, it is also possible for an individual other than a subscriber to act as the authorized party. For example, an administrator of a system being prompted to release attribute information on behalf of a subscriber as part of a provisioning API.</p>

<p>Examples of different authorized parties are found in <a href="/800-63-4/sp800-63c/examples/#authorized-party-example">Sec 10.10</a>.</p>
<h3 id="proxied" data-section="3">
  
  
    Proxied Federation <a href="#proxied" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>A federation <em>proxy</em> acts as an intermediary between the IdP and RP for all communication in the federation protocol. The proxy functions as an RP on the upstream side and an IdP on the downstream side, as shown in <a href="/800-63-4/sp800-63c/Federation/#fig-1">Fig. 1</a>. When communicating through a proxy, the upstream IdP and downstream RP communicate with the proxy using a standard federation protocol, and the subscriber takes part in two separate federation transactions. As a consequence, all normative requirements that apply to IdPs and RPs <strong>SHALL</strong> apply to proxies in their respective roles on each side. Additionally, it is possible for a proxy to act as an upstream IdP to another proxy downstream, and so on in a chain.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-3" name="fig-1">Fig. 1. Federation Proxy</a></p>

<p><img src="/800-63-4/sp800-63c/images/proxy.png" alt="Diagram of a federation proxy accepting assertions from an upstream IdP and providing assertions to a downstream RP." title="Federation Proxy" latex-src="proxy.pdf" latex-fig="1" latex-place="h" /></p>

<p>The role of the proxy is limited to the federation protocol; it is not involved in establishment or facilitation of a trust agreement between the upstream IdP and downstream RP. The same party can operate a federation authority as well as a proxy to facilitate federation transactions, but this function is separate from their role in managing the trust agreement. Just like other members of a federation system, the proxy can be involved in separate trust agreements with each of the upstream and downstream components, or a single trust agreement can apply to all parties such as in a multilateral agreement.</p>

<p>The federated identifier (see <a href="/800-63-4/sp800-63c/Federation/#federated-identifier">Sec. 3.3</a>) of an assertion from a proxy <strong>SHALL</strong> indicate the proxy as the issuer of the assertion. The downstream RP receives and validates the assertion generated by the proxy, as it would an assertion from any other IdP. This assertion is based on the assertion the proxy receives from the upstream IdP. The contents of the assertion from the upstream IdP can be handled in several ways, depending on the method of proxying in use:</p>

<ul>
  <li>The proxy can create an all-new assertion with no information from the assertion from the upstream IdP carried in it. This pattern is useful for blinding the downstream RP, so that the RP does not know which upstream IdP the subscriber originally came from.</li>
  <li>The proxy can copy attributes from the assertion from the upstream IdP into the assertion from the proxy. This pattern is useful for carrying identity attributes in the assertion to the downstream RP.</li>
  <li>The proxy can include the entire assertion from the upstream IdP in the assertion from the proxy. This pattern allows the RP to independently validate the assertion from the upstream IdP as well as the assertion from the proxy.</li>
</ul>

<p>A proxied federation model can provide several benefits. Federation proxies can simplify technical integration between the RP and IdP by providing a common interface for integration. Additionally, to the extent a proxy effectively blinds the RP and IdP from each other, it can provide some business confidentiality for organizations that want to guard their subscriber lists from each other. Proxies can also mitigate some of the privacy risks described in <a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Sec. 3.9</a>, though other risks arise from their use since an additional party is now involved in handling subscriber information. For example, if an attacker is able to compromise the proxy, the attacker need not target the IdP or RP directly in order to gain access to subscriber attributes or activity since all of that information flows through the proxy. Additionally, the proxy can perform additional profiling of the subscriber beyond what the IdP and RP can do, since the proxy brokers the federation transactions between the parties and binds the subscriber account to either side of the connection.</p>

<p>See <a href="/800-63-4/sp800-63c/privacy/#blinding">Sec. 7.5</a> for further information on blinding techniques, their uses, and limitations.</p>

<p>The FAL of the connection between the proxy and the downstream RP is considered as the lowest FAL along the entire path, and the proxy <strong>SHALL</strong> accurately represent this to the downstream RP. For example, if the connection between the upstream IdP and the proxy is FAL1 and the connection between the proxy and the downstream RP otherwise meets the requirements of FAL2, the connection between the proxy and the downstream RP is still considered FAL1. Likewise, if the connection between the upstream IdP and the proxy is FAL2 and the connection between the proxy and the downstream RP is only FAL1, the overall connection through the proxy is considered FAL1.</p>
<h3 id="fulfilling-roles-and-functions-of-a-federation-model" data-section="3">
  
  
    Fulfilling Roles and Functions of a Federation Model <a href="#fulfilling-roles-and-functions-of-a-federation-model" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The roles in a federation transaction can be connected in a variety of ways, but several common patterns are anticipated by these guidelines. The expected trust agreement structure and connection between components will vary based on which pattern is in use.</p>

<p>Different roles and functions can be fulfilled by separate parties who integrate with each other. For example, a CSP can provide attributes of the subscriber account to an IdP that is not operated by the same party or agency as the CSP.</p>

<p>It is also possible for a single party to fulfil multiple roles within a given federation agreement. For example, if the CSP provides the IdP as part of its identity services, the CSP can provision the subscriber accounts at the IdP as part of the subscriber account establishment process. Similarly, the RP can also be in the same security and administrative domain as the IdP, but still use federation technology to connect for technical, deployment, and account management benefits.</p>

<p>The same is true for other functions in the overall federation system, such as a federation authority and proxy. While the roles may seem similar, they are fundamentally distinct and do not need to be connected: a federation authority facilitates establishment of a trust agreement between parties, and a proxy facilitates connection of the federation protocol by acting as an RP to the upstream IdP and as an IdP to the downstream RP. The same entity can fulfill both the federation authority and proxy functions in the system, providing both a means of establishing trust agreements and a means of establishing technical connections between IdPs and RPs.</p>
<h2 id="federated-identifier" data-section="3">
  
  
    Federated Identifiers <a href="#federated-identifier" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The subscriber <strong>SHALL</strong> be identified in the federation transaction using a federated identifier unique to that subscriber. A federated identifier is the logical combination of a subject identifier, representing a subscriber account, and an issuer identifier, representing the IdP. The subject identifier is assigned by the IdP, and the issuer identifier is assigned to the IdP usually through configuration.</p>

<p>The multi-part federated identifier pattern is required because different IdPs manage their subject identifiers independently, and could therefore potentially collide in their choices of subject identifiers for different subjects. Therefore, it is imperative that an RP never process the subject identifier without taking into account which IdP issued that subject identifier. For most use cases, the federated identifier is stable for the subscriber across multiple sessions and is independent of the authenticator used, allowing the RP to reliably identify the subscriber across multiple authenticated sessions and account changes. However, it is also possible for the federated identifier and its associated use at the RP to be ephemeral, providing some privacy enhancement. Federated identifiers, and their constituent parts, are intended to be machine-readable and not managed by or exposed to the subscriber, unlike a username or other human-facing identifier.</p>

<p>Federated identifiers <strong>SHALL</strong> contain no plaintext personally-identifiable information (PII), such as usernames, email addresses, or employee numbers, etc.</p>
<h3 id="ppi" data-section="3">
  
  
    Pairwise Pseudonymous Identifiers (PPI) <a href="#ppi" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In some circumstances, it is desirable to prevent the subscriber account from being easily linked at multiple RPs through use of a common subject identifier. The use of a pairwise pseudonymous identifier (PPI) allows an IdP to provide multiple distinct federated identifiers to different RPs for a single subscriber account. Use of a PPI prevents different RPs from colluding together to track the subscriber using the federated identifier.</p>
<h4 id="general-requirements" data-section="3">
  
  
    General Requirements <a href="#general-requirements" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>When using pairwise pseudonymous identifiers within the assertions generated by the IdP for the RP, the IdP <strong>SHALL</strong> generate a different federated identifier for each RP as described in <a href="/800-63-4/sp800-63c/Federation/#ppi-gen">Sec. 3.3.1.2</a> or set of RPs as described in <a href="/800-63-4/sp800-63c/Federation/#ppi-shared">Sec. 3.3.1.3</a>.</p>

<p>Some identity attributes such as names, physical address, phone numbers, email addresses, and others can be used to identify a subscriber outside of a federation transaction. When PPIs are used alongside these kinds of identifying attributes, it may still be possible for multiple colluding RPs to re-identify a subscriber by correlation across systems. For example, if two independent RPs each see the same subscriber identified with a different PPI, the RPs could still determine that the subscriber is the same person by comparing the name, email address, physical address, or other identifying attributes carried alongside the PPI in the respective assertions. Where PPIs are used alongside identifying attributes, privacy policies <strong>SHALL</strong> be established to prevent correlation of subscriber data consistent with applicable legal and regulatory requirements.</p>

<p>Note that in a proxied federation model (see <a href="/800-63-4/sp800-63c/Federation/#proxied">Sec. 3.2.3</a>), the upstream IdP may be unable to generate a PPI for the downstream RP, since the proxy could blind the IdP from knowing which RP is being accessed by the subscriber. In such situations, the PPI is generally established between the IdP and the federation proxy. The proxy, acting as an IdP, can provide a PPI to the downstream RP. Depending on the protocol, the federation proxy may need to map the PPI back to the associated identifiers from upstream IdPs in order to allow the identity protocol to function. In such cases, the proxy will be able to track and determine which PPIs represent the same subscriber at different RPs. The proxy <strong>SHALL NOT</strong> disclose the mapping between the PPI and any other identifiers to a third party or use the information for any purpose other than those allowed for transmission of subscriber information defined in <a href="/800-63-4/sp800-63c/Federation/#transmit-subscriber-info">Sec. 3.9.1</a>.</p>
<h4 id="ppi-gen" data-section="3">
  
  
    Pairwise Pseudonymous Identifier Generation <a href="#ppi-gen" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>The PPI <strong>SHALL</strong> contain no identifying information about the subscriber (e.g., username, email address, employee number, etc.). The PPI <strong>SHALL</strong> be difficult to guess by a party having access to information about the subscriber, having at least 112 bits of entropy as stated in <a href="/800-63-4/sp800-63c/references/#ref-SP800-131A">[SP800-131A]</a>. PPIs can be generated randomly and assigned to subscribers by the IdP or could be derived from other subscriber information if the derivation is done in an irreversible, unguessable manner (e.g., using a keyed hash function with a secret key as discussed in <a href="/800-63-4/sp800-63c/references/#ref-SP800-131A">[SP800-131A]</a>).</p>

<p>Unless the PPI is designated as shared by the trust agreement, the PPI <strong>SHALL</strong> be disclosed to only a single RP.</p>
<h4 id="ppi-shared" data-section="3">
  
  
    Shared Pairwise Pseudonymous Identifiers <a href="#ppi-shared" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>The same shared PPI <strong>SHALL</strong> be used for a specific set of RPs if all the following criteria are met:</p>

<ul>
  <li>The trust agreement stipulates a shared PPI for a specific set of RPs;</li>
  <li>The authorized party consents to and is notified of the use of a shared PPI;</li>
  <li>Those RPs have a demonstrable relationship that justifies an operational need for the correlation, such as a shared security domain or shared legal ownership; and</li>
  <li>All RPs in the set of a shared PPI consent to being correlated in such a manner (i.e., one RP cannot request to have another RP’s PPI without that other RP’s knowledge and consent).</li>
</ul>

<p>The RPs <strong>SHALL</strong> conduct a privacy risk assessment to consider the privacy risks associated with requesting a shared PPI. See <a href="/800-63-4/sp800-63c/privacy/#notice">Sec. 7.2</a> for further privacy considerations.</p>

<p>The IdP <strong>SHALL</strong> ensure that only intended RPs are included in the set; otherwise, a rogue RP could learn of the shared PPI for a set of RPs by fraudulently posing as part of that set.</p>

<p>The sector identifier feature of <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> provides a mechanism to calculate a shared PPI for a group of RPs. In this protocol, the identifiers of the RPs are all listed at a URL that can be fetched by the IdP over an authorized protected channel. The shared PPI is calculated by taking into account the sector identifier URL along with other inputs to the algorithm, such that all RPs listed in the sector identifier URL’s contents receive the same shared PPI.</p>
<h2 id="trust-agreement" data-section="3">
  
  
    Trust Agreements <a href="#trust-agreement" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>All federation transactions <strong>SHALL</strong> be defined by one or more trust agreements between the applicable parties.</p>

<p>The trust agreement <strong>SHALL</strong> establish a trust relationship between the RP and:</p>

<ul>
  <li>The CSP responsible for provisioning and managing the subscriber account,</li>
  <li>The IdP responsible for providing assertions and attributes, or</li>
  <li>Both the CSP and IdP.</li>
</ul>

<p>Trust agreements establish the terms for federation transactions between the parties they affect, including things like the allowed xALs and the intended purposes of identity attributes exchanged in the federation transaction. The trust agreement <strong>SHALL</strong> establish usability and equity requirements for the federation transaction. The trust agreement <strong>SHALL</strong> disclose details of the proofing process used at the CSP, including any compensating controls and exception handling processes.</p>

<p>All trust agreements <strong>SHALL</strong> define a specific population of subscriber accounts that the agreement is applicable to. The exact means of defining this population are out of scope of this document. In many cases, the population is defined as the full set of subscriber accounts that the CSP manages and makes available through an IdP. In other cases, the population is a demarcated subset of accounts available through an IdP. It is also possible for an RP to have a distinct trust agreement established with an IdP for a single subscriber account, such as in a subscriber-driven trust agreement.</p>

<p>During the course of a single federation transaction, it is important for the policies and expectations of all parties be unambiguous for all parties involved. Therefore, there <strong>SHOULD</strong> be only one set of trust agreements in effect for a given transaction. This will usually be determined by the unique combination of CSP, IdP, and RP participating in the transaction. However, these agreements could vary in other ways, such as different populations of subscribers being governed by different trust agreements.</p>

<p>The existence of a trust agreement between parties does not preclude the existence of other agreements for each party in the agreement to have with other parties. For example, an IdP can have independent agreements with multiple RPs simultaneously, and an RP can likewise have independent agreements with multiple IdPs simultaneously. The IdP and RP need not disclose the existence or terms of trust agreements to parties outside of or not covered by the agreement in question.</p>

<p>Trust agreements <strong>SHALL</strong> establish terms regarding expected and acceptable IALs and AALs in connection with the federated relationship.</p>

<p>Trust agreements <strong>SHALL</strong> define necessary mechanisms and materials to coordinate redress and issues between the different participants in the federation, as discussed in <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a>.</p>

<p>Establishment of a trust agreement is required for all federation transactions, even those in which the roles and applications exist within a single security domain or shared legal ownership. In such cases, the establishment of the trust agreement can be an internal process and does not need to involve a formal agreement. Even in such cases, it is still required for the IdP to document and disclose the trust agreement to the subscriber upon request.</p>

<p>Even though subscribers are not generally a party directly involved in the trust agreement’s terms, subscribers are affected by the terms of the trust agreement and the resulting federation transactions. As such, the terms of the trust agreement need to be made available to subscribers in clear and understandable language. The means by which the subscriber can access these terms, and the party responsible for informing the subscriber, varies based on the means of establishment of the trust agreement and the terms of the trust agreement itself. Additionally, the subscriber’s user agent is not usually party to the trust agreement, unless it is acting in one of the roles of the federation transaction.</p>
<h3 id="bilateral" data-section="3">
  
  
    Bilateral Trust Agreements <a href="#bilateral" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In a bilateral trust agreement, the establishment of the trust agreement occurs directly between the federated parties, and the trust agreement is not managed or facilitated by a separate party. Bilateral trust agreements allow for a point-to-point connection to be established between organizations wishing to provide federated identity access to services. Bilateral connections can take many forms, including large enterprise applications with static contracts and subscriber-driven dynamic connections to previously unknown RPs. In all cases, the CSP, IdP, and RP manage their policies regarding the federated connection directly.</p>

<p>Bilateral trust agreements impose no additional requirements beyond those needed to establish the trust agreement itself.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>
<h3 id="authorities" data-section="3">
  
  
    Multilateral Trust Agreements <a href="#authorities" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In a multilateral trust agreement, the federated parties look to a <em>federation authority</em> to assist in establishing the trust agreement between parties. In this model, the federation authority facilitates the inclusion of CSPs, IdPs, and RPs under the trust agreement.</p>

<p>When onboarding a party in any role, the federation authority conducts vetting on that party to verify its compliance with the tenets of the trust agreement. The level of vetting is unique to the use cases and models employed within the federation, and details are outside the scope of this document. This vetting is depicted in <a href="/800-63-4/sp800-63c/Federation/#fig-2">Fig. 2</a>.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-2" name="fig-2">Fig. 2. Federation Authority</a></p>

<p><img src="/800-63-4/sp800-63c/images/authority.png" alt="Diagram of a federation authority facilitating trust agreement terms for a variety of parties under the federation authority." title="Federation Authority" latex-src="authority.pdf" latex-fig="2" latex-place="h" /></p>

<p>The trust agreement <strong>SHALL</strong> enumerate the required practices for vetting all parties, and <strong>SHALL</strong> indicate the party or parties responsible for performing the vetting process.</p>

<p>Vetting of CSPs, IdPs, and RPs <strong>SHALL</strong> establish, as a minimum, that:</p>

<ul>
  <li>CSPs are performing identity proofing of subscriber accounts in accordance with <a href="/800-63-4/sp800-63a/introduction/#introduction" latex-href="#ref-SP800-63A">[SP800-63A]</a></li>
  <li>CSPs onboard subscriber accounts to IdPs in a secure fashion in adherence to the requirements in <a href="/800-63-4/sp800-63c/GenIdP/#idp-account-provisioning">Sec. 4.1</a> or <a href="/800-63-4/sp800-63c/Wallets/#scidp-provisioning">Sec. 5.4</a> as applicable</li>
  <li>Authenticators used for authenticating the subscriber at the IdP or onboarding a subscriber-controlled wallet are used in accordance with <a href="/800-63-4/sp800-63b/introduction/#introduction" latex-href="#ref-SP800-63B">[SP800-63B]</a></li>
  <li>Assertions generated by IdPs adhere to the requirements in <a href="/800-63-4/sp800-63c/GenIdP/#assertions">Sec. 4.9</a> or <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">Sec. 5.8</a>.</li>
  <li>RPs adhere to requirements for handling subscriber attribute data, such as retention, aggregation, and disclosure to third parties.</li>
  <li>RP and IdP systems use approved profiles of federation protocols.</li>
</ul>

<p>The federation authority <strong>MAY</strong> provide a programmatic means for parties under the trust agreement to verify membership of other parties under the trust agreement. For example, a federation authority could provide a discovery API that provides the vetted capabilities of an IdP for providing identities to RPs within the system, or it could provide a signed attestation for RPs to present to IdPs during a registration step.</p>

<p>Federation authorities <strong>SHALL</strong> periodically re-evaluate members for compliance, in terms disclosed in the trust agreement.</p>

<p>When information needs to be shared between CSPs, such as during suspicion of fraud on a subscriber account, the federation authority can define the policies that apply for the transfer of this information. While sharing information in this way can be used to mitigate fraud, there are also substantial privacy concerns. The federation authority <strong>SHALL</strong> include all information sharing between parties other than for identity purposes in its privacy risk assessment.</p>

<p>A federation authority <strong>MAY</strong> incorporate other multilateral trust agreements managed by other federation authorities in its trust agreement, creating an interfederation agreement. For example, IdP1 has been vetted under a multilateral agreement with FA1, and RP2 has been vetted under a multilateral agreement with FA2. In order to facilitate connection between IdP1 and RP2, a new federation authority FA3 can provide a multilateral agreement that accepts IdPs from FA1 and RPs from FA2. If IdP1 and RP2 accept the authority of FA3, the federation connection can continue under the auspices of this interfederation agreement.</p>
<h3 id="redress" data-section="3">
  
  
    Redress Requirements <a href="#redress" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Federation transactions occur between multiple parties that are often controlled by multiple entities, and different stages of the federation transaction can lead to different situations in which a subscriber would need to seek redress from the different parties.</p>

<p>As the recipient of a subscriber’s identity attributes, the RP is the subscriber’s primary view into the federated system, and in some instances the subscriber may be unaware that an IdP is involved with their use of the RP. Therefore it falls to the RP to provide the subscriber with a clear and accessible method of contacting the RP to request redress. For matters that involve the RP subscriber account (including any attributes stored in the account), RP functionality, bound authenticators, RP allowlists, and other items under the RP’s control, the RP <strong>SHALL</strong> provide clear and accessible means of redress to the subscriber. For matters that involve the IdP or CSP, the RP <strong>SHALL</strong> provide the subscriber with a means of initiating the redress process with the IdP or CSP, as appropriate.</p>

<p>For matters involving the use of the subscriber account in federation transactions, including attribute values and derived attribute values made available over federation transactions, IdP functionality, holder-of-key authenticators, IdP allowlists, and other items in the IdP’s control, the IdP <strong>SHALL</strong> provide clear and accessible means of redress to the subscriber. For matters that also involve a particular RP, the IdP <strong>SHALL</strong> provide the subscriber with a means of initiating the redress process with the RP. For matters involving the subscriber account that has been made available to the IdP, the IdP <strong>SHALL</strong> provide the subscriber with a means of initiating the redress process with the CSP.</p>

<p>For matters involving the subscriber account, including identity attributes and authenticators in the subscriber account, the CSP <strong>SHALL</strong> provide the subscriber with a clear and accessible means of redress.</p>

<p>See <a href="/800-63-4/sp800-63/dirm/#redress" latex-href="#ref-SP800-63">Sec. 3.6 of [SP800-63]</a> for more requirements on providing redress.</p>
<h2 id="identifiers-keys" data-section="3">
  
  
    Identifiers and Cryptographic Key Management for CSPs, IdPs, and RPs <a href="#identifiers-keys" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>While a trust agreement establishes permission to federate, it does not facilitate the secure connection of parties in the federation.
In order to communicate over a federation protocol, the CSP, IdP, and RP need to be able to identify each other in a secure fashion, with the ability to associate identifiers with cryptographic keys and related security artifacts.
In this way, an RP can ensure that an assertion is coming from the intended IdP, or that an attribute bundle is coming from the intended CSP. Likewise, an IdP can ensure that it is sending an assertion to the intended RP.</p>

<p>The process of an RP establishing cryptographic keys and identifiers for an IdP or CSP is known as <em>discovery</em>. The process of the IdP establishing cryptographic keys and identifiers for the RP is known as <em>registration</em>. Both the discovery and registration processes can happen prior to any federation transaction happening, or inline as part of the transaction itself. Both the discovery and registration processes can happen directly between parties or be facilitated through use of a third party service. Different federation protocols and processes have different processes for establishing these cryptographic keys and identifiers, but the end result is that each party can properly identify others as necessary within the protocol.</p>

<p>The discovery and registration processes <strong>SHALL</strong> be established in a secure fashion as defined by the trust agreement governing the transaction. Protocols requiring the transfer of cryptographic key information <strong>SHALL</strong> use an authenticated protected channel to exchange cryptographic key information needed to operate the federated relationship, including any shared secrets or public keys. Any symmetric keys used in this relationship <strong>SHALL</strong> be unique to a pair of federation participants.</p>

<p>CSPs, IdPs (including subscriber-controlled wallets), and RPs <strong>MAY</strong> have multiple cryptographic keys and identifiers to serve different purposes within a trust agreement, or to serve different trust agreements. For example, an IdP could use one set of assertion signing keys for all FAL1 and FAL2 transactions, but use a separately managed set of cryptographic keys for FAL3 transactions, stored in a higher security container.</p>

<p>When domain names, URIs, or other structured identifiers are used to identify parties, wildcards <strong>SHALL NOT</strong> be used. For example, if an RP is deployed at “www.example.com”, “service.example.com”, and “gateway.example.com”, then each of these identifiers would have to be registered for the RP. A wildcard of “*.example.com” cannot be used, as it would unintentionally allow access to “user.example.com” and “unknown.example.com” under the same RP identifier.</p>
<h3 id="cryptographic-key-rotation" data-section="3">
  
  
    Cryptographic Key Rotation <a href="#cryptographic-key-rotation" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Over time, it can be desirable or necessary to update the cryptographic key associated with a CSP, IdP, or RP. The allowable update process for any cryptographic keys and identifiers <strong>SHALL</strong> be defined by the trust agreement and <strong>SHALL</strong> be executed using an authenticated protected channel, as in the initial cryptographic key establishment.</p>

<p>For example, if the IdP is identified by a URL, the IdP could publish its current public key set at a location underneath that URL. RPs can then fetch the public key from the known location as needed, getting updated public keys as they are made available.</p>
<h3 id="key-storage" data-section="3">
  
  
    Cryptographic Key Storage <a href="#key-storage" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>CSPs, IdPs (including subscriber-controlled wallets), and RPs <strong>SHALL</strong> store all private and shared keys used for signing, encryption, and any other cryptographic operations in a secure fashion. Key storage is subject to applicable <a href="/800-63-4/sp800-63c/references/#ref-FIPS140">[FIPS140]</a> requirements of the FAL at which the key is being used, including applicable tamper resistance requirements.</p>

<p>Some circumstances, such as reaching FAL3 with a subscriber-controlled wallet, require the cryptographic keys to be stored in a non-exportable manner. To be considered non-exportable, key storage <strong>SHALL</strong> either be a separate piece of hardware or an embedded processor or execution environment, e.g., secure element, trusted execution environment (TEE), or trusted platform module (TPM). These hardware modules or embedded processors are separate from a host processor such as the CPU on a laptop or mobile device. Non-exportable key storage <strong>SHALL</strong> be designed to prohibit the export of the secret keys to the host processor and <strong>SHALL NOT</strong> be capable of being reprogrammed by the host processor to allow the secret keys to be extracted.</p>
<h3 id="attestations" data-section="3">
  
  
    Software Attestations <a href="#attestations" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Software and device attestation can be used to augment the establishment of cryptographic keys and identifiers, especially in dynamic and distributed systems. Attestations in this usage are cryptographically-bound statements that a particular piece of software, device, or runtime system meets a set of agreed-upon parameters. The attestation is presented by the software in the context of establishing its identity, and allows the receiver to verify the request with a higher degree of certainty than they would otherwise.</p>

<p>For example, a specific distribution of subscriber-controlled wallet software can be signed by its distributor, allowing RPs to recognize individual instances of that software. Alternatively, an RP could be issued an attestation from a federation authority, allowing IdPs to recognize the RP as part of the federation.</p>

<p>When attestations are required by the trust agreement or requested as part of the federation protocol, received attestations <strong>SHALL</strong> be validated by the receiver.</p>

<p>See <a href="/800-63-4/sp800-63c/references/#ref-RFC7591">[RFC7591]</a> Sec. 2.3 for more information about <em>software statements</em>, which are a means for OAuth and OpenID Connect RPs to communicate a signed set of software attributes during dynamic client registration.</p>
<h2 id="authentication-and-attribute-disclosure" data-section="3">
  
  
    Authentication and Attribute Disclosure <a href="#authentication-and-attribute-disclosure" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Once the IdP and RP have entered into a trust agreement and have completed registration, the federation protocol can be used to pass subscriber attributes from the IdP to the RP.</p>

<p>A subscriber’s attributes <strong>SHALL</strong> be transmitted between IdP and RP only for federation transactions or support functions such as identification of compromised subscriber accounts as discussed in <a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Sec. 3.9</a>. A subscriber’s attributes <strong>SHALL NOT</strong> be transmitted for any other purposes, even when parties are allowlisted.</p>

<p>A subscriber’s attributes <strong>SHALL NOT</strong> be used by the RP for purposes other than those stipulated in the trust agreement. A subscribers attributes <strong>SHALL</strong> be stored and managed in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.</p>

<p>The subscriber <strong>SHALL</strong> be informed of the transmission of attributes to an RP. In the case where the authorized party is the organization, the organization <strong>SHALL</strong> make available to the subscriber the list of approved RPs and the associated sets of attributes sent to those RPs. In the case where the authorized party is the subscriber, the subscriber <strong>SHALL</strong> be prompted prior to release of attributes using a runtime decision at the IdP as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>.</p>
<h2 id="rp-account" data-section="3">
  
  
    RP Subscriber Accounts <a href="#rp-account" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>It is common for an RP to keep a record representing a subscriber local to the RP itself, known as the <em>RP subscriber account</em>. The RP subscriber account can contain things like access rights at the RP as well as a cache of identity attributes for the subscriber. An active RP subscriber account is bound to one or more federated identifiers from the RP’s trusted IdPs. Successful authentication of one of these federated identifiers through a federation protocol allows the subscriber to access the information and functionality protected by the RP subscriber account.</p>

<p>An RP subscriber account is <em>provisioned</em> when the RP has associated a set of attributes about the subscriber with a data record representing the subscriber account at the RP. The RP subscriber account <strong>SHALL</strong> be bound to at least one federated identifier, and a given federated identifier is bound to only one RP subscriber account at a given RP. The provisioning can happen prior to authentication or as a result of the federated authentication process, depending on the deployment patterns as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>. Prior to being provisioned, the RP subscriber account does not exist and has no associated data record at the RP.</p>

<p>An RP subscriber account is <em>terminated</em> when the RP removes all access to the account at the RP. Termination <strong>SHALL</strong> include removal of all federated identifiers and bound authenticators from the RP subscriber account (to prevent future federation transactions) as well as removal of attributes and information associated with the account in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>. An RP <strong>MAY</strong> terminate an RP subscriber account independently from the IdP for a variety of reasons, regardless of the current validity of the subscriber account from which it is derived.</p>

<p>The RP subscriber account can be provisioned at the RP without an authenticated session, but an authenticated session can only be created on a provisioned account. See <a href="/800-63-4/sp800-63c/Federation/#rp-session">Sec. 3.8</a> for more information.</p>
<h3 id="account-linking" data-section="3">
  
  
    Account Linking <a href="#account-linking" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>A single RP subscriber account <strong>MAY</strong> be associated with more than one federated identifier. This practice is sometimes known as <em>account linking</em>. If the RP allows a subscriber to manage multiple accounts in this way, the RP <strong>SHALL</strong> require an authenticated session with the subscriber account for all management and linking functions. This authenticated session <strong>SHOULD</strong> require one existing federated identifier before linking the new federated identifier to the RP subscriber account. An RP <strong>MAY</strong> offer a means of recovery of an RP subscriber account with no current means of access.</p>

<p>When a federated identifier is removed from an RP subscriber account, the RP <strong>SHALL</strong> disallow access to the RP subscriber account from the removed federated identifier.</p>

<p>The RP <strong>SHALL</strong> document its practices and policies that it enacts when an RP subscriber account reaches a state of having zero associated federated identifiers, no means of access, and no means of recovery. In such cases, the RP subscriber account <strong>SHOULD</strong> be terminated and information associated with the account in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.</p>

<p>The RP <strong>SHALL</strong> provide notice to the subscriber when:</p>

<ul>
  <li>A new federated identifier is added to an existing RP subscriber account</li>
  <li>A federated identifier is removed from an RP subscriber account, but the account is not terminated</li>
</ul>

<p>For additional considerations on providing notice to a subscriber about account management events, see <a href="/800-63-4/sp800-63b/events/#notification" latex-href="#ref-SP800-63B">Sec. 4.6 of [SP800-63B]</a>.</p>

<p>The RP <strong>MAY</strong> associate different access rights to the same account depending on which federated account is used to access the RP. The means by which an RP determines authorization and access is out of scope of these guidelines.</p>
<h3 id="account-resolution" data-section="3">
  
  
    Account Resolution <a href="#account-resolution" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>If the RP has access to existing information about a set of subscribers, and this information is not associated with a federated identifier, the RP performs a process known as <em>account resolution</em> to determine which set of subscriber information to associate with a new RP subscriber account.</p>

<p>An RP performing account resolution <strong>SHALL</strong> ensure that the attributes requested from the IdP are sufficient to uniquely resolve the subscriber within the RP’s system before linking the federated identifier with the RP subscriber account and granting access. The intended use of each attribute by the RP is detailed in the trust agreement, including whether the attribute is used for account resolution in this manner.</p>

<p>An RP performing account resolution <strong>SHALL</strong> perform a risk assessment to ensure that the resolution process does not associate an RP subscriber account’s information with a federated identifier not belonging to the subscriber.</p>

<p>A similar account resolution process is also used when the RP verifies an authenticator used in a holder-of-key assertion for the first time. In this case, the RP <strong>SHALL</strong> ensure that the attributes carried with the authenticator uniquely resolve to the subscriber.</p>
<h3 id="alternative-authentication-processes" data-section="3">
  
  
    Alternative Authentication Processes <a href="#alternative-authentication-processes" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The RP <strong>MAY</strong> allow a subscriber to access their RP subscriber account using direct authentication processes by allowing the subscriber to add and remove authenticators in the RP subscriber account. The RP <strong>SHALL</strong> follow the requirements in <a href="/800-63-4/sp800-63b/introduction/#introduction" latex-href="#ref-SP800-63B">[SP800-63B]</a> in managing all alternative authenticators.</p>

<p>Since the RP is using the direct authentication model discussed in <a href="/800-63-4/sp800-63/introduction/#introduction" latex-href="#ref-SP800-63">[SP800-63]</a>, there is no federation transaction and therefore no FAL assigned.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>

<p>If the RP allows this kind of access, the RP <strong>SHALL</strong> disclose in the trust agreement:</p>

<ul>
  <li>The process for adding and removing alternative authenticators in the RP subscriber account</li>
  <li>Any restrictions on authenticators the subscriber can use to access the RP</li>
  <li>The AAL required for access to the subscriber account without a federation transaction</li>
  <li>The circumstances under which the RP will require the subscriber to authenticate with their IdP, such as a period of time since last federation transaction</li>
</ul>

<p>For additional considerations on providing notice to a subscriber about authenticator management events, see <a href="/800-63-4/sp800-63b/events/#notification" latex-href="#ref-SP800-63B">Sec. 4.6 of [SP800-63B]</a>.</p>

<p>While it is possible for a bound authenticator to be used as an alternative authenticator for direct access to the RP, these uses are distinct from each other and an RP needs to determine that the use of a given authenticator can be used in one or both scenarios.</p>
<h2 id="rp-session" data-section="3">
  
  
    Authenticated Sessions at the RP <a href="#rp-session" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The end goal of a federation transaction is creating an authenticated session between the subscriber and the RP, backed by a verified assertion from the IdP. This authenticated session can be used to allow the subscriber access to functions at the RP (i.e., logging in), identifying the subscriber to the RP, or processing attributes about the subscriber carried in the federation transaction.
An authenticated session <strong>SHALL</strong> be created by the RP only when the following conditions are true:</p>

<ul>
  <li>The RP has processed and verified a valid assertion</li>
  <li>The assertion is from the expected IdP for a transaction</li>
  <li>The IdP that issued the assertion is the IdP identified in the federated identifier of the assertion</li>
  <li>The assertion is associated with an RP subscriber account (which may be ephemeral)</li>
  <li>The RP subscriber account has been provisioned at the RP through the method specified in the trust agreement</li>
</ul>

<p>If the assertion is a holder-of-key assertion at FAL3, the authenticator indicated in the assertion <strong>SHALL</strong> be verified before the RP subscriber account is associated with an authenticated session, as discussed in <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec. 3.14</a>.
If the assertion also requires authentication with a bound authenticator at FAL3, a bound authenticator <strong>SHALL</strong> be verified before the RP subscriber account is associated with an authenticated session, as discussed in <a href="/800-63-4/sp800-63c/Federation/#bound-authn">Sec. 3.15</a>.</p>

<p>The authenticated session <strong>MAY</strong> be ended by the RP at any time.</p>

<p>See <a href="/800-63-4/sp800-63b/session/#sec7" latex-href="#ref-SP800-63B">[SP800-63B] Sec. 5</a> for more information about session management requirements for both IdPs and RPs. For additional session requirements with general purpose IdPs, see <a href="/800-63-4/sp800-63c/GenIdP/#federation-session">Sec. 4.7</a>.</p>
<h2 id="privacy-reqs" data-section="3">
  
  
    Privacy Requirements <a href="#privacy-reqs" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The ultimate goal of a subscriber is to interact with and use the RP. Federation involves the transfer of personal attributes from a third party that is not otherwise involved in a transaction — the IdP. Federation also potentially gives the IdP broad visibility into subscriber activities and status. Accordingly, there are specific privacy requirements associated with federation which do not exist in direct authentication.</p>

<p>When the RP requests a federation transaction from the IdP, this request and the subsequent processing of the federation transaction reveals to the IdP where the subscriber is logging in. Over time, the IdP could build a profile of subscriber transactions based on this knowledge of which RPs a given subscriber is using. This aggregation could enable new opportunities for subscriber tracking and use of profile information that do not align with subscribers’ privacy interests.</p>

<p>If the same subscriber account is asserted to multiple RPs, and those RPs communicate with each other, the colluding RPs could track a subscriber’s activity across multiple applications and security domains. The IdP <strong>SHOULD</strong> employ technical measures, such as the use of pairwise pseudonymous identifiers described in <a href="/800-63-4/sp800-63c/Federation/#ppi">Sec. 3.3.1</a> or privacy-enhancing cryptographic protocols, to provide disassociability and discourage subscriber activity tracking and profiling between RPs.</p>

<p>The following requirements apply specifically to federal agencies acting as an IdP, an RP, or both:</p>

<ol>
  <li>
    <p>The agency <strong>SHALL</strong> consult with their Senior Agency Official for Privacy (SAOP) to conduct an analysis determining whether the requirements of the Privacy Act are triggered by the agency that is acting as an IdP, by the agency that is acting as an RP, or both (see <a href="/800-63-4/sp800-63c/privacy/#agency-privacy">Sec. 7.4</a>).</p>
  </li>
  <li>
    <p>The agency <strong>SHALL</strong> publish or identify coverage by a System of Records Notice (SORN) as applicable.</p>
  </li>
  <li>
    <p>The agency <strong>SHALL</strong> consult with their SAOP to conduct an analysis determining whether the requirements of the E-Government Act are triggered by the agency that is acting as an IdP, the agency that is acting as an RP, or both.</p>
  </li>
  <li>
    <p>The agency <strong>SHALL</strong> publish or identify coverage by a Privacy Impact Assessment (PIA) as applicable.</p>
  </li>
  <li>
    <p>The agency <strong>SHALL</strong> conduct a privacy risk assessment regarding the sharing of subscriber identity information between the IdP and RP.</p>
  </li>
</ol>

<p>If the RP subscriber account lifecycle process gives the RP access to attributes through a provisioning API as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>, additional privacy measures <strong>SHALL</strong> be implemented to account for the difference in RP subscriber account lifecycle. The IdP <strong>SHALL</strong> minimize the attributes made available to the RP through the provisioning API. The IdP <strong>SHALL</strong> limit the population of subscriber accounts available via the provisioning API to the population of subscribers authorized to use the RP by the trust agreement. To prevent RP retention of identity attributes for accounts that have been terminated at the IdP, the IdP <strong>SHALL</strong> use the provisioning API to de-provision RP subscriber accounts for terminated subscriber accounts.</p>

<p>Trust agreements <strong>SHOULD</strong> require identity attributes be shared only when the subscriber opts in, using a runtime decision as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>.</p>
<h3 id="transmit-subscriber-info" data-section="3">
  
  
    Transmitting Subscriber Information <a href="#transmit-subscriber-info" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The IdP <strong>SHALL</strong> limit transmission of subscriber information to only that which is necessary for functioning of the system.
These functions include the following:</p>

<ul>
  <li>identity proofing, authentication, or attribute assertions (collectively “identity service”); or</li>
  <li>in the case of a specific subscriber request to transmit the information</li>
</ul>

<p>The IdP <strong>MAY</strong> additionally transmit the subscriber’s information in the following cases, if stipulated and disclosed by the trust agreement:</p>

<ul>
  <li>fraud mitigation related to the identity service,</li>
  <li>to respond to a security incident related to the identity service, or</li>
  <li>to comply with law or legal process.</li>
</ul>

<p>If an IdP discloses information on subscriber activities at an RP to any party, or processes the subscriber’s attributes for any purpose other than these cases, the IdP <strong>SHALL</strong> implement measures to maintain predictability and manageability commensurate with the privacy risk arising from the additional processing. Measures <strong>MAY</strong> include providing clear notice, obtaining subscriber consent, or enabling selective use or disclosure of attributes. When an IdP uses consent measures for this purpose, the IdP <strong>SHALL NOT</strong> make consent for the additional processing a condition of the identity service.</p>

<p>An RP <strong>MAY</strong> disclose information on subscriber activities to the associated IdP in the following cases, if stipulated and disclosed by the trust agreement:</p>

<ul>
  <li>fraud mitigation related to the identity service,</li>
  <li>to respond to a security incident related to the identity service, or</li>
  <li>to comply with law or legal process.</li>
</ul>

<p>See [<a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062">NISTIR8062</a>] for additional information on privacy engineering and risk management.</p>
<h2 id="security-controls" data-section="3">
  
  
    Security Controls <a href="#security-controls" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The IdP and RP <strong>SHALL</strong> employ appropriately tailored security controls from the moderate baseline security controls defined in 
<a href="/800-63-4/sp800-63c/references/#ref-SP800-53">[SP800-53]</a> or equivalent federal (e.g., <a href="/800-63-4/sp800-63c/references/#ref-FEDRAMP">[FEDRAMP]</a>)
or industry standard that the organization has determined for the information systems, applications, and
online services that these guidelines are used to protect. The IdP and RP <strong>SHALL</strong> ensure that the minimum
assurance-related controls for the appropriate systems, or equivalent, are satisfied.</p>
<h3 id="injection-protection" data-section="3">
  
  
    Protection from Injection Attacks <a href="#injection-protection" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>An <em>injection attack</em> in the context of a federated protocol consists of an attacker attempting to force an RP to accept or process an assertion or assertion reference in order to gain access to the RP or deny a legitimate subscriber access to the RP. The attacker does this by taking an assertion or assertion reference and injecting it into a vulnerable RP. If the attacker is able to do this successfully, the attacker can trick an RP into binding the attacker’s session to the federated identifier in the assertion. The attackers assertion could be either stolen from a legitimate subscriber or manufactured to perpetrate the attack.</p>

<p>Protection from injection attacks is recommended at all FALs, and this protection is required at FAL2 and above. In all cases, the RP needs to take reasonable steps to prevent an attacker from presenting an injected assertion or assertion reference based on the nature of the RP software, the capabilities of the federation protocol in use, and the needs of the overall system. Both <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> and <a href="/800-63-4/sp800-63c/references/#ref-SAML">[SAML]</a> provide mechanisms for injection protection including nonces sent from the RP during the request, RP authentication for back-channel communications, and methods for the RP to start the federation transaction and track its state throughout the process. Different mechanisms provide different degrees of protection and are applicable in different circumstances.
While the details of specific protections will vary based on the federation protocol and technology in use, common best practices such as the following can be used to limit the attack surface:</p>

<ul>
  <li>The use of back channel assertion presentation as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#back-channel">Sec. 4.11.1</a>, which prevents an attacker from presenting the assertion directly to the RP.</li>
  <li>The use of an unguessable value to tie the unauthenticated session at the RP with the request to the back channel, which prevents an attacker from injecting an assertion reference from one session to another.</li>
  <li>Requiring the RP to authenticate to the IdP during an assertion request, preventing the attacker from faking a request from the RP to begin a federation process.</li>
  <li>Prohibition of IdP-initiated federation processes, which prevent the RP from accepting unsolicited assertions and assertion references from the IdP. This prohibition does not include processes in which an external party (such as the IdP or a federation authority) signals the RP to start a federation process with the IdP, allowing the RP to begin the federation transaction and securely await a response within that transaction.</li>
  <li>The use of a signed front channel response from the IdP with an RP-provided nonce covered by the signature, which prevents the attacker from injecting an assertion reference from one session to another.</li>
  <li>The use of platform APIs for front-channel communication, as opposed to HTTP redirects.</li>
</ul>

<p>Injection attacks are particularly dangerous when combined with phishing attacks. When combined, the attacker can either trick the subscriber into generating a valid assertion for the attacker to inject into the attacker’s session, or the attacker can trick the subscriber into injecting the attacker’s assertion into the subscriber’s session at the RP.</p>
<h3 id="protecting-information" data-section="3">
  
  
    Protecting Subscriber Information <a href="#protecting-information" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Communications between the IdP and the RP <strong>SHALL</strong> be protected in transit using an authenticated protected channel. Communications between the subscriber and either the IdP or the RP (usually through a user agent) <strong>SHALL</strong> be made using an authenticated protected channel.</p>

<p>Note that the IdP may have access to information that may be useful to the RP in enforcing security policies, such as device identity, location, system health checks, and configuration management. If so, it may be a good idea to pass this information along to the RP within the bounds of the subscriber’s privacy preferences described in <a href="/800-63-4/sp800-63c/privacy/#notice">Sec. 7.2</a>.</p>

<p>Additional attributes about the user <strong>MAY</strong> be included outside of the assertion itself by use of authorized access to an identity API as discussed in <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>. Splitting user information in this manner can aid in protecting user privacy and can allow for limited disclosure of identifying attributes on top of the essential information in the authentication assertion itself.</p>

<p>When derived attribute values are available and fulfill the RP’s needs, the RP <strong>SHOULD</strong> request derived attribute values rather than full attribute values as described in <a href="/800-63-4/sp800-63c/privacy/#minimization">Sec. 7.3</a>. The IdP <strong>SHOULD</strong> support derived attribute values to the extent the underlying federation protocol allows.</p>
<h3 id="store-subscriber-info" data-section="3">
  
  
    Storing Subscriber Information <a href="#store-subscriber-info" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The IdP and RP <strong>SHALL</strong> delete personal identity information in the subscriber account and RP subscriber account (respectively) upon account termination, unless required otherwise by legal action or policy.
Whenever personal identity information is stored in a subscriber account or RP subscriber account, whether the account is active or not, the IdP and RP <strong>SHALL</strong> determine and use appropriate controls to ensure secure storage of the personal identity information.</p>

<p>For example, the RP could record the federated identifier in access and audit logs, which logs are retained even after the account has been terminated. However, all identity attributes and personal information are removed from the RP’s own storage.</p>

<p>When the RP uses an ephemeral provisioning mechanism as described in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>, the RP <strong>SHALL</strong> remove all subscriber attributes at the termination of the session, unless required by legal action or policy.</p>
<h2 id="identity-attributes" data-section="3">
  
  
    Identity Attributes <a href="#identity-attributes" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Identity attributes representing the subscriber are sent to the RP during a federation transaction. These attributes take on multiple aspects, which can be combined in different ways.</p>

<dl>
  <dt>Bundling:</dt>
  <dd>Attributes <strong>SHALL</strong> be either <em>unbundled</em> (presented directly by the IdP) or <em>bundled</em> into a package that is cryptographically signed by the CSP, as described in <a href="/800-63-4/sp800-63c/Federation/#attribute-bundles">Sec. 3.11.1</a>.</dd>
  <dt>Derivation:</dt>
  <dd>Attributes <strong>SHALL</strong> be either <em>attribute values</em> (e.g., a date of birth) or <em>derived attribute values</em> (e.g., an indication of age of majority).</dd>
  <dt>Presentation:</dt>
  <dd>Attributes <strong>SHALL</strong> be either presented in the assertion (and therefore covered by the assertion’s signature) or made available as part of a protected identity API.</dd>
</dl>

<p>Trust agreements <strong>SHALL</strong> record the validation practices for all attributes made available under the trust agreement (e.g., whether the attribute is from an authoritative or credible source, self-asserted by the subscriber, assigned by the IdP, etc.).</p>
<h3 id="attribute-bundles" data-section="3">
  
  
    Attribute Bundles <a href="#attribute-bundles" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<blockquote>
  <p>Note: Attribute bundles are often referred to elsewhere as <em>credentials</em> by other protocols and specifications, but usage of this term would be in conflict with its use within these guidelines for a different concept. Consequently, the term attribute bundle is used within these guidelines instead.</p>
</blockquote>

<p>As an alternative to sending attributes directly from the IdP, attributes can be collected into bundles that are signed by the CSP. These attribute bundles can be independently verified by the RP. This pattern is commonly used by a subscriber-controlled wallet. Some examples of technologies used to bundle attributes are Selective Disclosure JSON Web Tokens <a href="/800-63-4/sp800-63c/references/#ref-SD-JWT">[SD-JWT]</a> and the mDoc security object defined in <a href="/800-63-4/sp800-63c/references/#ref-ISOIEC18013">[ISOIEC18013-5]</a>.</p>

<p>The presentation of an attribute bundle <strong>SHALL</strong> be protected by the IdP in the same manner as non-bundled attributes. That is to say, attribute bundles presented in an assertion are covered by the signature of the assertion, and attribute bundles made available by an identity API are protected by the limited access controls to that API.</p>

<p>Attribute bundles include one or more attribute values and derived attribute values. Attribute bundles are carried in the assertion from the IdP, the subscriber attributes within the bundle need not be fully disclosed to all RPs on every transaction and instead <strong>MAY</strong> be selectively disclosed to the RP. An attribute bundle using selective disclosure technology can effectively limit which attributes an RP can read from the attribute bundle. The RP can still verify the signature of the attribute bundle as a whole, confirming its source as the CSP, without the IdP having to disclose all of the contents of the attribute bundle to the RP.</p>

<p>The RP <strong>SHALL</strong> validate the signature covering the attribute bundle itself as well as the signature of the assertion as a whole. The RP <strong>SHALL</strong> ensure that the attribute bundle is able to be presented by the IdP that created the assertion containing the attribute bundle, such as by verifying that the public key used to sign the assertion is included in the signature of the attribute bundle.</p>
<h3 id="derived-attribute-values" data-section="3">
  
  
    Derived Attribute Values <a href="#derived-attribute-values" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>For some use cases, knowing the actual value of an identity attribute is not strictly necessary for the RP to function, but a value derived from the identity attribute is sufficient instead. For example, if the RP needs to know if the subscriber is above the age of majority, the RP could request the subscriber’s birth date and calculate the majority age question from this value. However, doing so reveals more specific information to the RP than it truly needed. Instead, if the IdP can calculate whether the subscriber’s age meets the definitions for majority at the time of the RP’s request and return a simple boolean for this derivation instead of the birth date value itself. The RP can then continue its processing without needing to see the underlying value.</p>

<p>Derived attribute values increase the privacy of a system since they allow a more focused release of information to the RP. While some federation systems allow the RP to dynamically query for an arbitrary derived attribute value at request time, many common use cases can be accommodated by the IdP pre-calculating common derived attribute values and offering them as alternatives to the full attribute value.</p>
<h3 id="s-identity-api" data-section="3">
  
  
    Identity APIs <a href="#s-identity-api" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Attributes about the subscriber, including profile information, <strong>MAY</strong> be provided to the RP through a protected API known as the <em>identity API</em>. The RP is granted limited access to the identity API during the federation transaction, in concert with the assertion. For example, in OpenID Connect, the UserInfo Endpoint provides a standardized identity API for fetching attributes about the subscriber. This API is protected by an OAuth 2.0 Access Token, which is issued to the RP along with OpenID Connect’s assertion, the ID Token.</p>

<p>By making attributes available at an identity API, the IdP no longer has to use the assertion to convey as much information to the RP. This not only means that sensitive attributes do not have to be carried in the assertion itself, it also makes the assertion smaller and easier to process by the RP. The contents of the assertion can then be limited to essential fields (e.g., unique subject identifiers) and information about the immediate authentication event being asserted.</p>

<p>Identity APIs also make it possible for the RP to help manage when subscriber attributes are transmitted from the IdP. The RP often caches attributes provided by the IdP in an RP subscriber account, discussed in <a href="/800-63-4/sp800-63c/Federation/#rp-account">Sec. 3.10.1</a>, and the RP can record when these attributes were last received from the IdP. The RP can request subscriber attributes only when needed to update the RP subscriber account, instead of receiving them on every federation transaction in the assertion. The IdP can aid this decision by indicating in the assertion the time at which any of the subscriber attributes available to the RP were updated at the IdP. This approach is particularly helpful when a subscriber’s attributes are stable over time, allowing the RP to function without fetching them on every request.</p>

<p>All possible use of identity APIs, including which provisioning models are available through the API, <strong>SHALL</strong> be recorded and disclosed as part of the trust agreement. Access to the identity API <strong>SHALL</strong> be time limited by the trust agreement. Access to the identity API <strong>SHOULD</strong> be limited to the duration of the federation transaction plus time necessary for synchronization of attributes, as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#attribute-sync">Sec. 4.6.4</a>. Since the time limitation is separate from the validity time window of the assertion and the lifetime of the authenticated session at the RP, access to an identity API by the RP without an associated valid assertion <strong>SHALL NOT</strong> be sufficient for the establishment of an authenticated session at the RP.</p>

<p>A given identity API deployment is expected to be capable of providing attributes for all subscribers for whom the IdP can create assertions. However, when access to the identity API is granted within the context of a federation transaction, the attributes provided by an identity API <strong>SHALL</strong> be associated with only the single subscriber identified in the associated assertion. If the identity API is hosted by the IdP, the returned attributes <strong>SHALL</strong> include the subject identifier for the subscriber. This allows the RP to positively correlate the assertion’s subject to the returned attributes. Note that when access to an identity API is provided as part of pre-provisioning of RP subscriber accounts as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>, the RP is usually granted blanket access to the identity API outside the context of the federation transaction and these requirements do not apply. For pre-provisioning use cases, the privacy considerations <strong>SHALL</strong> be evaluated and recorded as part of the trust agreement. If the identity API is hosted externally, the requirements in <a href="3_federation#external-identity-api">Sec. 3.11.3.1</a> apply.</p>
<h4 id="external-identity-api" data-section="3">
  
  
    External Identity APIs <a href="#external-identity-api" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>While most identity APIs used in federation protocols are hosted as part of the IdP, it is also possible for the IdP to grant access to identity APIs hosted directly by attribute providers. These services provide attributes about the subscriber in addition to those made available directly from the IdP.</p>

<p>When the IdP grants access to an external attribute provider, the IdP is making an explicit statement that the information returned from the attribute provider is associated with the subscriber identified in the associated assertion. For the purposes of the trust agreement, the IdP is the responsible party for the accuracy and content of the identity API and its association with the represented subscriber account.</p>

<p>The attributes returned by the attribute provider are assumed to be independent of those returned directly from the IdP, and as such <strong>MAY</strong> use different identifiers, formats, or schemas.</p>

<p>For example, an IdP could provide access to a subscriber’s medical license information as part of the federation process. Instead of the IdP asserting the license status directly, the IdP provides the RP access to a record for the subscriber at a medical licensure agency by providing a link to an API containing the record representing the subscriber as well as a credential allowing limited access to this API. The RP can then make a strong association between the current subscriber and the license record, even though the license record will likely use a different subject identifier and would otherwise be not correlatable by the RP. The trust agreement would list the medical licensure agency as an additional attribute provider to the IdP. The IdP remains responsible for providing this linked data.</p>

<p>Before accepting attributes from an external identity provider and associating them with the RP subscriber account, the RP <strong>SHALL</strong> verify that the attributes in question are allowed to be provided by the external attribute provider under the auspices of the trust agreement.</p>
<h2 id="assertion-protection" data-section="3">
  
  
    Assertion Protection <a href="#assertion-protection" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Assertions <strong>SHALL</strong> include a set of protections to prevent attackers from manufacturing valid assertions or reusing captured assertions at disparate RPs. The protections required are dependent on the details of the use case being considered, and specific protections are listed here.</p>
<h3 id="assertion-id" data-section="3">
  
  
    Assertion Identifier <a href="#assertion-id" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Assertions <strong>SHALL</strong> be sufficiently unique to permit unique identification by the target RP. Assertions <strong>MAY</strong> accomplish this by use of an embedded nonce, issuance timestamp, assertion identifier, or a combination of these or other techniques.</p>
<h3 id="signed-assertion" data-section="3">
  
  
    Signed Assertion <a href="#signed-assertion" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Assertions <strong>SHALL</strong> be cryptographically signed by the issuer (IdP). The RP <strong>SHALL</strong> validate the digital signature or MAC of each such assertion based on the issuer’s key. This signature <strong>SHALL</strong> cover the entire assertion, including its identifier, issuer, audience, subject, and expiration.</p>

<p>The assertion signature <strong>SHALL</strong> either be a digital signature using asymmetric keys or a MAC using a symmetric key shared between the RP and issuer. Shared symmetric keys used for this purpose by the IdP <strong>SHALL</strong> be independent for each RP to which they send assertions, and are normally established during registration of the RP. Public keys for verifying digital signatures <strong>SHALL</strong> be transferred to the RP in a secure manner, and <strong>MAY</strong> be fetched by the RP in a secure fashion at runtime, such as through an HTTPS URL hosted by the IdP. Approved cryptography <strong>SHALL</strong> be used.</p>
<h3 id="encrypted-assertion" data-section="3">
  
  
    Encrypted Assertion <a href="#encrypted-assertion" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The contents of the assertion can be encrypted to protect their exposure to untrusted third parties, such as a user agent. This protection is especially relevant when the assertion contains PII of the subscriber—excluding opaque identifiers such as the subject identifier. Subject identifiers are meaningless outside of their target systems, unlike other possible identifiers such as SSN, email address, or driver’s license number. Therefore, subject identifiers are excluded as a qualifier for encrypting the assertion.
A trust agreement <strong>MAY</strong> require encryption of assertion contents in other situations.</p>

<p>When the entire assertion is encrypted, the encryption protects the contents of the assertion from being read by unintended parties, ensuring that only the targeted RP is able to process the assertion.
While most assertion formats support encryption of the entire assertion, some assertion formats allow for only the PII portions of the assertion to be encrypted, providing selective disclosure of sensitive information to the RP without encrypting the entire assertion.</p>

<p>When encrypting assertions, the IdP <strong>SHALL</strong> encrypt the contents of the assertion using either the RP’s public key or a shared symmetric key. Shared symmetric keys used for this purpose by the IdP <strong>SHALL</strong> be independent for each RP to which they send assertions, and are normally established during registration of the RP. Public keys for encryption <strong>SHALL</strong> be transferred over an authenticated protected channel and <strong>MAY</strong> be fetched by the IdP at runtime, such as through an HTTPS URL hosted by the RP.</p>

<p>All encryption of assertions <strong>SHALL</strong> use approved cryptography applied to the federation technology in use.
For example, a SAML assertion can be encrypted using XML-Encryption, or an OpenID Connect ID Token can be encrypted using JSON Web Encryption (JWE).
When used with back-channel presentation, an assertion can also be encrypted with a mutually-authenticated TLS connection, so long as there are no intermediaries between the IdP and RP that interrupt the TLS channel.</p>
<h3 id="audience-restriction" data-section="3">
  
  
    Audience Restriction <a href="#audience-restriction" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Assertions <strong>SHALL</strong> use audience restriction techniques to allow an RP to recognize whether or not it is the intended target of an issued assertion. All RPs <strong>SHALL</strong> check that the audience of an assertion contains an identifier for their RP to prevent the injection and replay of an assertion generated for one RP at another RP.</p>

<p>In order to limit the places that an assertion could successfully be replayed by an attacker, IdPs <strong>SHOULD</strong> issue assertions designated for only a single audience. Restriction to a single audience is required at FAL2 and above.</p>
<h2 id="bearer" data-section="3">
  
  
    Bearer Assertions <a href="#bearer" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A bearer assertion can be presented on its own as proof of the identity of the party presenting it. No other proof beyond validation of the assertion is required. Similarly, a bearer assertion reference can be presented own its own to the RP and used by the RP to fetch an assertion. If an attacker can capture or manufacture a valid assertion or assertion reference representing a subscriber and can successfully present that assertion or reference to the RP, then the attacker could be able to impersonate the subscriber at that RP.</p>

<p>Note that mere possession of a bearer assertion or reference is not always enough to impersonate a subscriber. For example, if an assertion is presented in the back-channel federation model (described in <a href="/800-63-4/sp800-63c/GenIdP/#back-channel">Sec. 4.11.1</a>), additional controls can be placed on the transaction (such as identification of the RP and assertion injection protections) that help further protect the RP from fraudulent activity.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>
<h2 id="idp-managed-bound-authn" data-section="3">
  
  
    Holder-of-Key Assertions <a href="#idp-managed-bound-authn" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A holder-of-key assertion as in <a href="/800-63-4/sp800-63c/Federation/#fig-3">Fig. 3</a> <strong>SHALL</strong> include a unique identifier for an authenticator that can be verified independently by the RP, such as the public key of a certificate controlled by the subscriber. The RP <strong>SHALL</strong> verify that the subscriber possesses the authenticator identified by the assertion.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-9" name="fig-3">Fig. 3. Holder-of-Key Assertions</a></p>

<p><img src="/800-63-4/sp800-63c/images/IdP-Managed-Bound-Auth.png" alt="Diagram illustrating the use of holder-of-key assertions." title="Holder-of-Key Assertions" latex-src="IdP-Managed-Bound-Auth.pdf" latex-fig="3" latex-place="h" /></p>

<p>The authenticator identified in a holder-of-key assertion <strong>MAY</strong> be distinct from the primary authenticator the subscriber uses to authenticate to the IdP. The authenticator identified in a holder-of-key assertion <strong>SHALL</strong> be phishing resistant. When the RP encounters an authenticator in a holder-of-key assertion for the first time, the RP <strong>SHALL</strong> ensure that the authenticator can be uniquely resolved to the RP subscriber account, as discussed in <a href="/800-63-4/sp800-63c/Federation/#account-resolution">Sec. 3.7.2</a>.</p>

<p>A holder-of-key assertion <strong>SHALL NOT</strong> include an unencrypted private or symmetric key to be used as an authenticator.</p>

<p>When the RP uses an ephemeral provisioning mechanism as described in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>, the IdP <strong>SHOULD</strong> use a unique pairwise identifier for each authorization request to the RP to prevent the RP from storing or correlating information.</p>

<p>A more complete example is found in <a href="/800-63-4/sp800-63c/examples/#fal3-smart-card">Sec 10.6</a>, which shows the use of a mutual TLS connection to provide the proof of possession of a certificate on a smart card that is listed by the assertion.</p>

<p>Since the authenticators used in holder-of-key assertions are presented to multiple parties, and these authenticators often contain identity attributes, there are additional privacy considerations to address as discussed in <a href="/800-63-4/sp800-63c/privacy/#privacy">Sec. 7</a>.</p>
<h2 id="bound-authn" data-section="3">
  
  
    Bound Authenticators <a href="#bound-authn" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A bound authenticator as shown in <a href="/800-63-4/sp800-63c/Federation/#fig-4">Fig. 4</a> is an authenticator bound to the RP subscriber account and managed by the RP. The IdP <strong>SHALL</strong> include an indicator in the assertion when the assertion is to be used with a bound authenticator at FAL3. The unique identifier for the authenticator (such as its public key) <strong>SHALL</strong> be stored in the RP subscriber account. The RP needs to have a reliable basis for evaluating the characteristics of the bound authenticator; one such basis is the inclusion of a signed attestation, as discussed in <a href="/800-63-4/sp800-63b/authenticators/#attestation" latex-href="#ref-SP800-63B">Sec. 3.2.4 of [SP800-63B]</a>.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-10" name="fig-4">Fig. 4. Bound Authenticators</a></p>

<p><img src="/800-63-4/sp800-63c/images/RP-Managed-Bound-Auth.png" alt="Diagram illustrating the use of bound authenticators managed at the RP." title="Bound Authenticators" latex-src="RP-Managed-Bound-Auth.pdf" latex-fig="4" latex-place="h" /></p>

<p>A bound authenticator <strong>SHALL</strong> be unique per subscriber at the RP such that two subscribers cannot present the same authenticator for their separate RP subscriber accounts. All bound authenticators <strong>SHALL</strong> be phishing resistant. Consequently, subscriber-chosen values such as a password cannot be used as bound authenticators.
The RP <strong>SHALL</strong> accept authentication from a bound authenticator only in the context of processing an FAL3 assertion for a federation transaction. While it’s possible for the same authenticator to also be used for direct authentication to the RP, such use is not considered a bound authenticator and the RP <strong>SHALL</strong> document these as distinct use cases.</p>

<p>Before an RP can successfully accept an FAL3 assertion, the RP subscriber account <strong>SHALL</strong> include a reference to a bound authenticator that is to be verified during the FAL3 transaction. These authenticators can be provided by either the RP or the subscriber, with slightly different requirements applying to the initial binding of the authenticator to the RP subscriber account in each case.</p>

<p>The RP <strong>SHALL</strong> send a notification to the subscriber via a mechanism that is independent of the transaction binding the new authenticator (e.g., an email to an address previously associated with the subscriber), and <strong>SHOULD</strong> notify the IdP using a shared signaling system (see <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec. 4.8</a>), if any of the following events occur:</p>

<ul>
  <li>A new bound authenticator is added to the RP subscriber account.</li>
  <li>An existing bound authenticator is removed from the RP subscriber account.</li>
</ul>

<p>For additional considerations on providing notice to a subscriber about authenticator management events, see <a href="/800-63-4/sp800-63b/events/#notification" latex-href="#ref-SP800-63B">Sec. 4.6 of [SP800-63B]</a>.</p>
<h3 id="rp-managed-rp-provided-bound-authn" data-section="3">
  
  
    RP-Provided Bound Authenticator Issuance <a href="#rp-managed-rp-provided-bound-authn" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>For RP-provided authenticators, the administrator of the RP <strong>SHALL</strong> issue the authenticator to the subscriber directly for use with an FAL3 federation transaction. The administrator of the RP <strong>SHALL</strong> store a unique identifier for the bound authenticator in the RP subscriber account, such as the public key of the authenticator.</p>

<p>The administrator of the RP <strong>SHALL</strong> determine through independent means that the identified subject of the RP subscriber account is the party to which the authenticator is issued.</p>

<p>For example, consider an RP that has a collection of cryptographic authenticators that it has purchased for use with FAL3 authentication. These authenticators are each provisioned to a specific RP subscriber account, but are held in a controlled environment by the administrator of the RP. To issue the authenticator, the RP could use an in-person process in which the administrator of the RP has the subscriber authenticate to an RP-controlled kiosk using an FAL3 federation transaction from the IdP. The administrator then hands the subscriber the bound authenticator indicated by the RP subscriber account and has them authenticate to the kiosk using that. The subscriber is now in possession of a bound authenticator supplied by the RP, which can be used to reach FAL3 for future transactions. Alternatively, the administrator of the RP could send the authenticator to a verified address for the subscriber and have the subscriber verify receipt through an activation process. Since the use of the bound authenticator still requires a valid assertion from the IdP, interception of the authenticator alone is not sufficient for accessing the RP subscriber account.</p>
<h3 id="rp-managed-subscriber-provided-bound-authn" data-section="3">
  
  
    Subscriber-Provided Bound Authenticator Binding Ceremony <a href="#rp-managed-subscriber-provided-bound-authn" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The RP <strong>MAY</strong> provide a process for associating subscriber-provided authenticators to the RP subscriber account on a trust-on-first-use basis. This process is known as a <em>binding ceremony</em> and has additional requirements beyond a typical FAL3 federation process. This is similar to the subscriber-provided authenticator binding process discussed in <a href="/800-63-4/sp800-63b/events/#bind-subscriber-authenticator" latex-href="#ref-SP800-63B">Sec. 4.1.3 of [SP800-63B]</a>.</p>

<p>If no bound authenticators are associated with the RP subscriber account, the RP <strong>SHALL</strong> perform a binding ceremony to establish the connection between the authenticator, the subscriber, and the RP subscriber account as shown in <a href="/800-63-4/sp800-63c/Federation/#fig-5">Fig. 5</a>. The RP <strong>SHALL</strong> first establish an authenticated session using federation with an assertion that meets all the other requirements of FAL3, including an indication that the assertion is intended for use at FAL3 with a bound authenticator. The subscriber <strong>SHALL</strong> immediately be prompted to present and authenticate with the proposed authenticator. Upon successful presentation of the authenticator, the RP <strong>SHALL</strong> store a unique identifier for the authenticator (such as its public key) and associate this with the RP subscriber account associated with the federated identifier. If the subscriber fails to successfully authenticate to the RP using an appropriate authenticator, the binding ceremony fails. The binding ceremony session <strong>SHALL</strong> have a timeout of five minutes or less and <strong>SHALL NOT</strong> be used as an authenticated session for any other purpose as described in <a href="/800-63-4/sp800-63c/Federation/#rp-session">Sec. 3.8</a>. Upon successful completion of the binding ceremony, the RP <strong>SHALL</strong> immediately request a new assertion from the IdP at FAL3, including prompting the subscriber for the newly-bound authenticator.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-11" name="fig-5">Fig. 5. Subscriber-Provided Bound Authenticator Binding Ceremony</a></p>

<p><img src="/800-63-4/sp800-63c/images/Binding-Ceremony.png" alt="Sequence diagram of the steps involved in the binding ceremony used for bound authenticators managed at the RP and provided by the subscriber." title="Subscriber-Provided Bound Authenticator Binding Ceremony" latex-src="Binding-Ceremony.pdf" latex-fig="5" latex-place="p" /></p>

<p>An RP <strong>MAY</strong> allow a subscriber to bind multiple subscriber-provided authenticators at FAL3. If this is the case, and the RP subscriber account has one or more existing bound authenticators, the binding ceremony makes use of the existing ability to reach FAL3. The subscriber <strong>SHALL</strong> first be prompted to authenticate to the RP with an existing bound authenticator to reach FAL3. Upon successful authentication, the RP <strong>SHALL</strong> immediately prompt the subscriber to authenticate to the RP using the newly-bound authenticator.</p>

<p>In addition to an RP determining a bound authenticator is no longer viable, a subscriber could choose to stop using a bound authenticator for a variety of reasons, such as the authenticator being lost, compromised, or no longer usable due to technology and platform changes.
In such cases, an RP <strong>MAY</strong> allow a subscriber to remove a subscriber-provided bound authenticator from their RP subscriber account, thereby removing the ability to use that authenticator for FAL3 sessions. When a bound authenticator is removed, the RP <strong>SHALL</strong> terminate all current FAL3 sessions for the subscriber and <strong>SHALL</strong> require reauthentication at FAL3 of the subscriber from the IdP. The RP <strong>SHALL NOT</strong> prompt the subscriber to authenticate with the authenticator being removed, since the subscriber will often not have access to the authenticator in question during the unbinding process, particularly in cases where the authenticator is lost or compromised.</p>

<p>This option is particularly helpful in situations where the subscriber already has access to an appropriate authenticator that the RP wants to allow them to use for FAL3 transactions.
For example, a subscriber could have a single-factor cryptographic authenticator which uses name-based phishing resistance as described in <a href="/800-63-4/sp800-63b/authenticators/#verifier-name-binding" latex-href="#ref-SP800-63B">Sec. 3.2.5.2 of [SP800-63B]</a>. With such a device, the IdP and RP would see different keys when the authenticator is used in each location, meaning the bound authenticator cannot be easily verified by the IdP. Furthermore, since the RP did not issue the authenticator, the RP does not know the authenticator’s key ahead of time, nor does it know which subscriber account to associate to the key. Instead, the RP can use a binding ceremony as described here to allow the subscriber to use this device as a bound authenticator at FAL3.
A more complete example is found in <a href="/800-63-4/sp800-63c/examples/#fal3-nonpki">Sec 10.7</a>.</p>
<h2 id="rp-requirements-for-processing-holder-of-key-assertions-and-bound-authenticators" data-section="3">
  
  
    RP Requirements for Processing Holder-of-Key Assertions and Bound Authenticators <a href="#rp-requirements-for-processing-holder-of-key-assertions-and-bound-authenticators" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>When the RP receives an assertion associated with a bound authenticator, the subscriber proves possession of the bound authenticator directly to the RP. The primary authentication at the IdP and the federated authentication at the RP are processed separately. While the subscriber could use the same authenticator during the primary authentication at the IdP and as the bound authenticator at the RP, there is no assumption that these will be the same.</p>

<p>The following requirements apply to all assertions associated with a bound authenticator:</p>

<ol>
  <li>The subscriber <strong>SHALL</strong> prove possession of the bound authenticator to the RP, in addition to presentation of the assertion itself.</li>
  <li>For a holder-of-key assertion, a reference to a given authenticator found within an assertion <strong>SHALL</strong> be trusted at the same level as all other information within the assertion, as stipulated in the trust agreement.</li>
  <li>The RP <strong>SHALL</strong> process and validate the assertion in addition to the bound authenticator.</li>
  <li>Failure to authenticate with the bound authenticator <strong>SHALL</strong> result in an error at the RP.</li>
</ol>

<h1 id="GenIdP" data-section="4">
  
  
    General-Purpose IdPs <a href="#GenIdP" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is normative.</em></p>

<p>When the IdP is hosted on a service and not on the subscriber’s device, or when the IdP represents multiple subscribers, the IdP is known as a <em>general-purpose IdP</em> and the following requirements apply.</p>

<p>Digital wallets that are deployed to networked systems and not to subscriber devices are considered general-purpose IdPs for the purposes of these guidelines.</p>
<h2 id="idp-account-provisioning" data-section="4">
  
  
    IdP Account Provisioning <a href="#idp-account-provisioning" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>In order to make subscriber accounts available through an IdP, the subscriber accounts need to be provisioned at the IdP. The means by which the subscriber account is provisioned to the IdP <strong>SHALL</strong> be disclosed in the trust agreement.</p>

<p>Due to the requirement for the IdP to be able to authenticate the subscriber, the IdP is often a service of the CSP, where the IdP has some level of access to the attributes and authenticators in the subscriber account. Such IdPs are generally in the same security domain as the IdAM that houses the subscriber account. In other cases, one or more authenticators in the subscriber account can be verified outside of the security domain, such as authenticators tied to a common PKI.</p>

<p>The IdP augments the subscriber account with federation-specific attributes, such as a subject identifier. The IdP can collect additional attributes, subject to the privacy and storage requirements enumerated by the trust agreement.</p>

<p>Once the subscriber account is provisioned to the IdP, the CSP is no longer an active participant in the federation process.
Consequently, even if the RP fetches attributes through an identity API hosted by the CSP, the identity API is considered a function of the IdP and not the CSP for the purposes of these guidelines.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>
<h2 id="federation-transaction" data-section="4">
  
  
    Federation Transaction <a href="#federation-transaction" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A federation transaction involving a general-purpose IdP establishes the subscriber account at the IdP and culminates in an authenticated session for the subscriber at the RP. This process is shown in <a href="/800-63-4/sp800-63c/GenIdP/#fig-6">Fig. 6</a>.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-6" name="fig-6">Fig. 6. Federation Overview</a></p>

<p><img src="/800-63-4/sp800-63c/images/federation.png" alt="Overview diagram of federated authentication systems showing parties involved and major steps in the process." title="Federation Overview" latex-src="federation.pdf" latex-fig="6" latex-place="h" /></p>

<p>A federation transaction is a multi-stage process:</p>

<ol>
  <li>
    <p>Before federation can occur, the subscriber account is established by the CSP. This account binds the identity attributes collected by the CSP to a set of authenticators used by the subscriber.</p>
  </li>
  <li>
    <p>The subscriber account is provisioned at the IdP. The IdP augments the subscriber account with federation-specific attributes, such as a subject identifier.</p>
  </li>
  <li>
    <p>The IdP and RP perform discovery and registration to establish the cryptographic keys and identifiers needed for information to be securely exchanged between the parties in the federation protocol. While there may have been an existing policy decision representing a permission to connect (through an apriori trust agreement), this step entails a connection and integration at the technical level. This stage can occur before any subscriber tries to access the RP or as a response to a subscriber’s attempt to use an IdP at an RP.</p>
  </li>
  <li>
    <p>The IdP and RP begin a federated authentication transaction to authenticate a subscriber to the RP. As part of this, the set of attributes that is to be passed to the RP is selected from a subset of what the RP has requested, what is allowed by the trust agreement, and what is permitted by the authorized party. If necessary, the authorized party is prompted at runtime to approve the release of attributes.</p>
  </li>
  <li>
    <p>The subscriber authenticates to the IdP using an authenticator bound to the subscriber account.</p>
  </li>
  <li>
    <p>The IdP creates an assertion to represent the results of the authentication event. The assertion is based on terms established by the trust agreement, the request from the RP, the capabilities of the IdP, the subscriber account known to the IdP, and the attributes permitted by the authorized party.</p>
  </li>
  <li>
    <p>The assertion is passed to the RP across the network.</p>
  </li>
  <li>
    <p>The RP processes this assertion from the IdP and establishes an authenticated session with the subscriber. Optionally, the RP receives identity attributes from the IdP representing the subscriber account, either in the assertion or through an identity API.</p>
  </li>
</ol>

<p>In all transactions, the parties involved enter into a trust agreement, described in <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a>. This agreement establishes which parties are fulfilling which roles, and its execution represents initial permission for the systems in question to connect. The list of available subscriber identity attributes is established in this step, though the decision of which attributes are released to a given RP for a given transaction is finalized during the federation transaction itself.</p>

<p>In a federated identity transaction, the IdP is the source of identity and authentication attributes for the RP. The normal flow of information for a federation transaction is from the IdP to the RP. Due to the directional nature of this information flow, the IdP is considered to be <em>upstream</em> of the RP and the RP is considered to be <em>downstream</em> of the IdP. It is also possible for additional information to flow back up from the RP, particularly through use of shared signals as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec. 4.8</a>.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>
<h2 id="trust-agreements" data-section="4">
  
  
    Trust Agreements <a href="#trust-agreements" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Trust agreements <strong>SHALL</strong> be established either:</p>

<ul>
  <li>as the result of an agreement by the federated parties, prior to the federation transaction, or</li>
  <li>as the result of decision or action by the subscriber, during the federation transaction.</li>
</ul>
<h3 id="apriori-trust-agreement-establishment" data-section="4">
  
  
    Apriori Trust Agreement Establishment <a href="#apriori-trust-agreement-establishment" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>When the trust agreement is established by the federated parties prior to the federation transaction, the trust agreement <strong>SHALL</strong> establish the following terms, which <strong>MAY</strong> vary per IdP and RP relationship:</p>

<ul>
  <li>The set of subscriber attributes the CSP makes available to the IdP as part of the subscriber account</li>
  <li>The set of subscriber attributes the IdP can make available to the RP</li>
  <li>The attribute storage policy of the IdP for the subscriber account, including any available means for the subscriber to request deletion</li>
  <li>Any additional attribute sources that the IdP receives applicable subscriber attributes from</li>
  <li>What if any identity APIs are made available by the IdP, either directly or through an external provider, and which subscriber attributes are available at these APIs</li>
  <li>The population of subscriber accounts that the IdP can create assertions for</li>
  <li>Any additional uses of subscriber information, beyond providing the identity service</li>
  <li>The set of subscriber attributes that the RP will request (a subset of the attributes made available)</li>
  <li>The purpose for each attribute requested by the RP</li>
  <li>The attribute storage policy of the RP for the RP subscriber account, including any available means for the subscriber to request deletion</li>
  <li>The use of any shared signaling between the IdP and RP</li>
  <li>The authorized party responsible for decisions regarding the release of subscriber attributes to the RP (e.g., the IdP organization, the subscriber, etc.)</li>
  <li>The means of informing subscribers about attribute release to the RP</li>
  <li>The xALs available from the IdP</li>
  <li>The xALs required by the RP</li>
</ul>

<p>The terms of the trust agreement <strong>SHALL</strong> be available to the operators of the RP and the IdP upon its establishment. The terms of the trust agreement <strong>SHALL</strong> be made available to subscribers upon request to the IdP or RP.</p>

<p>The IdP and RP <strong>SHALL</strong> each assess their respective redress mechanisms for their efficacy in achieving a resolution of complaints or problems and disclose the results of this assessment as part of the trust agreement. See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>

<p>If FAL3 is allowed within the trust agreement, the trust agreement <strong>SHALL</strong> stipulate the following terms regarding holder-of-key assertions and bound authenticators (see <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec. 3.14</a> and <a href="/800-63-4/sp800-63c/Federation/#bound-authn">Sec. 3.15</a>):</p>

<ul>
  <li>The means by which holder-of-key assertions can be verified by the RP (such as a common trusted PKI system)</li>
  <li>The means by which the RP can associate holder-of-key assertions with specific RP subscriber accounts (such as attribute-based account resolution or pre-provisioning)</li>
  <li>Whether bound authenticators are supplied by the RP or by the subscriber</li>
  <li>Documentation of the binding ceremony used for any subscriber-provided bound authenticators</li>
</ul>

<p>Runtime decisions at the IdP, as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>, <strong>MAY</strong> be used to further limit which subscriber attributes are sent between parties in the federated authentication process (e.g., a runtime decision could opt to not disclose an email address even though this attribute was included in the terms of the trust agreement).</p>

<p>The IdP and RP <strong>SHALL</strong> exchange only the minimum data necessary to achieve the function of the system.</p>

<p>The trust agreement <strong>SHALL</strong> be reviewed periodically to ensure it is still fit for purpose, and to avoid unnecessary data exchange and over-collection of subscriber data.</p>
<h3 id="subscriber-driven-trust-agreement-establishment" data-section="4">
  
  
    Subscriber-driven Trust Agreement Establishment <a href="#subscriber-driven-trust-agreement-establishment" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>When the trust agreement is established as the result of a subscriber’s decision, such as a subscriber starting a federation transaction between an RP and their IdP who have no established agreement, the trust agreement is anchored by the subscriber. Consequently, the following terms <strong>SHALL</strong> be disclosed to the subscriber upon request to the IdP and to the RP during the runtime decision at the IdP as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>:</p>

<ul>
  <li>The set of subscriber attributes the CSP makes available to the IdP</li>
  <li>Any additional attribute sources that the IdP receives applicable subscriber attributes from</li>
  <li>What if any identity APIs are made available by the IdP, either directly or through an external provider, and which subscriber attributes are available at these APIs</li>
  <li>The set of subscriber attributes the IdP can make available to the RP</li>
  <li>The attribute storage policy of the IdP for the subscriber account, including any available means for the subscriber to request deletion</li>
  <li>The use of any shared signaling between the IdP and RP</li>
  <li>The population of subscriber accounts that the IdP can create assertions for</li>
  <li>Any additional uses of subscriber information, beyond providing the identity service</li>
  <li>The xALs available from the IdP</li>
</ul>

<p>The IdP <strong>SHALL</strong> assess its redress mechanisms for their efficacy in achieving a resolution of complaints or problems and disclose the results of this assessment to the subscriber. See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>

<p>The release of subscriber attributes <strong>SHALL</strong> be managed using a runtime decision at the IdP, as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>. The authorized party <strong>SHALL</strong> be the subscriber.</p>

<p>The following terms of the trust agreement <strong>SHALL</strong> be disclosed to the subscriber during the runtime decision:</p>

<ul>
  <li>The set of subscriber attributes that the RP will request (a subset of the attributes made available by the IdP)</li>
  <li>The purpose for each attribute requested by the RP</li>
  <li>The attribute storage policy of the RP for the RP subscriber account, including any available means for the subscriber to request deletion</li>
  <li>The xALs required by the RP</li>
</ul>

<p>Note that all information disclosed to the subscriber needs to be conveyed in a manner that is understandable and actionable, as discussed in <a href="/800-63-4/sp800-63c/usability/#usability">Sec. 8</a>.</p>
<h2 id="discovery-and-registration" data-section="4">
  
  
    Discovery and Registration <a href="#discovery-and-registration" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>To perform a federation transaction with a general-purpose IdP, the RP <strong>SHALL</strong> associate the assertion signing keys and other relevant configuration information with the IdP’s identifier, as stipulated by the trust agreement. If these are retrieved over a network connection, request and retrieval <strong>SHALL</strong> be made over a secure protected channel from a location associated with the IdP’s identifier by the trust agreement. In many federation protocols, this is accomplished by the RP fetching the public keys and configuration data from a URL known to be controlled by the IdP or offered on the IdP’s behalf. It is also possible for the RP to be configured directly with this information in a static fashion, whereby the RP’s administrator enters the IdP information directly into the RP software.</p>

<p>Additionally, the RP <strong>SHALL</strong> register its information either with the IdP or with an authority the IdP trusts, as stipulated by the trust agreement. In many federation protocols, the RP is assigned an identifier during this stage, which the RP will use in subsequent communication with the IdP.</p>

<p>In all of these requirements, the IdP <strong>MAY</strong> use a trusted third party to facilitate its discovery and registration processes, so long as that trusted third party is identified in the trust agreement. For example, a consortium could make use of a hosted service that collects the configuration records of IdPs and RPs directly from participants. Instead of going to the IdP directly for its discovery record, an RP would instead go to this service. The IdP would in turn go to this service to find the identifiers and configuration information for RPs that are needed to connect.</p>
<h3 id="manual-registration" data-section="4">
  
  
    Manual Registration <a href="#manual-registration" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>At all FALs, the cryptographic keys and identifiers of the RP and IdP can be exchanged in a manual process, whereby the administrator of the RP submits the RP’s configuration to the IdP (either directly or through a trusted third party) and receives the identifier to use with that IdP. The RP administrator then configures the RP with this identifier and any additional information needed for the federation transaction to continue.</p>

<p>As this is a manual process, the registration happens prior to the federation transaction beginning.</p>

<p>This process <strong>MAY</strong> be facilitated by some level of automated tooling, whereby the manual configuration points the systems in question to a trusted source of information that can be updated over time. If such automation is used, the trust agreement <strong>SHALL</strong> enumerate the allowable terms of the cryptographic key distribution and assignment, including allowable cache lifetimes.</p>
<h3 id="dynamic-registration" data-section="4">
  
  
    Dynamic Registration <a href="#dynamic-registration" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>At FAL1 and FAL2, the cryptographic keys and identifiers of the RP can be exchanged in a dynamic process, whereby the RP software presents its configuration to the IdP (either directly or through a trusted third party) and receives the identifier to use with that IdP. This process is specific to the federation protocol in use but requires machine-readable configuration data to be made available over the network. All transmission of configuration information <strong>SHALL</strong> be made over a secure protected channel to endpoints associated with the IdP’s identifier by the trust agreement.</p>

<p>IdPs <strong>SHOULD</strong> consider the risks of information leakage to multiple RP instances and take appropriate countermeasures, such as issuing PPIs to dynamically registered RPs as discussed in <a href="/800-63-4/sp800-63c/Federation/#ppi">Sec. 3.3.1</a>.</p>

<p>Dynamic registration <strong>SHOULD</strong> be augmented by attestations about the RP software and device, as discussed in <a href="/800-63-4/sp800-63c/Federation/#attestations">Sec. 3.5.3</a>.</p>

<p><a href="/800-63-4/sp800-63c/references/#ref-OIDC-registration">[OIDC-Registration]</a> defines a protocol for dynamic registration of RPs at an OpenID Connect IdP.</p>
<h2 id="subscriber-authentication-at-the-idp" data-section="4">
  
  
    Subscriber Authentication at the IdP <a href="#subscriber-authentication-at-the-idp" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>In a federation context, the IdP acts as the verifier for the authenticator bound to the subscriber account, as described in <a href="/800-63-4/sp800-63b/introduction/#introduction" latex-href="#ref-SP800-63B">[SP800-63B]</a>.
Verification of the authenticator creates an authentication event which begins the authenticated session at the IdP. This authenticated session serves as the basis of the IdP’s claim that the subscriber is present.</p>

<p>The IdP <strong>SHALL</strong> require the subscriber to have an authenticated session before any of the following events:</p>

<ul>
  <li>Approval of attribute release</li>
  <li>Creation and issuance of an assertion</li>
  <li>Establishment of a subscriber-driven trust agreement.</li>
</ul>

<p>Additional requirements for session management and reauthentication are discussed in <a href="/800-63-4/sp800-63c/GenIdP/#federation-session">Sec. 4.7</a>.</p>
<h2 id="authentication-and-attribute-disclosure" data-section="4">
  
  
    Authentication and Attribute Disclosure <a href="#authentication-and-attribute-disclosure" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The decision of whether a federation transaction proceeds <strong>SHALL</strong> be determined by the authorized party stipulated by the trust agreement. The decision can be calculated in a variety of ways, including:</p>

<ul>
  <li>an allowlist, which determines the circumstances under which the system can allow the federation transaction to proceed in an automated fashion;</li>
  <li>a blocklist, which determines the circumstances under which the system will not allow the federation transaction to proceed; and</li>
  <li>a runtime decision, which allows the authorized party to decide if the transaction can proceed and under what precise terms. Note that a runtime decision can be stored and applied to future transactions.</li>
</ul>

<p>The applicability of an allowlist, blocklist, or runtime decision can be influenced by aspects of the federation transaction, including the identity of the IdP and RP, the subscriber attributes requested, the xAL required, and other factors. These decisions can be facilitated by risk management systems, federation authorities, and local system policies.</p>

<p>For a non-normative example of an RP that has been allowlisted at an IdP for a set of subscribers to facilitate single-sign-on for an enterprise application, see <a href="/800-63-4/sp800-63c/examples/#enterprise-sso">Sec. 10.5</a>.</p>

<p>The IdP <strong>SHALL</strong> provide effective mechanisms for redress of subscriber complaints or problems (e.g., subscriber identifies an inaccurate attribute value). See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>
<h3 id="idp-controlled-decisions" data-section="4">
  
  
    IdP-Controlled Decisions <a href="#idp-controlled-decisions" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<h4 id="idp-allowlist" data-section="4">
  
  
    IdP Allowlists of RPs <a href="#idp-allowlist" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>In an a priori trust agreement, IdPs <strong>MAY</strong> establish allowlists of RPs authorized to receive authentication and attributes from the IdP without a runtime decision from the subscriber. When placing an RP on its allowlist, the IdP <strong>SHALL</strong> confirm that the RP abides the terms of the trust agreement. The IdP <strong>SHALL</strong> determine which identity attributes are passed to the allowlisted RP upon authentication. IdPs <strong>SHALL</strong> make allowlists available to subscribers as described in <a href="/800-63-4/sp800-63c/privacy/#notice">Sec. 7.2</a>.</p>

<p>IdP allowlists <strong>SHALL</strong> uniquely identify RPs through the means of domain names, cryptographic keys, or other identifiers applicable to the federation protocol in use. Any entities that share an identifier <strong>SHALL</strong> be considered equivalent for the purposes of the allowlist. Allowlists <strong>SHOULD</strong> be as specific as possible to avoid unintentional impersonation of an RP.</p>

<p>IdP allowlist entries for an RP <strong>SHALL</strong> indicate which attributes are included as part of an allowlisted decision. If additional attributes are requested by the RP, the request <strong>SHALL</strong> be either:</p>

<ul>
  <li>subject to a runtime decision of the authorized party to approve the additional attributes requested,</li>
  <li>redacted to only the attributes in the allowlist entry, or</li>
  <li>denied outright by the IdP.</li>
</ul>

<p>IdP allowlists <strong>MAY</strong> include other information, such as the xALs under which the allowlist entry is applied. For example, an IdP could use an allowlist entry to bypass a consent screen for an FAL1 transaction but require confirmation of consent from the subscriber during an FAL3 transaction.</p>
<h4 id="idp-blocklists-of-rps" data-section="4">
  
  
    IdP Blocklists of RPs <a href="#idp-blocklists-of-rps" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>IdPs <strong>MAY</strong> establish blocklists of RPs not authorized to receive authentication assertions or attributes from the IdP, even if requested to do so by the subscriber. If an RP is on an IdP’s blocklist, the IdP <strong>SHALL NOT</strong> produce an assertion targeting the RP in question under any circumstances.</p>

<p>IdP blocklists <strong>SHALL</strong> uniquely identify RPs through the means of domain names, cryptographic keys, or other identifiers applicable to the federation protocol in use. Any entities that share an identifier <strong>SHALL</strong> be considered equivalent for the purposes of the blocklist. For example, a wildcard domain identifier of “*.example.com” would match the domains “www.example.com”, “service.example.com”, and “unknown.example.com” equally. All three of these sites would blocked by the same blocklist entry.</p>
<h4 id="idp-runtime-decision" data-section="4">
  
  
    IdP Runtime Decisions <a href="#idp-runtime-decision" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>Every RP that is in a trust agreement with an IdP but not on an allowlist with that IdP <strong>SHALL</strong> be governed by a default policy in which runtime authorization decisions will be made by an authorized party identified by the trust agreement. Since the runtime decision occurs during the federation transaction, the authorized party is generally a person and, in most circumstances, is the subscriber; however, it is possible for another party such as an administrator to be prompted on behalf of the subscriber. Note that in a subscriber-driven trust agreement, a runtime decision with the subscriber is the only allowable means to authorize the release of subscriber attributes.</p>

<p>When processing a runtime decision, the IdP prompts the authorized party interactively during the federation transaction. The authorized party provides consent to release an authentication assertion and specific attributes to the RP. The IdP <strong>SHALL</strong> provide the authorized party with explicit notice and prompt them for positive confirmation before any attributes about the subscriber are transmitted to the RP. At a minimum, the notice <strong>SHOULD</strong> be provided by the party in the position to provide the most effective notice and obtain confirmation, consistent with <a href="/800-63-4/sp800-63c/privacy/#notice">Sec. 7.2</a>. The IdP <strong>SHALL</strong> disclose which attributes will be released to the RP if the transaction is approved. If the federation protocol in use allows for optional or selective attribute disclosure at runtime, the authorized party <strong>SHALL</strong> be given the option to decide whether to transmit specific attributes to the RP without terminating the federation transaction entirely.</p>

<p>If the authorized party is the subscriber, the IdP <strong>SHALL</strong> provide mechanisms for the subscriber to view the attribute values and derived attribute values to be sent to the RP. To mitigate the risk of unauthorized exposure of sensitive information (e.g., shoulder surfing), the IdP <strong>SHALL</strong>, by default, mask sensitive information displayed to the subscriber. For more details on masking, see <a href="/800-63-4/sp800-63c/usability/#usability">Sec. 8</a> on usability considerations.</p>

<p>An IdP <strong>MAY</strong> employ mechanisms to remember and re-transmit the same set of attributes to the same RP, remembering the authorized party’s decision. This mechanism is associated with the subscriber account as managed by the IdP. If such a mechanism is provided, the IdP <strong>SHALL</strong> allow the authorized party to revoke such remembered access at a future time.</p>
<h3 id="rp-controlled-decisions" data-section="4">
  
  
    RP-Controlled Decisions <a href="#rp-controlled-decisions" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<h4 id="rp-allowlists-of-idps" data-section="4">
  
  
    RP Allowlists of IdPs <a href="#rp-allowlists-of-idps" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>RPs <strong>MAY</strong> establish allowlists of IdPs from which the RP will accept authentication and attributes without a runtime decision from the subscriber to use the IdP. In practice, many RPs interface with only a single IdP, and this IdP is allowlisted as the only possible entry for that RP. When placing an IdP in its allowlist, the RP <strong>SHALL</strong> confirm that the IdP abides by the terms of the trust agreement. Note that this confirmation can be facilitated by a federation authority or be undertaken directly by the RP.</p>

<p>RP allowlists <strong>SHALL</strong> uniquely identify IdPs through the means of domain names, cryptographic keys, or other identifiers applicable to the federation protocol in use.</p>

<p>RP allowlist entries <strong>MAY</strong> be applied based on aspects of the subscriber account (such as the xALs required for the transaction). For example, an RP could use a runtime decision for FAL1 transactions but require an allowlisted IdP for FAL3 transactions.</p>
<h4 id="rp-blocklists-of-idps" data-section="4">
  
  
    RP Blocklists of IdPs <a href="#rp-blocklists-of-idps" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>RPs <strong>MAY</strong> also establish blocklists of IdPs that the RP will not accept authentication or attributes from, even when requested by the subscriber. A blocklisted IdP can be otherwise in a valid trust agreement with the RP, for example if both are under the same federation authority.</p>

<p>RP blocklists <strong>SHALL</strong> uniquely identify IdPs through the means of domain names, cryptographic keys, or other identifiers applicable to the federation protocol in use.</p>
<h4 id="rp-runtime-decision" data-section="4">
  
  
    RP Runtime Decisions <a href="#rp-runtime-decision" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h4>

<p>Every IdP that is in a trust agreement with an RP but not on an allowlist with that RP <strong>SHALL</strong> be governed by a default policy in which runtime authorization decisions will be made by the authorized party indicated in the trust agreement. In this mode, the authorized party is prompted by the RP to select or enter which IdP to contact for authentication on behalf of the subscriber. This process can be facilitated through the use of a discovery mechanism allowing the subscriber to enter a human-facing identifier such as an email address. This process allows the RP to programmatically select the appropriate IdP for that identifier. Since the runtime decision occurs during the federation transaction, the authorized party is generally a person and, in most circumstances, is the subscriber.</p>

<p>The RP <strong>MAY</strong> employ mechanisms to remember the authorized party’s decision to use a given IdP. Since this mechanism is employed prior to authentication at the RP, the manner in which the RP provides this mechanism (e.g., a browser cookie outside the authenticated session) is separate from the RP subscriber account described in <a href="/800-63-4/sp800-63c/Federation/#rp-account">Sec. 3.10.1</a>. If such a mechanism is provided, the RP <strong>SHALL</strong> allow the authorized party to revoke such remembered options at a future time.</p>
<h3 id="provisioning" data-section="4">
  
  
    Provisioning Models for RP subscriber accounts <a href="#provisioning" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The lifecycle of the provisioning process for an RP subscriber account varies depending on factors including the trust agreement discussed in <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> and the deployment pattern of the IdP and RP. However, in all cases, the RP subscriber account <strong>SHALL</strong> be provisioned at the RP prior to the establishment of an authenticated session at the RP in one of the following ways:</p>

<dl>
  <dt>Just-In-Time Provisioning</dt>
  <dd>An RP subscriber account is created automatically the first time the RP receives an assertion with an unknown federated identifier from an IdP. Any identity attributes learned during the federation process, either within the assertion or through an identity API as discussed in <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>, <strong>MAY</strong> be associated with the RP subscriber account. Accounts provisioned in this way are bound to the federated identifier in the assertion used to provision them.
This is the most common form of provisioning in federation systems, as it requires the least coordination between the RP and IdP. However, in such systems, the RP <strong>SHALL</strong> be responsible for managing any cached attributes it might have. See <a href="/800-63-4/sp800-63c/GenIdP/#fig-7">Fig. 7</a>.</dd>
</dl>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-7" name="fig-7">Fig. 7. Just-In-Time Provisioning</a></p>

<p><img src="/800-63-4/sp800-63c/images/JIT-Provisioning.png" alt="Diagram of the stages of a just-in-time provisioning of an RP subscriber account based on a subscriber account." title="Just-In-Time Provisioning" latex-src="JIT-Provisioning.pdf" latex-fig="7" latex-place="p" /></p>

<dl>
  <dt>Pre-provisioning</dt>
  <dd>An RP subscriber account is created by the IdP pushing the attributes to the RP or the RP pulling attributes from the IdP. Pre-provisioning of accounts generally occurs in bulk through a provisioning API as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning-api">Sec. 4.6.5</a>, as the provisioning occurs prior to the represented subscribers authenticating through a federation transaction. Pre-provisioned accounts <strong>SHALL</strong> be bound to a federated identifier at the time of provisioning. Any time a particular federated identifier is seen by the RP, the associated account can be logged in as a result. 
This form of provisioning requires infrastructure and planning on the part of the IdP and RP, but these processes can be facilitated by automated protocols. Additionally, the IdP and RP must keep the set of provisioned accounts synchronized over time as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#attribute-sync">Sec. 4.6.4</a>. See <a href="/800-63-4/sp800-63c/GenIdP/#fig-8">Fig. 8</a>.

    <p>In this model, the RP also receives attributes about subscribers who have not yet interacted with the RP (and who may never do so). This is in contrast to other models, where the RP receives information only about the subset of subscribers that use the RP, and then only after the subscriber uses the RP for the first time. The privacy considerations of the RP having access to this information prior to a federation transaction <strong>SHALL</strong> be accounted for in the trust agreement.</p>
  </dd>
</dl>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-8" name="fig-8">Fig. 8. Pre-Provisioning</a></p>

<p><img src="/800-63-4/sp800-63c/images/Pre-Provisioning.png" alt="Diagram of the stages of a pre-provisioned RP subscriber account based on a subscriber account." title="Pre-Provisioning" latex-src="Pre-Provisioning.pdf" latex-fig="8" latex-place="p" /></p>

<dl>
  <dt>Ephemeral</dt>
  <dd>An RP subscriber account is created when processing the assertion, but then the RP subscriber account is terminated when the authenticated session ends. This process is similar to a just-in-time provisioning, but the RP keeps no long-term record of the account when the session is complete, in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.
This form of provisioning is useful for RPs that fully externalize access rights to the IdP, allowing the RP to be more simplified with less internal state. However, this pattern is not common because even the simplest RPs tend to have a need to track state within the application or at least keep a record of actions associated with the federated identifier. See <a href="/800-63-4/sp800-63c/GenIdP/#fig-9">Fig. 9</a>.</dd>
</dl>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Federation/#fig-9" name="fig-9">Fig. 9. Ephemeral Provisioning</a></p>

<p><img src="/800-63-4/sp800-63c/images/Ephemeral-Provisioning.png" alt="Diagram of the stages of an ephemeral RP subscriber account based on a subscriber account." title="Ephemeral Provisioning" latex-src="Ephemeral-Provisioning.pdf" latex-fig="9" latex-place="p" /></p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>

<dl>
  <dt>Other</dt>
  <dd>Other RP subscriber account provisioning models are possible but the details of such models are outside the scope of these guidelines. The details of any alternative provisioning model <strong>SHALL</strong> be included in the privacy risk assessments of the IdP and RP.</dd>
</dl>

<p>All organizations <strong>SHALL</strong> document their provisioning models as part of their trust agreement.</p>
<h3 id="attribute-sync" data-section="4">
  
  
    Attribute Synchronization <a href="#attribute-sync" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In a federated process, the IdP and RP each have their own stores of identity attributes associated with the subscriber account. The IdP has a direct view of the subscriber account’s attributes, but the RP subscriber account is derived from a subset of those attributes that are presented during the federation transaction. Therefore, it is possible for the IdP’s and RP’s attribute stores to diverge from each other over time.</p>

<p>From the RP’s perspective, the IdP is the trusted source for any attributes that the IdP asserts as being associated with the subscriber account at the IdP. The provenance of the IdP’s attributes, and their validation process, is stipulated in the trust agreement.</p>

<p>However, the RP <strong>MAY</strong> additionally collect, and optionally verify, other attributes to associate with the RP subscriber account, as discussed in <a href="/800-63-4/sp800-63c/GenIdP/#rp-attribute-collection">Sec. 4.6.6</a>. Sometimes, these attributes can even override what is asserted by the IdP. For example, if an IdP asserts a full display name for the subscriber, the RP can allow the subscriber to provide an alternative preferred name for use at the RP.</p>

<p>The IdP <strong>SHOULD</strong> signal downstream RPs when the attributes of a subscriber account available to the RP have been updated, and the RP <strong>MAY</strong> respond to this signal by updating the attributes in the RP subscriber account. This synchronization can be accomplished using shared signaling as described in <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec. 4.8</a>, through a provisioning API as described in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning-api">Sec. 4.6.5</a>, or by providing a signal in the assertion (e.g., a timestamp indicating when relevant attributes were last updated) allowing the RP to determine that its cache is out of date. If the RP is granted access to an identity API as in <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>, the IdP <strong>SHOULD</strong> allow the RP access to the API for sufficient time to perform synchronization operations after the federation transaction has concluded. For example, if the assertion is valid for five minutes, access to the identity API could be valid for 30 minutes to allow the RP to fetch and update attributes out of band.</p>

<p>The IdP <strong>SHOULD</strong> signal downstream RPs when a subscriber account is terminated, or when the subscriber account’s access to an RP is revoked. This can be accomplished using shared signaling as described in <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec. 4.8</a> or through a provisioning API as described in <a href="/800-63-4/sp800-63c/GenIdP/#provisioning-api">Sec. 4.6.5</a>. Upon receiving such a signal, the RP <strong>SHALL</strong> process the RP subscriber account as stipulated in the trust agreement. If the RP subscriber account is terminated, the RP <strong>SHALL</strong> remove all personal information associated with the RP subscriber account, in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>. If the reason for termination is suspicious or fraudulent activity, the IdP <strong>SHALL</strong> include this reason in its signal to the RP to allow the RP to review the account’s activity at the RP for suspicious activity, if specified in the trust agreement with that RP.</p>
<h3 id="provisioning-api" data-section="4">
  
  
    Provisioning APIs <a href="#provisioning-api" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>As part of some proactive forms of provisioning, the RP can be given access to subscriber attributes through a general-purpose identity API known as a <em>provisioning API</em>. This type of API allows an IdP to push attributes for a range of subscriber accounts, and sometimes allows an RP to query the attributes of these subscriber accounts directly. Since access to the API is granted outside the context of a federation transaction, access to the provisioning API for a given subscriber does not indicate to the RP that a given subscriber has been authenticated.</p>

<p>The attributes in the provisioning API available to a given RP <strong>SHALL</strong> be limited to only those necessary for the RP to perform its functions, including any audit and security purposes as discussed in <a href="/800-63-4/sp800-63c/Federation/#transmit-subscriber-info">Sec. 3.9.1</a>. As part of establishing the trust agreement, the IdP <strong>SHALL</strong> document when an RP is given access to a provisioning API including at least the following:</p>

<ul>
  <li>the purpose for the access using the provisioning model;</li>
  <li>the set of attributes made available to the RP;</li>
  <li>whether the API functions as a push to the RP, a pull from the RP, or both; and</li>
  <li>the population of subscribers whose attributes are made available to the RP.</li>
</ul>

<p>Access to the provisioning API <strong>SHALL</strong> occur over a mutually authenticated protected channel. The exact means of authentication varies depending on the specifics of the API and whether it is a push model (where the IdP connects to the RP) or a pull model (where the RP connects to the IdP).</p>

<p>A provisioning API <strong>SHALL NOT</strong> be made available under a subscriber-driven trust agreement. The IdP <strong>SHALL NOT</strong> make a provisioning API available to any RP outside of an established trust agreement. The IdP <strong>SHALL</strong> provide access to a provisioning API only as part of a federated identity relationship with an RP to facilitate federation transactions with that RP and related functions such as signaling revocation of the subscriber account. The IdP <strong>SHALL</strong> revoke an RP’s access to the provisioning API once access is no longer required by the RP for its functioning purposes or when the trust agreement is terminated.</p>

<p>Any provisioning API provided to the RP <strong>SHALL</strong> be under the control and jurisdiction of the IdP. External attribute providers <strong>MAY</strong> be used as information sources by the IdP to provide attributes through this provisioning API, but the IdP is responsible for the content and accuracy of the information provided by the referenced attribute providers.</p>

<p>When a provisioning API is in use, the IdP <strong>SHALL</strong> signal to the RP when a subscriber account has been terminated. When receiving such a signal, the RP <strong>SHALL</strong> remove the binding of the federated identifier from the account and <strong>SHALL</strong> terminate the account if necessary (e.g., there are no other federated identifiers linked to this account or the trust agreement dictates such an action). The RP <strong>SHALL</strong> remove all personal information sourced from the provisioning API in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.</p>
<h3 id="rp-attribute-collection" data-section="4">
  
  
    Collection of Additional Attributes by the RP <a href="#rp-attribute-collection" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The RP <strong>MAY</strong> collect and maintain additional attributes from the subscriber beyond those provided by the IdP. For example, the RP could collect a preferred display name directly from the subscriber that is not provided by the IdP. The RP could also have a separate agreement with an attribute provider that gives the RP access to an identity API not associated with the IdP. For example, the RP could receive a state license number from the IdP, but use a separate attribute verification API to check if a particular license number is currently valid. The assertion from the IdP binds the license to the subscriber, but the attribute verification API provides additional information beyond what the IdP can share or be authoritative for.</p>

<p>These attributes are governed separately from the trust agreement since they are collected by the RP outside of a federation transaction. All attributes associated with an RP subscriber account, regardless of their source, <strong>SHALL</strong> be removed when the RP subscriber account is terminated, in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.</p>

<p>The RP <strong>SHALL</strong> disclose to the subscriber the purpose for collection of any additional attributes. These attributes <strong>SHALL</strong> be used solely for the stated purposes of the RP’s functionality and <strong>SHALL NOT</strong> have any secondary use, including communication of said attributes to other parties.</p>

<p>The RP <strong>SHALL</strong> provide an effective means of redress for the subscriber to update and remove these additionally-collected attributes from the RP subscriber account. See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>

<p>The following requirement applies to federal agencies, regardless of whether they operate their own identity service or use an external CSP as part of their identity service:</p>

<ul>
  <li>An RP <strong>SHALL</strong> disclose any additional attributes collected, and their use, as part of its System of Records Notice (SORN)</li>
</ul>
<h3 id="stale-account" data-section="4">
  
  
    Time-based Removal of RP Subscriber Accounts <a href="#stale-account" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>If an RP is using a just-in-time provisioning mechanism, the RP only learns of the existence of a subscriber account when that account is first used at the RP. If the IdP does not inform the RP of terminated subscriber accounts using shared signaling as described in <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec 4.8</a>, an RP could accumulate RP subscriber accounts that are no longer accessible from the IdP. This poses a risk to the RP for holding personal information in the RP subscriber accounts. In such circumstances, the RP <strong>MAY</strong> employ a time-based mechanism to identify RP subscriber accounts for termination that have not been accessed after a period of time tailored to the usage patterns of the application. For example, an RP that is usually accessed on a weekly basis could set a timeout of 120 days since last access at the RP to mark the RP subscriber account for termination. An RP that expects longer gaps between access, such as a service used annually, should have a much longer time frame, such as five years.</p>

<p>When processing such an inactive account, the RP <strong>SHALL</strong> provide sufficient notice to the subscriber, about the pending termination of the account and provide the subscriber with an option to re-activate the account prior to its scheduled termination. Upon termination, the RP <strong>SHALL</strong> remove all personal information associated with the RP subscriber account, in accordance with <a href="/800-63-4/sp800-63c/Federation/#store-subscriber-info">Sec. 3.10.3</a>.</p>
<h2 id="federation-session" data-section="4">
  
  
    Reauthentication and Session Requirements in Federated Environments <a href="#federation-session" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>In a federated environment, the RP manages its sessions separately from any sessions at the IdP. The assertion is related to both sessions but its validity period is ultimately independent of them.</p>

<p>As shown in <a href="/800-63-4/sp800-63c/GenIdP/#fig-10">Fig. 10</a>, an assertion is created during an authenticated session at the IdP, and processing an assertion creates an authenticated session at the RP. The validity time window of an assertion is used to manage the RP’s processing of the assertion but does not indicate the lifetime of the authenticated session at the IdP or the RP. If a request comes to the IdP for a new federation transaction while the subscriber’s session is still valid at the IdP, a new and separate assertion would be created with its own validity time window. Similarly, after the RP consumes the assertion, the validity of the RP’s session is independent of the validity of the assertion, and in most cases the authenticated session at the RP will far outlive the validity of the assertion. Access granted to an identity API is likewise independent of the validity of the assertion or the lifetime of the authenticated session at the RP.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/GenIdP/#fig-session" name="fig-10">Fig. 10. Session Lifetimes</a></p>

<p><img src="/800-63-4/sp800-63c/images/Session.png" alt="Diagram of the relationship between session lifetimes at the IdP and RP and assertion validity window." title="Session Lifetimes" latex-src="Session.pdf" latex-fig="10" latex-place="h" /></p>

<p>The IdP ending the subscriber’s session at the IdP will not necessarily cause any sessions that subscriber might have at downstream RPs to end as well. The RP and IdP <strong>MAY</strong> communicate end-session events to each other, if supported by the federation protocol or through shared signaling (see <a href="/800-63-4/sp800-63c/GenIdP/#shared-signals">Sec. 4.8</a>).</p>

<p>At the time of a federated transaction request, the subscriber could have a pre-existing authenticated session at the IdP which <strong>MAY</strong> be used to generate an assertion to the RP. The IdP <strong>SHALL</strong> communicate to the RP any information the IdP has regarding the time of the subscriber’s latest authentication event at the IdP, and the RP <strong>MAY</strong> use this information in making authorization and access decisions. Depending on the capabilities of the federation protocol in use, the IdP <strong>SHOULD</strong> allow the RP to request that the subscriber provide a fresh authentication at the IdP instead of using the existing session at the IdP. For example, suppose the subscriber authenticates at the IdP for one transaction. Then, 30 min later, the subscriber starts a federation transaction at the RP. Depending on xAL requirements, the subscriber’s existing session at the IdP can be used to avoid prompting the subscriber for their authenticators. The resulting assertion to the RP will indicate that the last time the subscriber had authenticated to the RP was 30 min in the past. The RP can then use this information to determine whether this is reasonable for the RP’s needs, and, if possible within the federation protocol, request the IdP to prompt the subscriber for a fresh authentication event instead.</p>

<p>An RP requiring authentication through a federation protocol <strong>SHALL</strong> specify the maximum acceptable authentication age to the IdP, either through the federation protocol (if possible) or through the terms of the trust agreement. The authentication age represents the time since the last authentication event in the subscriber’s session at the IdP, and the IdP <strong>SHALL</strong> reauthenticate the subscriber if they have not been authenticated within that time period. The IdP <strong>SHALL</strong> communicate the authentication event time to the RP to allow the RP to decide if the assertion is sufficient for authentication at the RP and to determine the time for the next reauthentication event.</p>

<p>If an RP is granted access to an identity API at the same time the RP receives an assertion, the lifetime of the access to the identity API is independent from the lifetime of the assertion. As a consequence, the RP’s ability to successfully fetch additional attributes through an identity API <strong>SHALL NOT</strong> be used to establish a session at the RP. Likewise, inability to access an identity API <strong>SHOULD NOT</strong> be used to end the session at the RP.</p>

<p>When the RP is granted access to the identity API, the RP is often also granted access to other APIs at the same time, such as granting access to a subscriber’s calendar and data storage while also logging in. It is common for this access to be valid long after the assertion has expired and possibly after the session with the RP has ended, allowing the RP to access these non-identity APIs on the subscriber’s behalf while the subscriber is no longer present at the RP. Providing access to non-identity APIs is outside the scope of these guidelines.</p>

<p>The RP <strong>MAY</strong> terminate its authenticated session with the subscriber or restrict access to the RP’s functions if the assertion, authentication event, or attributes do not meet the RP’s requirements. For example, if an RP is configured to allow access to certain high-risk functionality only if the federation transaction was at FAL3, but the incoming assertion only meets the requirements for FAL2, the RP could decide to deny access to the high-risk functionality while allowing access to lower-risk functionality, or the RP could choose to terminate the session entirely.</p>

<p>See <a href="/800-63-4/sp800-63b/session/#sec7" latex-href="#ref-SP800-63B">[SP800-63B] Sec. 5</a> for more information about session management requirements that apply to both IdPs and RPs.</p>
<h2 id="shared-signals" data-section="4">
  
  
    Shared Signaling <a href="#shared-signals" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>In some environments, it is useful for the IdP and RP to send information to each other outside of the federation transaction. These signals can communicate important changes in state between parties that would not be otherwise known. The use of any shared signaling <strong>SHALL</strong> be documented in the trust agreement between the IdP and RP. Signaling from the IdP to the RP <strong>SHALL</strong> require an apriori trust agreement. Signaling from the RP to the IdP <strong>MAY</strong> be used in both apriori and subscriber-driven trust agreements.</p>

<p>Any use of shared signaling <strong>SHALL</strong> be documented and made available to the authorized party stipulated by the trust agreement. This documentation <strong>SHALL</strong> include the events under which a signal is sent, the information included in such a signal (including any attribute information), and any additional parameters sent with the signal. The use of shared signaling <strong>SHALL</strong> be subject to privacy review under the trust agreement.</p>

<p>The IdP <strong>SHOULD</strong> send a signal regarding the following changes to the subscriber account:</p>

<ul>
  <li>The account has been terminated.</li>
  <li>The account is suspected of being compromised.</li>
  <li>Attributes of the account, including identifiers other than the federated identifier (such as email address or certificate common name), have changed.</li>
  <li>The possible range of IAL, AAL, or FAL for the account has changed.</li>
</ul>

<p>If the RP receives a signal that an RP subscriber account is suspected of compromise, the RP <strong>SHOULD</strong> review actions taken by that account at the RP for suspicious activity.</p>

<p>The RP <strong>SHOULD</strong> send a signal regarding the following changes to the RP subscriber account:</p>

<ul>
  <li>The account has been terminated.</li>
  <li>The account is suspected of being compromised.</li>
  <li>A bound authenticator is added by the RP.</li>
  <li>A bound authenticator is removed by the RP.</li>
</ul>

<p>If the IdP receives a signal that a subscriber account is suspected of compromise, the IdP <strong>SHALL</strong> review actions taken by that account at the IdP for suspicious activity. If suspicious activity is confirmed at the IdP, the IdP <strong>SHALL</strong> signal any additional RPs the subscriber account was used for during the suspected time frame.</p>

<p>Additional signals from both the IdP and RP <strong>MAY</strong> be allowed subject to privacy and security review as part of the trust agreement.</p>
<h2 id="assertions" data-section="4">
  
  
    Assertion Contents <a href="#assertions" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>An assertion is a packaged set of attribute values or derived attribute values about or associated with an authenticated subscriber that is passed from the IdP to the RP in a federated identity system. Assertions contain a variety of information, including: assertion metadata, attribute values and derived attribute values about the subscriber, information about the subscriber’s authentication at the IdP, and other information that the RP can leverage (e.g., restrictions and validity time window). While the assertion’s primary function is to authenticate the user to an RP, the information conveyed in the assertion can be used by the RP for a number of use cases — for example, authorization or personalization of a website. These guidelines do not restrict RP use cases nor the type of protocol or data payload used to federate an identity, provided that the chosen solution meets all mandatory requirements contained herein.</p>

<p>Assertions <strong>SHALL</strong> represent a discrete authentication event of the subscriber at the IdP and <strong>SHALL</strong> be processed as a discrete authentication event at the RP.</p>

<p>All assertions <strong>SHALL</strong> include the following attributes:</p>

<ol>
  <li>Subject identifier: An identifier for the party to which the assertion applies (i.e., the subscriber).</li>
  <li>Issuer identifier: An identifier for the issuer of the assertion (i.e., the IdP).</li>
  <li>Audience identifier: An identifier for the party intended to consume the assertion (i.e., the RP). An assertion can contain more than one audience identifier at FAL1.</li>
  <li>Issuance time: A timestamp indicating when the IdP issued the assertion.</li>
  <li>Validity time window: A period of time outside of which the assertion <strong>SHALL NOT</strong> be accepted as valid by the RP for the purposes of authenticating the subscriber and starting an authenticated session at the RP. This is usually communicated by means of an expiration timestamp for the assertion in addition to the issuance timestamp.</li>
  <li>Assertion identifier: A value uniquely identifying this assertion, used to prevent attackers from replaying prior assertions.</li>
  <li>Authentication time: A timestamp indicating when the IdP last verified the presence of the subscriber at the IdP through a primary authentication event.</li>
  <li>Nonce: A cryptographic nonce, if one is provided by the RP.</li>
  <li>Signature: Digital signature or message authentication code (MAC), including key identifier, covering the entire assertion.</li>
</ol>

<p>All assertions <strong>SHALL</strong> contain sufficient information to determine the following aspects of the federation transaction:</p>

<ol>
  <li>The IAL of the subscriber account being represented in the assertion, or an indication that no IAL is asserted.</li>
  <li>The AAL used when the subscriber authenticated to the IdP, or an indication that no AAL is asserted.</li>
  <li>The IdP’s intended FAL of the federation process represented by the assertion.</li>
</ol>

<p>At FAL3, the assertion <strong>SHALL</strong> include one of the following:</p>

<ul>
  <li>The public key, key identifier, or other identifier for a holder-of-key assertion, or</li>
  <li>An indicator that verification of a bound authenticator is required to process this assertion.</li>
</ul>

<p>Assertions <strong>MAY</strong> also include additional items, including the following information:</p>

<ol>
  <li>Attribute values and derived attribute values: Information about the subscriber.</li>
  <li>Attribute bundles: Collections of attributes in a signed bundle from the CSP.</li>
  <li>Attribute metadata: Additional information about one or more subscriber attributes, such as those described in <a href="/800-63-4/sp800-63c/references/#ref-nistir8112">[NISTIR8112]</a>.</li>
  <li>Authentication event: Additional details about the authentication event, such as the class of authenticator used.</li>
</ol>

<p>The RP <strong>SHALL</strong> validate the assertion by checking that all the following are true:</p>

<ul>
  <li><em>Signature validation</em>: ensuring that the signature of the assertion is valid and corresponds to a key belonging to the IdP sending the assertion.</li>
  <li><em>Issuer verification</em>: ensuring that the assertion was issued by the IdP the RP expects it to be from.</li>
  <li><em>Time validation</em>: ensuring that the expiration and issue times are within acceptable limits of the current timestamp.</li>
  <li><em>Audience restriction</em>: ensuring that this RP is the intended recipient of the assertion.</li>
  <li><em>Nonce</em>: ensuring that the cryptographic nonce included in the RP’s request (if applicable) is included in the presentation.</li>
  <li><em>Transaction terms</em>: ensuring that the IAL, AAL, and FAL represented by the assertion are allowable under the applicable trust agreement.</li>
</ul>

<p>An RP <strong>SHALL</strong> treat subject identifiers as not inherently globally unique. Instead, the value of the assertion’s subject identifier is usually in a namespace under the assertion issuer’s control, as discussed in <a href="/800-63-4/sp800-63c/Federation/#federated-identifier">Sec. 3.3</a>. This allows an RP to talk to multiple IdPs without incorrectly conflating subjects from different IdPs.</p>

<p>Assertions <strong>MAY</strong> include additional attributes about the subscriber. <a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Section 3.9</a> contains privacy requirements for presenting attributes in assertions. The RP <strong>MAY</strong> be given limited access to an identity API as discussed in <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>, either in the same response as the assertion is received or through some other mechanism. The RP can use this API to fetch additional identity attributes for the subscriber that are not included in the assertion itself.</p>

<p>The assertion’s validity time window is the time between its issuance and its expiration. This window needs to be large enough to allow the RP to process the assertion and create a local application session for the subscriber, but should not be longer than necessary for such establishment. Long-lived assertions have a greater risk of being stolen or replayed; a short assertion validity time window mitigates this risk. Assertion validity time windows <strong>SHALL NOT</strong> be used to limit the session at the RP. See <a href="/800-63-4/sp800-63c/GenIdP/#federation-session">Sec. 4.7</a> for more information.</p>
<h2 id="assertion-requests" data-section="4">
  
  
    Assertion Requests <a href="#assertion-requests" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>When the federation transaction is initiated by the RP, the RP’s request for an assertion <strong>SHALL</strong> contain:</p>

<ol>
  <li>An identifier for the RP</li>
  <li>A cryptographic nonce, to be returned in the assertion</li>
</ol>

<p>The RP’s request <strong>SHOULD</strong> additionally contain:</p>

<ol>
  <li>The set of identity attributes requested by the RP and their purpose of use at the RP; this is a subset of what is allowed by the trust agreement</li>
  <li>The requirements for the authentication event at the IdP</li>
</ol>

<p>Note that federation transactions are always initiated by the RP at FAL2 or higher.</p>
<h2 id="presentation" data-section="4">
  
  
    Assertion Presentation <a href="#presentation" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Depending on the specifics of the protocol, the RP and the IdP communicate with each other in two ways, which lends to two different ways in which an assertion can be passed from the IdP to the RP:</p>

<ul>
  <li>The <em>back channel</em>, through a direct connection between the RP and IdP, not involving the subscriber directly; or</li>
  <li>The <em>front channel</em>, through a third party using redirects involving the subscriber and the subscriber’s browser.</li>
</ul>

<p>There are tradeoffs with each model, but each requires the proper validation of the assertion. Assertions <strong>MAY</strong> also be proxied to facilitate federation between IdPs and RPs using different presentation methods, as discussed in detail in <a href="/800-63-4/sp800-63c/Federation/#proxied">Sec. 3.2.3</a>.</p>
<h3 id="back-channel" data-section="4">
  
  
    Back-Channel Presentation <a href="#back-channel" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In the <em>back-channel</em> presentation model shown in <a href="/800-63-4/sp800-63c/GenIdP/#fig-11">Fig. 11</a>, the subscriber is given an assertion reference to present to the RP, generally through the front channel. The assertion reference itself contains no information about the subscriber and <strong>SHALL</strong> be resistant to tampering and fabrication by an attacker. The RP presents the assertion reference to the IdP to fetch the assertion. How this is achieved varies form one protocol to the next. In the authorization code flow and some forms of the hybrid flow of <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> the assertion (the ID Token) is presented in the back channel in exchange for the assertion reference (the authorization code). In the artifact binding profile of <a href="/800-63-4/sp800-63c/references/#ref-SAML-bindings">[SAML-Bindings]</a>, the SAML assertion is presented in the back channel.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/GenIdP/#fig-63cSec7-Figure1" name="fig-11">Fig. 11. Back-channel Presentation</a></p>

<p><img src="/800-63-4/sp800-63c/images/back-channel.png" alt="Diagram of the back-channel presentation model for communicating assertions to the RP." title="Back-channel Presentation" latex-src="back-channel.pdf" latex-fig="11" latex-place="h" /></p>

<p>As shown in <a href="/800-63-4/sp800-63c/GenIdP/#fig-11">Fig. 11</a>, the back-channel presentation model consists of three steps:</p>

<ol>
  <li>The IdP sends an assertion reference to the subscriber through the front channel.</li>
  <li>The subscriber sends the assertion reference to the RP through the front channel.</li>
  <li>The RP presents the assertion reference and its RP credentials to the IdP through the back channel. The IdP validates the credentials and returns the assertion.</li>
</ol>

<p>The assertion reference:</p>

<ol>
  <li><strong>SHALL</strong> be limited to use by a single RP.</li>
  <li><strong>SHALL</strong> be single-use.</li>
  <li><strong>SHALL</strong> be time limited, and <strong>SHOULD</strong> have a validity time window of no more than five minutes.</li>
  <li><strong>SHALL</strong> be presented along with authentication of the RP to the IdP.</li>
  <li><strong>SHALL NOT</strong> be predictable or guessable by an attacker.</li>
</ol>

<p>In this model, the RP directly requests the assertion from the IdP, minimizing chances of interception and manipulation by a third party (including the subscriber themselves).
More network transactions are required in the back-channel method, but the information is limited to only those parties that need it. Since an RP is expecting to get an assertion only from the IdP directly as a result of its request, the attack surface is reduced. Consequently, it is more difficult to inject assertions directly into the RP and this presentation method is recommended for FAL2 and above.
Since the IdP and RP are already directly connected, the back-channel presentation method facilitates the use of identity APIs, as described in <a href="/800-63-4/sp800-63c/Federation/#s-identity-api">Sec. 3.11.3</a>.</p>

<p>Note that while it is technically possible for an assertion reference (which is single-audience) to result in a multi-audience assertion, this situation is unlikely. For this reason, back-channel presentation is practically limited to use with single-audience assertions.</p>

<p>Conveyance of the assertion reference from the IdP to the subscriber, as well as from the subscriber to the RP, <strong>SHALL</strong> be made over an authenticated protected channel. Conveyance of the assertion reference from the RP to the IdP, as well as the assertion from the IdP to the RP, <strong>SHALL</strong> be made over an authenticated protected channel.</p>

<p>The RP <strong>SHALL</strong> protect itself against injection of manufactured or captured assertion references by the use of cross-site scripting protection, rejecting assertion references outside of the correct stage of a federation transaction, or other accepted techniques discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>.
When assertion references are presented to the IdP, the IdP <strong>SHALL</strong> verify that the RP presenting the assertion reference is the same RP that made the assertion request resulting in the assertion reference. Examples for this are discussed in <a href="/800-63-4/sp800-63c/examples/#rp-auth">Sec 10.12</a> such as the authorization code flow of <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> with additional security profiles such as <a href="/800-63-4/sp800-63c/references/#ref-FAPI">[FAPI]</a>.</p>

<p>Note that in a federation proxy described in <a href="/800-63-4/sp800-63c/Federation/#proxied">Sec. 3.2.3</a>, the upstream IdP audience restricts the assertion reference and assertion to the proxy, and the proxy restricts any newly-created assertion references or assertions to the downstream RP.</p>
<h3 id="front-channel" data-section="4">
  
  
    Front-Channel Presentation <a href="#front-channel" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>In the <em>front-channel</em> presentation model shown in <a href="/800-63-4/sp800-63c/GenIdP/#fig-12">Fig. 12</a>, the IdP creates an assertion and sends it to the RP by means of a third party, such as the subscriber’s user agent. In the implicit flow and some forms of the hybrid flow of <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a>, the assertion (the ID Token) is presented in the front channel.  In the SAML Web SSO profile defined in <a href="/800-63-4/sp800-63c/references/#ref-SAML-WebSSO">[SAML-WebSSO]</a>, the SAML assertion is presented in the front channel.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/GenIdP/#fig-13" name="fig-12">Fig. 12. Front-channel Presentation</a></p>

<p><img src="/800-63-4/sp800-63c/images/front-channel.png" alt="Diagram of the front-channel presentation model for communicating assertions to the RP." title="Front-channel Presentation" latex-src="front-channel.pdf" latex-fig="12" latex-place="h" /></p>

<p>Front-channel presentation methods expose the assertion to parties other than the IdP and RP, which increases the risk for leakage of PII and other information included in the assertion. Additionally, there is an increased attack surface for the assertion to be captured and replayed by an attacker. As a consequence, it is recommended to not use front-channel presentation when other mechanisms are available.</p>

<p>The RP <strong>SHALL</strong> use the assertion identifier ensure that a given assertion is presented at most once during the assertion’s validity time window.</p>

<p>The RP <strong>SHALL</strong> protect itself against injection of manufactured or captured assertion by the use of cross-site scripting protection, rejecting assertions outside of the correct stage of a federation transaction, or other accepted techniques discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>.</p>

<p>Conveyance of the assertion from the IdP to the subscriber, as well as from the subscriber to the RP, <strong>SHALL</strong> be made over an authenticated protected channel.</p>

<p>With general-purpose IdPs, it is common for front-channel communications to be accomplished using HTTP redirects, where the contents of the assertion are made available as part of an HTTP request URL. Due to the nature of the HTTP ecosystem, these request URLs are sometimes available in unexpected places, such as access logs and browser history. These logs and other artifacts tend to live on long past the federation transaction and are available in other contexts, which increases the attack surface for reading the assertion. As a consequence, an IdP that uses HTTP redirects for front channel presentation of assertions that contain PII <strong>SHALL</strong> encrypt the assertion as discussed in <a href="/800-63-4/sp800-63c/Federation/#encrypted-assertion">Sec 3.12.3</a>.</p>

<h1 id="wallet" data-section="5">
  
  
    Subscriber-Controlled Wallets <a href="#wallet" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is normative.</em></p>

<p>When the IdP runs on a device controlled by the subscriber, whether as a digital wallet or as a self-issued identity provider, the IdP is known as a <em>subscriber-controlled wallet</em> and the following requirements apply.</p>

<p>Subscriber-controlled wallets <strong>SHALL</strong> require the presentation of an activation factor in order to perform any actions requiring the use of the wallet’s signing key, including onboarding of the wallet and release of attributes to an RP.</p>
<h2 id="wallet-activation" data-section="5">
  
  
    Wallet Activation <a href="#wallet-activation" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The subscriber-controlled wallet <strong>SHALL</strong> require presentation of an activation factor from the subscriber for the following actions:</p>

<ul>
  <li>Providing proof of the signing key to the CSP during the provisioning process</li>
  <li>Signing the assertion for presentation to the RP</li>
</ul>

<p>The subscriber-controlled wallet <strong>SHOULD</strong> require presentation of an activation factor before any other operations that involve use of the wallet’s signing keys. The wallet <strong>MAY</strong> request reissuance of previously-issued attribute bundles without requiring subscriber involvement.</p>

<p>Submission of the activation factor <strong>SHALL</strong> be a separate operation from the unlocking of the host device (e.g., smartphone), although the same activation factor used to unlock the host device <strong>MAY</strong> be used in the activation operation. Agencies <strong>MAY</strong> relax this requirement for subscriber-controlled wallets managed by or on behalf of the CSP (e.g., via mobile device management) that are constrained to have short (agency-determined) inactivity timeouts and device activation factors meeting the above requirements. Additional discussion of activation factors for authenticators is found in <a href="/800-63-4/sp800-63b/authenticators/#s-5-2-10" latex-href="#ref-SP800-63B">Sec. 3.2.10 of [SP800-63B]</a>.</p>
<h2 id="federation-transaction" data-section="5">
  
  
    Federation Transaction <a href="#federation-transaction" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A federation transaction with a subscriber-controlled wallet establishes the subscriber’s device as an IdP for the subscriber account and creates an authenticated session for the subscriber at the RP. The process is shown in <a href="/800-63-4/sp800-63c/Wallets/#fig-13">Fig. 13</a>.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/Wallets/#fig-1" name="fig-13">Fig. 13. Federation with a Subscriber-Controlled Wallet</a></p>

<p><img src="/800-63-4/sp800-63c/images/subscriberidp.png" alt="Overview diagram of federated authentication process using a subscriber-controlled wallet." title="Subscriber-Controlled Wallet" latex-src="subscriberidp.pdf" latex-fig="13" latex-place="p" /></p>

<p>A federation transaction with a subscriber-controlled wallet takes place over several steps:</p>

<ol>
  <li>The CSP identity proofs the subscriber and creates a subscriber account.</li>
  <li>The CSP provisions the wallet to the subscriber account, which includes the subscriber verifying an authenticator in their subscriber account.</li>
  <li>The wallet receives a signed attribute bundle from the CSP, allowing the wallet to act as an IdP.</li>
  <li>The RP requests a federated authentication from the wallet, usually through subscriber action.</li>
  <li>The subscriber activates the wallet through an authentication factor.</li>
  <li>The wallet creates an assertion based on the attribute bundles available to the wallet.</li>
  <li>The wallet presents the assertion to the RP.</li>
  <li>The RP validates the assertion.</li>
  <li>The RP creates an authenticated session for the subscriber.</li>
</ol>
<h2 id="trust-agreements" data-section="5">
  
  
    Trust Agreements <a href="#trust-agreements" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The trust agreement for a transaction involving a subscriber-controlled wallet <strong>SHALL</strong> be established between the RP and the CSP. The trust agreement <strong>MAY</strong> be facilitated through use of a federation authority, as described in <a href="/800-63-4/sp800-63c/Federation/#authorities">Sec. 3.4.2</a>.</p>

<p>In most cases, the RP does not have a direct trust relationship with the wallet (acting as IdP), but instead trusts the wallet transitively through the wallet’s established relationship with the CSP. This relationship can be verified by the means of attribute bundles, as described in <a href="/800-63-4/sp800-63c/Federation/#attribute-bundles">Sec. 3.11.1</a>. Even though the wallet is not usually involved in the process of establishing the trust agreement, the trust agreement between the RP and CSP can still be accomplished in either an a priori or subscriber-driven fashion.</p>

<p>The trust agreement <strong>SHALL</strong> include the following</p>

<ul>
  <li>The set of subscriber attributes the CSP makes available to wallets in attribute bundles</li>
  <li>The set of subscriber attributes the wallet can make available to the RP</li>
  <li>The population of subscriber accounts that the CSP can represent</li>
  <li>The xALs available from the wallet</li>
</ul>

<p>The release of subscriber attributes <strong>SHALL</strong> be managed using a runtime decision managed by the wallet, as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-runtime-decision">Sec. 4.6.1.3</a>. The authorized party <strong>SHALL</strong> be the subscriber.</p>

<p>The following terms <strong>SHALL</strong> be disclosed to the subscriber during the runtime decision:</p>

<ul>
  <li>The set of subscriber attributes that the RP will request (a subset of the attributes made available)</li>
  <li>The purpose for each attribute requested by the RP</li>
  <li>The xALs required by the RP</li>
</ul>

<p>Note that all information disclosed to the subscriber needs to be conveyed in a manner that is understandable and actionable, as discussed in <a href="/800-63-4/sp800-63c/usability/#usability">Sec. 8</a>.</p>

<p>If FAL3 is allowed within the trust agreement and authenticators other than the wallet itself are allowed for use at FAL3, the trust agreement <strong>SHALL</strong> stipulate the following terms regarding holder-of-key assertions and bound authenticators (see <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec. 3.14</a> and <a href="/800-63-4/sp800-63c/Federation/#bound-authn">Sec. 3.15</a>):</p>

<ul>
  <li>Whether the wallet’s presentation is considered sufficient for holder-of-key assertion requirements</li>
  <li>The means by which non-wallet holder-of-key assertions can be verified by the RP (such as a common trusted PKI system)</li>
  <li>The means by which the RP can associate non-wallet holder-of-key assertions with specific RP subscriber accounts (such as attribute-based account resolution or pre-provisioning)</li>
  <li>Whether bound authenticators are supplied by the RP or by the subscriber</li>
  <li>Documentation of the binding ceremony used for any subscriber-provided bound authenticators</li>
</ul>
<h2 id="scidp-provisioning" data-section="5">
  
  
    Provisioning the Subscriber-Controlled Wallet <a href="#scidp-provisioning" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>When the CSP provisions the subscriber-controlled wallet, the process <strong>SHALL</strong> include the following steps:</p>

<ol>
  <li>The subscriber authenticates to the CSP’s provisioning system using one or more authenticators bound to the subscriber account.</li>
  <li>The subscriber activates the wallet using an activation factor.</li>
  <li>The wallet proves possession of its signing key to the CSP.</li>
  <li>The CSP creates one or more attribute bundles that include subscriber attributes and the wallet’s signing key (or a reference to that key).</li>
  <li>The wallet stores the attribute bundle for later presentation to RPs.</li>
</ol>

<p>The subscriber-controlled wallet <strong>MAY</strong> generate and use a different signing key for each provisioning request with the CSP.</p>

<p>The CSP <strong>SHALL</strong> create a unique attribute bundle for each requesting wallet.</p>
<h3 id="deprovisioning-the-subscriber-controlled-wallet" data-section="5">
  
  
    Deprovisioning the Subscriber-Controlled Wallet <a href="#deprovisioning-the-subscriber-controlled-wallet" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>The CSP <strong>SHALL</strong> provide a means of deprovisioning a subscriber-controlled wallet. The deprovisioning process is used when the subscriber account is terminated, thereby rendering downstream federation actions invalid, or when the wallet needs to be terminated due to the device being lost, stolen, or compromised.</p>

<p>To accomplish this, the CSP <strong>SHALL</strong> issue attribute bundles with a limited time validity window, <strong>SHALL</strong> issue attribute bundles specific to each wallet. The CSP <strong>SHOULD</strong> provide a means to independently verify the status of attribute bundles (i.e., whether a specific bundle has been revoked by the CSP). If such a service is offered, the service <strong>SHALL</strong> be deployed in a privacy-preserving way such that the CSP is not alerted to the use of a specific attribute bundle at a specific RP.</p>
<h2 id="discovery-and-registration" data-section="5">
  
  
    Discovery and Registration <a href="#discovery-and-registration" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>To perform a federation transaction with a subscriber-controlled wallet, the RP <strong>SHALL</strong> first determine the attribute bundle singing public key of the CSP through a secure process as stated by the trust agreement. In some systems, this is accomplished by retrieving the CSP’s attribute bundle signing public keys from a URL known to be controlled by the CSP. In other systems, the RP is configured manually with the public key of the CSP before being deployed.</p>

<p>The RP learns the identifier and assertion signing public keys of the subscriber-controlled wallet as part of the attribute bundle signed by the CSP, presented in the federation transaction. The RP trusts the CSP’s onboarding process of the wallet to provide assurance that the public key being presented can be trusted to present the attribute bundle in question.</p>

<p>The RP also needs to register with the subscriber-controlled wallet. In most cases, this is expected to be a dynamic process in which the RP introduces its properties during the federation transaction. The nature of a subscriber-controlled wallet makes it difficult for any specific RP to pre-register with an instance of the wallet, but this use case can be facilitated through the use of a trusted third party stipulated in the trust agreement. For example, an ecosystem has a centralized service for managing discovery and registration. When an RP joins the ecosystem, it registers itself with the trusted service, downloads the CSP’s public keys, and receives an identifier to use with wallets. When the wallet is onboarded by the CSP, the wallet is informed where it can find the list of valid RP identifiers within the ecosystem. When the RP connects to the wallet, the wallet can verify the RP’s identifier without the RP having to register itself directly with the wallet. Likewise, the RP can verify the wallet’s signing keys by the fact they are presented in an attribute bundle signed by the CSP’s public key, which had in turn been retrieved from the trusted third party.</p>
<h2 id="authentication-and-attribute-disclosure" data-section="5">
  
  
    Authentication and Attribute Disclosure <a href="#authentication-and-attribute-disclosure" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The decision of whether a federated authentication can occur or attributes may be passed <strong>SHALL</strong> be determined by the subscriber, acting in the role of the authorized party.</p>

<p>The subscriber-controlled wallet <strong>SHOULD</strong> provide a means to selectively disclose a subset of the attributes in the attribute bundle from the CSP.</p>

<p>The CSP <strong>SHALL</strong> provide effective mechanisms for redress of subscriber complaints or problems (e.g., subscriber identifies an inaccurate attribute value, or the need to deprovision a subscriber-controlled wallet). See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>
<h2 id="assertion-requests" data-section="5">
  
  
    Assertion Requests <a href="#assertion-requests" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>When the federation transactions are initiated by the RP, the RP’s request for an assertion <strong>SHALL</strong> contain:</p>

<ol>
  <li>An identifier for the RP</li>
  <li>A cryptographic nonce</li>
  <li>The set of identity attributes requested by the RP and their purpose of use at the RP</li>
</ol>

<p>Note that federation transactions are always initiated by the RP at FAL2 or higher.</p>
<h2 id="assertion-contents" data-section="5">
  
  
    Assertion Contents <a href="#assertion-contents" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Assertions from a subscriber-controlled wallet <strong>SHALL</strong> contain:</p>

<ol>
  <li>A signed attribute bundle from the CSP.</li>
  <li>Subject identifier: An identifier for the party to which the assertion applies (i.e., the subscriber).</li>
  <li>Issuer identifier: An identifier for the issuer of the assertion (i.e., the subscriber-controlled wallet).</li>
  <li>Audience identifier: An identifier for the party intended to consume the assertion (i.e., the RP).</li>
  <li>Issuance time: A timestamp indicating when the wallet issued the assertion.</li>
  <li>Validity time window: A period of time outside of which the assertion <strong>SHALL NOT</strong> be accepted as valid by the RP for the purposes of authenticating the subscriber and starting an authenticated session at the RP. This is usually communicated by means of an expiration timestamp for the assertion in addition to the issuance timestamp.</li>
  <li>Assertion identifier: A value uniquely identifying this assertion, used to prevent attackers from replaying prior assertions.</li>
  <li>Authentication time: A timestamp indicating when the subscriber last used the wallet’s activation factor.</li>
  <li>Nonce: A cryptographic nonce, if one is provided by the RP.</li>
  <li>Signature: Digital signature using asymmetric cryptography, covering the entire assertion.</li>
</ol>

<p>All assertions <strong>SHALL</strong> contain sufficient information to determine the following aspects of the federation transaction:</p>

<ol>
  <li>The IAL of the subscriber account being represented in the assertion, or an indication that no IAL is asserted.</li>
  <li>The wallet’s intended FAL of the federation process represented by the assertion.</li>
</ol>

<p>At FAL3, the assertion <strong>SHALL</strong> include one of the following:</p>

<ul>
  <li>The public key, key identifier, or other identifier for a holder-of-key assertion. This <strong>MAY</strong> be the same key that the subscriber-controlled wallet uses to sign the assertion.</li>
  <li>An indicator that verification of a bound authenticator is required to process this assertion.</li>
</ul>

<p>The signed attribute bundle from the CSP <strong>SHALL</strong> contain:</p>

<ol>
  <li>A public key or key identifier for the key used by the subscriber-controlled wallet to sign the assertion</li>
  <li>Issuance time: A timestamp indicating when the CSP issued the attribute bundle.</li>
  <li>Validity time window: A period of time outside of which the attribute bundle <strong>SHALL NOT</strong> be accepted as valid by the RP for the purposes of authenticating the subscriber and starting an authenticated session at the RP. This is usually communicated by means of an expiration timestamp for the assertion in addition to the issuance timestamp.</li>
  <li>IAL: Indicator of the IAL of the subscriber account being represented in the attribute bundle, or an indication that no IAL is asserted.</li>
  <li>Signature: Digital signature using asymmetric cryptography, covering the entire attribute bundle.</li>
</ol>

<p>Additional identity attributes and derived attribute values <strong>MAY</strong> be included in the attribute bundle. These attributes <strong>SHOULD</strong> be made available using a selective disclosure method, whereby the subscriber can, through their wallet software, determine which parts of the bundle to disclose to the RP.</p>

<p>Identity attributes in the assertion but outside of a signed attribute bundle <strong>SHALL</strong> be considered self-asserted. The RP <strong>MAY</strong> validate these additional attributes out of band.</p>

<p>Subscriber-controlled wallets <strong>SHOULD</strong> use non-exportable key storage as discussed in <a href="/800-63-4/sp800-63c/Federation/#key-storage">Sec. 3.5.2</a>.</p>
<h2 id="assertion-presentation" data-section="5">
  
  
    Assertion Presentation <a href="#assertion-presentation" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Assertions <strong>SHALL</strong> be presented to the RP through an authenticated protected channel.</p>

<p>The presentation <strong>SHALL</strong> include the cryptographic nonce from the RP’s request, if present. The RP <strong>SHALL</strong> verify the nonce in accordance with the federation protocol.</p>

<p>If the assertion contains PII, and the presentation mechanism passes the assertion through a component other than the wallet or RP, the assertion <strong>SHOULD</strong> be encrypted.</p>

<p>The RP <strong>SHALL</strong> protect itself against injection of manufactured or captured assertions by the use of cross-site scripting protection, rejecting assertions outside of the correct stage of a federation transaction, or other accepted techniques discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>. When possible, the IdP <strong>SHOULD</strong> use platform APIs instead of HTTP redirects when delivering an assertion to the RP.</p>

<p>Since assertions from a subscriber-controlled wallet always contain a reference to the wallet’s signing key inside the signed attribute bundle from the CSP, assertions from subscriber-controlled wallets <strong>MAY</strong> be used as holder-of-key assertions to reach FAL3, as long as all other requirements in these guidelines are met. For additional requirements for holder-of-key assertions, see <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec. 3.14</a>.</p>
<h2 id="assertion-validation" data-section="5">
  
  
    Assertion Validation <a href="#assertion-validation" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>The RP <strong>SHALL</strong> validate the signature on all signed attribute bundles in the assertion, using the cryptographic key from the CSP issuing the signed attribute bundle. The RP <strong>SHALL</strong> validate the signature of the assertion using the identified cryptographic key in the signed attribute bundle.</p>

<p>The RP <strong>SHALL</strong> validate the assertion by checking that all the following are true:</p>

<ul>
  <li><em>Issuer verification</em>: ensuring that the assertion was issued by the wallet the RP expects it to be from.</li>
  <li><em>Time validation</em>: ensuring that the expiration and issue times are within acceptable limits of the current timestamp.</li>
  <li><em>Audience restriction</em>: ensuring that this RP is the intended recipient of the assertion.</li>
  <li><em>Nonce</em>: ensuring that the cryptographic nonce included in the RP’s request is included in the presentation.</li>
  <li><em>Transaction terms</em>: ensuring that the IAL, AAL, and FAL represented by the assertion are allowable under the applicable trust agreement.</li>
</ul>

<p>Additionally, the issuer <strong>MAY</strong> make available an online mechanism to determine the validity of a given attribute bundle, such as a status list queryable by the RP.</p>
<h2 id="rp-subscriber-accounts" data-section="5">
  
  
    RP Subscriber Accounts <a href="#rp-subscriber-accounts" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>RP subscriber accounts <strong>SHALL</strong> be managed using a just-in-time or ephemeral provisioning model only (see <a href="/800-63-4/sp800-63c/GenIdP/#provisioning">Sec. 4.6.3</a>). In each of these cases, the RP creates the RP subscriber account and associates it with the federated identifier only after successful validation of the assertion from the wallet.</p>

<p>The RP <strong>SHALL</strong> disclose its practices for management of subscriber information as part of the trust agreement. The RP <strong>SHALL</strong> provide effective means of redress to the subscriber for correcting and removing information from the RP subscriber account. See <a href="/800-63-4/sp800-63c/Federation/#redress">Sec. 3.4.3</a> for additional requirements and considerations for redress mechanisms.</p>

<h1 id="security" data-section="6">
  
  
    Security <a href="#security" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<p>Since the federated authentication process involves coordination between multiple components, including the CSP, IdP, and RP, there are additional opportunities for attackers to compromise federated identity transactions and additional ramifications for successful attacks. This section summarizes many of the attacks and mitigations applicable to federation.</p>
<h2 id="federation-threats" data-section="6">
  
  
    Federation Threats <a href="#federation-threats" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>As in non-federated authentication, attackers’ motivations are typically to gain access (or a greater level of access) to a resource or service provided by an RP. Attackers may also attempt to impersonate a subscriber. Rogue or compromised IdPs, RPs, user agents (e.g., browsers), and parties outside of a typical federation transaction are potential attackers. To accomplish their attack, they might intercept or modify assertions and assertion references. Furthermore, two or more entities may attempt to subvert federation protocols by directly compromising the integrity or confidentiality of the assertion data. For the purpose of these types of threats, any authorized parties who attempt to exceed their privileges are considered attackers.</p>

<p>In federated systems, successful attacks on the IdP can propagate through to the RPs that rely on that IdP for identity and security information. As a consequence, an attack against the IdP targeting one agency’s RP could potentially proliferate to another agency’s RP. Additionally, since a single subscriber account is made available to multiple RPs in a federated system, there are potential limitations on the tailoring to proofing strategies and the visibility into the proofing process that an IdP can offer to different RPs. However, these terms can vary in the trust agreements with each RP, if the IdP is able to support different use cases for different subscriber account populations. Furthermore, while the IdP can disclose different attributes to each RP, the subscriber account will need to contain the union of all attributes available to all RPs. This practice limits the damage of attacks against RPs but in turn makes the IdP a more compelling target for attackers.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/security/#table-2" name="table-2">Table 2. Federation Threats</a></p>

<table latex-table="2" latex-caption="Federation Threats" latex-columns="p@0.20\textwidth,p@0.35\textwidth,p@0.35\textwidth">
  <thead>
    <tr>
      <th>Federation Threats/Attacks</th>
      <th>Description</th>
      <th>Examples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Assertion Manufacture or Modification</td>
      <td>The attacker generates a false assertion</td>
      <td>Compromised IdP asserts identity of a claimant who has not properly authenticated</td>
    </tr>
    <tr>
      <td> </td>
      <td>The attacker modifies an existing assertion</td>
      <td>Compromised proxy that changes AAL of an authentication assertion</td>
    </tr>
    <tr>
      <td>Assertion Disclosure</td>
      <td>Assertion visible to third party</td>
      <td>Network monitoring reveals subscriber address of record to an outside party</td>
    </tr>
    <tr>
      <td>Assertion Repudiation by the IdP</td>
      <td>IdP later claims not to have signed transaction</td>
      <td>User engages in fraudulent credit card transaction at RP, IdP claims not to have logged them in</td>
    </tr>
    <tr>
      <td>Assertion Repudiation by the Subscriber</td>
      <td>Subscriber claims not to have performed transaction</td>
      <td>User agreement (e.g., contract) cannot be enforced</td>
    </tr>
    <tr>
      <td>Assertion Redirect</td>
      <td>Assertion can be used in unintended context</td>
      <td>Compromised user agent passes assertion to attacker who uses it elsewhere</td>
    </tr>
    <tr>
      <td>Assertion Reuse</td>
      <td>Assertion can be used more than once with same RP</td>
      <td>Intercepted assertion used by attacker to authenticate their own session</td>
    </tr>
    <tr>
      <td>Assertion Substitution</td>
      <td>Attacker uses an assertion intended for a different subscriber</td>
      <td>Session hijacking attack between IdP and RP</td>
    </tr>
  </tbody>
</table>
<h2 id="federation-threat-mitigation-strategies" data-section="6">
  
  
    Federation Threat Mitigation Strategies <a href="#federation-threat-mitigation-strategies" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Mechanisms that assist in mitigating the above threats are identified in <a href="/800-63-4/sp800-63c/security/#table-3">Table 3</a>.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/security/#table-3" name="table-3">Table 3. Mitigating Federation Threats</a></p>

<table latex-table="3" latex-caption="Mitigating Federation Threats" latex-columns="p@0.20\textwidth,p@0.55\textwidth,p@0.15\textwidth">
  <thead>
    <tr>
      <th>Federation Threat/Attack</th>
      <th>Threat Mitigation Mechanisms</th>
      <th>Normative Reference(s)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Assertion Manufacture or Modification</td>
      <td>Cryptographically sign the assertion at IdP and verify at RP</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#identifiers-keys">3.5</a>, <a href="/800-63-4/sp800-63c/Federation/#signed-assertion">3.12.2</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Send assertion over an authenticated protected channel authenticating the IdP</td>
      <td><a href="/800-63-4/sp800-63c/GenIdP/#presentation">4.11</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Include a non-guessable random identifier in the assertion</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#assertion-id">3.12.1</a></td>
    </tr>
    <tr>
      <td>Assertion Disclosure</td>
      <td>Send assertion over an authenticated protected channel authenticating the RP</td>
      <td><a href="/800-63-4/sp800-63c/GenIdP/#assertions">4.9</a>, <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">5.8</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Encrypt assertion for a specific RP (may be accomplished by use of a mutually authenticated protected channel)</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#encrypted-assertion">3.12.3</a></td>
    </tr>
    <tr>
      <td>Assertion Repudiation by the IdP</td>
      <td>Cryptographically sign the assertion at the IdP with a key that supports non-repudiation; verify signature at RP</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#signed-assertion">3.12.2</a></td>
    </tr>
    <tr>
      <td>Assertion Repudiation by the Subscriber</td>
      <td>Issue holder-of-key assertions or assertions with bound authenticators; proof of possession of authenticator verifies subscriber’s participation to the RP</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">3.14</a> <a href="/800-63-4/sp800-63c/Federation/#bound-authn">3.15</a></td>
    </tr>
    <tr>
      <td>Assertion Redirect</td>
      <td>Include identity of the RP (“audience”) for which the assertion is issued in its signed content; RP verifies that they are intended recipient</td>
      <td> </td>
    </tr>
    <tr>
      <td>Assertion Reuse</td>
      <td>Include an issuance timestamp with short validity period in the signed content of the assertion; RP verifies validity</td>
      <td><a href="/800-63-4/sp800-63c/GenIdP/#assertions">4.9</a>, <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">5.8</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>RP keeps track of assertions consumed within a configurable time window to ensure that a given assertion is not used more than once.</td>
      <td><a href="/800-63-4/sp800-63c/Federation/#assertion-id">3.12.1</a></td>
    </tr>
    <tr>
      <td>Assertion Substitution</td>
      <td>Ensure that assertions contain a reference to the assertion request or some other nonce that was cryptographically bound to the request by the RP</td>
      <td><a href="/800-63-4/sp800-63c/GenIdP/#assertions">4.9</a>, <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">5.8</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Send assertions in the same authenticated protected channel as the request, such as in the back-channel model</td>
      <td><a href="/800-63-4/sp800-63c/GenIdP/#back-channel">4.11.1</a></td>
    </tr>
  </tbody>
</table>

<h1 id="privacy" data-section="7">
  
  
    Privacy Considerations <a href="#privacy" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>
<h2 id="minimizing-tracking-and-profiling" data-section="7">
  
  
    Minimizing Tracking and Profiling <a href="#minimizing-tracking-and-profiling" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Federation offers numerous benefits to RPs and subscribers, but it requires subscribers to have trust in the federation participants. <a href="/800-63-4/sp800-63c/Federation/#common">Sec. 3</a> and <a href="/800-63-4/sp800-63c/Federation/#ppi">Sec. 3.3.1</a> cover a number of technical requirements, the objective of which is to minimize privacy risks arising from increased capabilities to track and profile subscribers. For example, a subscriber using the same IdP to authenticate to multiple RPs allows the IdP to build a profile of subscriber transactions that would not have existed absent federation. The availability of such data makes it vulnerable to uses that may not be anticipated or desired by the subscriber and may inhibit subscriber adoption of federated services.</p>

<p><a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Section 3.9</a> requires IdPs to use measures to maintain the objectives of predictability (enabling reliable assumptions by individuals, owners, and operators about PII and its processing by an information system) and manageability (providing the capability for granular administration of PII, including alteration, deletion, and selective disclosure) commensurate with privacy risks that can arise from the processing of attributes for purposes other than those listed in <a href="/800-63-4/sp800-63c/Federation/#transmit-subscriber-info">Sec. 3.9.1</a>.</p>

<p>IdPs may have various business purposes for processing attributes, including providing non-identity services to subscribers. However, processing attributes for different purposes from the original collection purpose can create privacy risks when individuals are not expecting or comfortable with the additional processing. IdPs can determine appropriate measures commensurate with the privacy risk arising from the additional processing. For example, absent applicable law, regulation, or policy, it may not be necessary to get consent when processing attributes to provide non-identity services requested by subscribers, although notices may help subscribers maintain reliable assumptions about the processing (e.g., predictability). Other processing of attributes may carry different privacy risks that call for obtaining consent or allowing subscribers more control over the use or disclosure of specific attributes (manageability). Subscriber consent needs to be meaningful; therefore, when IdPs do use consent measures, they cannot make acceptance by the subscriber of additional uses a condition of providing the identity service.</p>

<p>When holder-of-key assertions are used at FAL3, the same authenticator is usually used at both the IdP and RP. With authenticators that can fulfill this technical requirement, it is likely that the same authenticator would further be used at multiple RPs. Furthermore, an unrelated RP could use the same authenticator for direct authentication. All such RPs would potentially be able to collude and disclose the use of the same authenticator across all parties in order to effect tracking of the subscriber through the network. This is true even if per-provider identifiers are used, as the bound authenticator is recognizable apart from the assertion. Additionally, many authenticators suitable for holder-of-key assertions contain identity attributes which are sent apart from the assertion or an identity API. These additional attributes have to be covered by the privacy risk assessment.</p>

<p>Consult the SAOP if there are questions about whether the proposed processing falls outside the scope of the permitted processing or the appropriate privacy risk mitigation measures.</p>

<p><a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Section 3.9</a> also encourages the use of technical measures to provide disassociability (enabling the processing of PII or events without association to individuals or devices beyond the operational requirements of the system) and prevent subscriber activity tracking and profiling <a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062">[NISTIR8062]</a>. Technical measures, such as those outlined in <a href="/800-63-4/sp800-63c/Federation/#proxied">Sec. 3.2.3</a> for proxied federation and <a href="/800-63-4/sp800-63c/Federation/#ppi">Sec. 3.3.1</a> for pairwise pseudonymous identifiers, can increase the effectiveness of policies by making it more difficult to track or profile subscribers beyond operational requirements. However, even these measures have their limitations and tracking can still occur based on subscriber attributes, statistical demographics, and other kinds of information shared between the IdP and RP.</p>

<p>In some use cases, especially at higher xALs, tracking the real-world identity of the subscriber is expected as a means of securing the system. It is the responsibility of the IdP and RP to inform and educate the subscriber about which pieces of information are transmitted, and allow the subscriber to review this information.</p>
<h2 id="notice" data-section="7">
  
  
    Notice and Consent <a href="#notice" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>To build subscriber trust in federation, subscribers need to be able to develop reliable assumptions about how their information is being processed. For instance, it can be helpful for subscribers to understand what information will be transmitted, which attributes for the transaction are required versus optional, and to have the ability to decide whether to transmit optional attributes to the RP. Accordingly, <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> requires that positive confirmation be obtained from the authorized party before any attributes about the subscriber are transmitted to any RP.</p>

<p>In determining when a set of RPs should share a shared pairwise pseudonymous identifier as in <a href="/800-63-4/sp800-63c/Federation/#ppi-shared">Sec. 3.3.1.3</a>, the trust agreement considers the subscriber’s understanding of such a grouping of RPs and provides a means for effective notice to the subscriber in assisting such understanding. An effective notice will take into account user experience design standards and research, as well as an assessment of privacy risks that may arise from the information processing. There are various factors to be considered, including the reliability of the assumptions subscribers may have about the processing and the role of different entities involved in federation. However, a link to a complex, legalistic privacy policy or general terms and conditions that a substantial number of subscribers do not read or understand is never an effective notice.</p>

<p><a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> does not specify which party should provide the notice. In some cases, a party in a federation may not have a direct connection to the subscriber in order to provide notice and obtain consent. Although multiple parties may elect to provide notice, it is permissible for parties to determine in advance, either contractually or through trust framework policies, which party will provide the notice and obtain confirmation, as long as the determination is being based upon factors that center on enabling the subscriber to pay attention to the notice and make an informed choice.</p>

<p>The IdP is required to inform subscribers of all RPs that might access the subscriber’s attributes. If an RP is on an IdP’s allowlist as described in <a href="/800-63-4/sp800-63c/GenIdP/#idp-allowlist">Sec. 4.6.1.1</a>, the subscriber will not be prompted at runtime to consent to the release of their attributes. This single-sign-on scenario allows for a more seamless login experience for the subscriber, who might not even realize they are participating in a federation transaction. The IdP makes its list of allowlisted RPs available to the subscriber as part of the terms of the trust agreement. This information allows the subscriber to see which RPs might have access to their attributes, under what circumstances, and for what purposes.</p>

<p>If a subscriber’s runtime decisions at the IdP were stored in the subscriber account by the IdP to facilitate future transactions, the IdP also needs to allow the subscriber to view and revoke any RPs that were previously approved during a runtime decision. This list includes information on which attributes were approved and when the approval was recorded. Similarly, if a subscriber’s runtime decisions at the RP are stored in some fashion, the RP also needs to allow the subscriber to view and revoke any IdPs that were approved during a runtime decision.</p>
<h2 id="minimization" data-section="7">
  
  
    Data Minimization <a href="#minimization" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Federation enables the data exposed to an RP to be minimized, which can yield privacy protections for subscribers. Although an IdP may collect additional attributes beyond what the RP requires for its use case, only those attributes that were explicitly requested by the RP are to be transmitted by the IdP. In some instances, an RP does not require a full value of an attribute. For example, an RP may need to know whether the subscriber is over 13 years old, but has no need for the full date of birth. To minimize collection of potentially sensitive PII, the RP may request a derived attribute value (e.g., Question: Is the subscriber over 13 years old? Response: Y/N or Pass/Fail). This minimizes the RP’s collection of potentially sensitive and unnecessary PII. Accordingly, <a href="/800-63-4/sp800-63c/Federation/#protecting-information">Sec. 3.10.2</a> recommends the RP to, where feasible, request derived attribute values rather than full attribute values. To support this RP requirement IdPs are, in turn, required to support a derived attribute value.</p>
<h2 id="agency-privacy" data-section="7">
  
  
    Agency-Specific Privacy Compliance <a href="#agency-privacy" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p><a href="/800-63-4/sp800-63c/Federation/#privacy-reqs">Section 3.9</a> identifies agency requirements to consult their SAOP to determine privacy compliance requirements. It is critical to involve the agency’s SAOP in the earliest stages of digital authentication system development to assess and mitigate privacy risks and advise the agency on compliance obligations such as whether the federation triggers the Privacy Act of 1974 or the E-Government Act of 2002 requirement to conduct a PIA. For example, if the agency is serving as an IdP in a federation, it is likely that the Privacy Act requirements will be triggered and require coverage by either a new or existing Privacy Act System of Records Notice since credentials would be maintained at the IdP on behalf of any RP it federates with. If, however, the agency is an RP and using a third-party IdP, digital authentication may not trigger the requirements of the Privacy Act, depending on what data passed from the RP is maintained by the agency at the RP (in such instances the agency may have a broader programmatic SORN that covers such data).</p>

<p>The SAOP can similarly assist the agency in determining whether a PIA is required. These considerations should not be read as a requirement to develop a Privacy Act SORN or PIA for use of a federated credential alone. In many cases it will make the most sense to draft a PIA and SORN that encompasses the entire digital authentication process or includes the digital authentication process as part of a larger programmatic PIA that discusses the program or benefit the agency is establishing online access.</p>

<p>Due to the many components of digital authentication, it is important for the SAOP to have an awareness and understanding of each individual component. For example, other privacy artifacts may be applicable to an agency offering or using federated IdP or RP services, such as Data Use Agreements, Computer Matching Agreements, etc. The SAOP can assist the agency in determining what additional requirements apply. Moreover, a thorough understanding of the individual components of digital authentication will enable the SAOP to thoroughly assess and mitigate privacy risks either through compliance processes or by other means.</p>
<h2 id="blinding" data-section="7">
  
  
    Blinding in Proxied Federation <a href="#blinding" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>While some proxy structures — typically those that exist primarily to simplify integration — may not offer additional subscriber privacy protection, others offer varying levels of privacy to the subscriber through a range of blinding technologies. Privacy policies may dictate appropriate use of the subscriber attributes and authentication transaction data (e.g., identities of the ultimate IdP and RP) by the IdP, RP, and the federation proxy.</p>

<p>Technical means such as blinding can increase effectiveness of these policies by making the data more difficult to obtain. A proxy-based system has three parties, and the proxy can be used to hide information from one or more of the parties, including itself. In a double-blind proxy, the IdP and RP do not know each other’s identities, and their relationship is only with the proxy. In a triple-blind proxy, the proxy additionally does not have insight into the data being passed through it. As the level of blinding increases, the technical and operational implementation complexity may increase. Since proxies need to map transactions to the appropriate parties on either side as well as manage the keys for all parties in the transaction, fully triple-blind proxies are very difficult to implement in practice.</p>

<p>Even with the use of blinding technologies, a blinded party may still infer protected subscriber information through released attribute data or metadata, such as by analysis of timestamps, attribute bundle sizes, or attribute signer information. The IdP could consider additional privacy-enhancing approaches to reduce the risk of revealing identifying information of the entities participating in the federation.</p>

<p>The following table illustrates a spectrum of blinding implementations used in proxied federation. This table is intended to be illustrative, and is neither comprehensive nor technology-specific.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/privacy/#table-4" name="table-4">Table 4. Proxy Characteristics</a></p>

<table latex-table="4" latex-caption="Proxy Characteristics" latex-columns="p@0.20\textwidth,p@0.17\textwidth,p@0.17\textwidth,p@0.25\textwidth,p@0.20\textwidth">
  <thead>
    <tr>
      <th>Proxy Type</th>
      <th style="text-align: center">RP knows IdP</th>
      <th style="text-align: center">IdP knows RP</th>
      <th style="text-align: center">Proxy can track subscriptions between RP and IdP</th>
      <th style="text-align: center">Proxy can see attributes of Subscriber</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Non-Blinding Proxy with Attributes</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
    </tr>
    <tr>
      <td>Non-Blinding Proxy</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">N/A</td>
    </tr>
    <tr>
      <td>Double Blind Proxy with Attributes</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">Yes</td>
    </tr>
    <tr>
      <td>Double Blind Proxy</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">Yes</td>
      <td style="text-align: center">N/A</td>
    </tr>
    <tr>
      <td>Triple Blind Proxy with or without Attributes</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">No</td>
      <td style="text-align: center">No</td>
    </tr>
  </tbody>
</table>

<h1 id="usability" data-section="8">
  
  
    Usability Considerations <a href="#usability" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<blockquote>
  <p>In order to align with the standard terminology of user-centered design and usability, the term “user” is used throughout this section to refer to the human party. In most cases, the user in question will be the subject (in the role of applicant, claimant, or subscriber) as described elsewhere in these guidelines.</p>
</blockquote>

<p><em>Ergonomic of Human-System Interaction — Part 11: Usability: Definitions and Concepts</em> <a href="/800-63-4/sp800-63c/references/#ref-ISOIEC9241">[ISO/IEC9241-11]</a> defines usability as the “extent to which a system, product or service can be used by specified users to achieve specified goals with effectiveness, efficiency and satisfaction in a specified context of use.” This definition focuses on users, goals, and context of use as key elements necessary for achieving effectiveness, efficiency and satisfaction. A holistic approach considering these key elements is necessary to achieve usability.</p>

<p>From the usability perspective, one of the major potential benefits of federated identity systems is to address the problem of user fatigue associated with managing multiple authenticators. While this has historically been a problem with usernames and passwords, the increasing need for users to manage many authenticators — whether physical or digital — presents a usability challenge.</p>

<p>As stated in <a href="/800-63-4/sp800-63a/usability/#sec9" latex-href="#ref-SP800-63A">Sec. 8 of [SP800-63A]</a> and <a href="/800-63-4/sp800-63b/usability/#sec10" latex-href="#ref-SP800-63B">Sec. 8 of [SP800-63B]</a>, overall user experience is critical to the success of digital identity systems. This is especially true for federated identity systems, as federation is a less familiar user interaction paradigm for many users. Users’ prior authentication experiences may influence their expectations.</p>

<p>The overall user experience with federated identity systems should be as smooth and easy as possible. This can be accomplished by following usability standards (such as the ISO 25060 series of standards) and established best practices for user interaction design.</p>

<p>Guidelines and considerations are described from the users’ perspective.</p>

<p>Section 508 of the Rehabilitation Act of 1973 <a href="/800-63-4/sp800-63c/references/#ref-Section508">[Section508]</a> was enacted to eliminate barriers in information technology and require federal agencies to make electronic and information technology accessible to people with disabilities. While these guidelines do not directly assert requirements from Section 508, identity service providers are expected to comply with Section 508 provisions. Beyond compliance with Section 508, Federal Agencies and their service providers are generally expected to design services and systems with the experiences of people with disabilities in mind to ensure that accessibility is prioritized throughout identity system lifecycles.</p>
<h2 id="general-usability-considerations" data-section="8">
  
  
    General Usability Considerations <a href="#general-usability-considerations" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Federated identity systems should:</p>

<ul>
  <li>Minimize user burden (e.g., frustration, learning curve)
    <ul>
      <li>Minimize the number of user actions required.</li>
      <li>Allow users to quickly and easily select among multiple subscriber accounts with a single IdP. For example, approaches such as <a href="https://openid.net/wg/ac/">Account Chooser</a> allow users to select from a list of subscriber accounts they have accessed in the recent past, rather than start the federation process by selecting their IdP from a list of potential IdPs.</li>
      <li>Balance minimizing user burden with the need to provide sufficient information to enable users to make informed decisions.</li>
    </ul>
  </li>
  <li>
    <p>Minimize the use of unfamiliar technical jargon and details (e.g., users do not need to know the terms IdP and RP if the basic concepts are clearly explained).</p>
  </li>
  <li>
    <p>Strive for a consistent and integrated user experience across the IdP and RP.</p>
  </li>
  <li>
    <p>Help users establish an understanding of identity by providing resources to users such as graphics, illustrations, FAQs, tutorials and examples. Resources  should explain how users’ information is treated and how transacting parties (e.g., RPs, IdPs, and brokers) relate to each other.</p>
  </li>
  <li>
    <p>Provide clear, honest, and meaningful communications to users (i.e., communications should be explicit and easy to understand).</p>
  </li>
  <li>
    <p>Provide users online services independent of location and device.</p>
  </li>
  <li>
    <p>Make trust relationships explicit to users to facilitate informed trust decisions. Trust relationships are often dynamic and context dependent. Users may be more likely to trust some IdPs and RPs with certain attributes or transactions more than others. For example, users may be more hesitant to use federated identity systems on websites that contain valuable personal information (such as financial or health). Depending on the perceived sensitivity of users’ personal information, users may be less comfortable with commercial as IdPs since people often have concerns about advertising and data-usage of such companies. Conversely, some may have more confidence in the commercial IdPs than government IdPs based on their historical interactions with government services. Either way, it is critical to be clear to end-users on the entities involved in a federation transaction and, ideally, provide options that support the broadest set of stakeholder perceptions possible.</p>
  </li>
  <li>
    <p>Follow the usability considerations specified in <a href="/800-63-4/sp800-63a/usability/#sec9" latex-href="#ref-SP800-63A">[SP800-63A] Sec. 8</a> for any user-facing information.</p>
  </li>
  <li>
    <p>Clearly communicate how and where to acquire technical assistance. For example, provide users with information such as a link to an online self-service feature, chat sessions or a phone number for help desk support. Avoid redirecting users back and forth among transacting parties (e.g., RPs, IdPs, and brokers) to receive technical assistance.</p>
  </li>
  <li>Perform integrative and continuous usability evaluations with representative users and realistic tasks in an appropriate context to ensure success of federated identity systems from the users’ perspectives.</li>
</ul>
<h2 id="specific-usability-considerations" data-section="8">
  
  
    Specific Usability Considerations <a href="#specific-usability-considerations" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>This section addresses the specific usability considerations that have been identified with federated identity systems. This section does not attempt to present exhaustive coverage of all usability factors related to federated identity systems. Rather, it is focused on the larger, more pervasive themes in the usability literature, primarily users’ perspectives on identity, user adoption, trust, and perceptions of federated identity space. In some cases, implementation examples are provided. However, specific solutions are not prescribed. The implementations mentioned are examples to encourage innovative technological approaches to address specific usability needs. See standards for system design and coding, specifications, APIs, and current best practices (such as OpenID and OAuth) for additional examples. Implementations are sensitive to many factors that prevent a one-size-fits-all solution.</p>
<h3 id="user-perspectives-on-online-identity" data-section="8">
  
  
    User Perspectives on Online Identity <a href="#user-perspectives-on-online-identity" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Even when users are familiar with federated identity systems, there are different approaches to federated identity (especially in terms of privacy and the sharing of information) that make it necessary to establish reliable expectations for how users’ data are treated. Users and implementers have different concepts of identity. Users think of identity as logging in and gaining access to their own private space. Implementers think of identity in terms of authenticators and assertions, assurance levels, and the necessary set of identity attributes to provide a service. Given this disconnect between users’ and implementers’ concepts of identity, it is essential to help users form an accurate concept of identity as it applies to federated identity systems. A good model of identity provides users a foundation for understanding the benefits and risks of federated systems and encourage user adoption and trust of these systems.</p>

<p>To minimize the personal information collected and protect privacy, IdPs ought to provide users with pseudonymous options for providing data to RPs, where possible, and inform users of the benefits and drawbacks of pseudonymous identification.
Likewise, RPs ought to request pseudonymous options for users when pseudonymity is possible for the RP’s policy. Both IdPs and RPs need to seek to minimize unnecessary data transmission and inform users of which information is transmitted and for what purpose.</p>

<p>Many properties of identity have implications for how users manage identities, both within and among federations. Just as users manage multiple identities based on context outside of cyberspace, users must learn to manage their identity in a federated environment. Therefore, it must be clear to users how identity and context are used. The following factors should be considered:</p>

<ul>
  <li>
    <p>Provide users the requisite context and scope in order to distinguish among different user roles. For example, whether the user is acting on their own behalf or on behalf of another, such as their employer.</p>
  </li>
  <li>
    <p>Provide users unique, meaningful, and descriptive identifiers to distinguish among entities such as IdPs, RPs, and accounts. Any such user-facing identifiers are likely to be in addition to identifiers used by the underlying protocols, which are not normally exposed to the user.</p>
  </li>
  <li>
    <p>Provide users with information on data ownership and those authorized to make changes. Identities, and the data associated with them, can sometimes be updated and changed by multiple actors. For example, some healthcare data is updated and owned by the patient, while some data is only updated by a hospital or doctor’s practice.</p>
  </li>
  <li>
    <p>Provide users with the ability to easily verify, view, and update attributes. Identities and user roles are dynamic and not static; they change over time (e.g., age, health, and financial data). The ability to update attributes or make attribute release decisions may or may not be offered at the same time. Ensure the process for how users can change attributes is well known, documented, and easy to perform.</p>
  </li>
  <li>
    <p>Provide users means for updating data, even if the associated subscriber account or RP subscriber account no longer exists. Consider applicable audit, legal, or policy constraints for needs to track updated data.</p>
  </li>
  <li>
    <p>Provide users means to delete their identities completely, removing all information about themselves, including transaction history. Consider applicable audit, legal, or policy constraints that may preclude such action. In certain cases, full deactivation is more appropriate than deletion.</p>
  </li>
  <li>
    <p>Provide users with clear, easy-to-find, site/application data retention policy information.</p>
  </li>
  <li>
    <p>Provide users with appropriate anonymity and pseudonymity options, and the ability to switch among such identity options as desired, in accordance with an organization’s data access policies.</p>
  </li>
  <li>
    <p>Provide a means for users to manage each IdP to RP connection, including complete separation as well as the removal of RP access to one or more attributes.</p>
  </li>
</ul>
<h3 id="user-perspectives-of-trust-and-benefits" data-section="8">
  
  
    User Perspectives of Trust and Benefits <a href="#user-perspectives-of-trust-and-benefits" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Many factors can influence user adoption of federated identity systems. As with any technology, users may value some factors more than others. Users often weigh perceived benefits versus risks before making technology adoption decisions. It is critical that IdPs and RPs provide users with sufficient information to enable them to make informed decisions. The concepts of trust and tiers of trust — fundamental principles in federated identity systems — can drive user adoption. Finally, a positive user experience may also result in increased user demand for federation, triggering increased adoption by RPs.</p>

<p>This sub-section is focused primarily on user trust and user perceptions of benefits versus risks.</p>

<p>To encourage user adoption, IdPs and RPs need to establish and build trust with users and provide them with an understanding of the benefits and risks of adoption. The following factors should be considered:</p>

<ul>
  <li>
    <p>Allow users to control their information disclosure and provide explicit consent through the appropriate use of interactive user interfaces and notifications (see <a href="/800-63-4/sp800-63c/privacy/#notice">Sec. 7.2</a>). Considerations such as balancing the content, size, and frequency of notifications as well as tailoring notifications to specific communities are necessary to avoid thoughtless user click-through.</p>
  </li>
  <li>For attribute sharing, consider the following:
    <ul>
      <li>Provide a means for users to verify those attributes and attribute values that will be shared. Follow good security practices (see <a href="/800-63-4/sp800-63c/Federation/#protecting-information">Sec. 3.10.2</a> and <a href="/800-63-4/sp800-63c/security/#security">Sec. 6</a>).</li>
      <li>Enable users to consent to a partial list of attributes, rather than an all-or-nothing approach. Allow users some degree of online access, even if the user does not consent to share all information.</li>
      <li>Allow users to update their consent to their list of shared attributes.</li>
      <li>Minimize unnecessary information presented to users. For example, do not display system generated attributes (such as pairwise pseudonymous identifiers) even if they are shared with the RP as part of the authentication response.</li>
      <li>Minimize user steps and navigation. For example, build attribute consent into the protocols so they’re not a feature external to the federation transaction. Examples can be found in standards such as OAuth or OpenID Connect.</li>
      <li>Provide effective redress methods such that a user can recover from invalid attribute information claimed by the IdP or collected by the RP. See <a href="../_sp80063/3_DIRM.md#redress" latex-href="#ref-SP800-63">Sec 3.6 of [SP800-63]</a> for more requirements on providing redress.</li>
      <li>Minimize the number of times a user is required to consent to attribute sharing. Limiting the frequency of consent requests avoids user frustration from multiple requests to share the same attribute.</li>
    </ul>
  </li>
  <li>
    <p>Collect information for constrained usage only and minimize information disclosure (see <a href="/800-63-4/sp800-63c/privacy/#minimization">Sec. 7.3</a>). User trust is eroded by unnecessary and superfluous information collection and disclosure or user tracking without explicit user consent. For example, only request attributes from the user that are relevant to the current transaction, not for all possible transactions a user may or may not access at the RP.</p>
  </li>
  <li>Clearly and honestly communicate potential benefits and risks of using federated identity to users. Benefits that users value include time savings, ease of use, reduced number of passwords to manage, and increased convenience.</li>
</ul>

<p>User concern over risk can negatively influence willingness to adopt federated identity systems. Users may have trust concerns, privacy concerns, security concerns, and single-point-of-failure concerns. For example, users may be fearful of losing access to multiple RPs if a single IdP is unavailable, either temporarily or permanently. Additionally, users may be concerned or confused about learning a new authentication process. In order to foster the adoption of federated identity systems, the perceived benefits must outweigh the perceived risks.</p>
<h3 id="user-mental-models-and-beliefs" data-section="8">
  
  
    User Mental Models and Beliefs <a href="#user-mental-models-and-beliefs" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>

<p>Users’ beliefs and perceptions predispose them to expect certain results and to behave in certain ways. Such beliefs, perceptions, and predispositions are referred to in the social sciences as mental models. For example, people have a mental model of dining out that guides their behavior and expectations at each establishment, such as fast food restaurants, cafeterias, and more formal restaurants. Thus, it is not necessary to be familiar with every establishment to understand how to interact appropriately at each one.</p>

<p>Assisting users in establishing good and complete mental models of federation allows users to generalize beyond a single specific implementation. If federated identity systems are not designed from users’ perspectives, users may form incorrect or incomplete mental models that impact their willingness to adopt these systems. The following factors should be considered:</p>

<ul>
  <li>Clearly explain the working relationship and information flow among the transacting parties (e.g., RPs, IdPs, and proxies) to avoid user misconceptions. Use the actual names of the entities in the explanation rather than using the generic terms IdPs and RPs.
    <ul>
      <li>Provide prominent visual cues and information so that users understand why seemingly unrelated entities have a working relationship. For example, users may be concerned with mixing online personal activities with government services due to a lack of understanding of the information flow in federated identity systems.</li>
      <li>Provide prominent visual cues and information to users about redirection when an RP needs to redirect control from their site to an IdP. For example, display RP branding within the IdP user interface to inform users when they are logging in with their IdP for access to the destination RP.</li>
    </ul>
  </li>
  <li>
    <p>Provide users with clear and usable ways (e.g., visual assurance) to determine the authenticity of the transacting  parties (e.g., RPs, IdPs, and proxies). This will also help to alleviate user concern over leaving one domain for another, especially if the root domain changes (e.g., .gov to .com). For example, display the URL of the IdP so that the user can verify that they are not being phished by a malicious site.</p>
  </li>
  <li>Provide users with clear information, including visual cues, regarding logins and logouts. Depending on the implementation, logging into an RP with a federated account can create long-running sessions for the user at both the IdP and RP. Users may not realize that ending their session with the RP will not necessarily end their session with the IdP; users will need to explicitly “log out” of the IdP. Users require clear information to remind them if explicit logouts are required to end their IdP sessions. Both the IdP and RP could also have automated logout features, based on time since authentication or an activity timeout. Users require clear information about when their session might end without any action on their part, in order to avoid frustration, lost work, or insecure workarounds like copying data out of a secure site in order to avoid an unexpected session timeout.</li>
</ul>

<h1 id="equity" data-section="9">
  
  
    Equity Considerations <a href="#equity" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<p>Equitable access to the functions of IdPs and RPs is an essential element of a federated identity system. The ability for all subscribers to authenticate reliably is required to provide equitable access to government services, even when using federation technology, as specified in Executive Order 13985, <em>Advancing Racial Equity and Support for Underserved Communities Through the Federal Government</em> <a href="/800-63-4/sp800-63c/references/#ref-EO13985">[EO13985]</a>. In assessing equity risks, IdPs and RPs should consider the overall user population served by their federated identity service. Additionally, IdPs and RPs further identify groups of users within the population whose shared characteristics can cause them to be subject to inequitable access, treatment, or outcomes when using that service. The Usability Considerations provided in <a href="../8_usability.md#usability">Sec. 8</a> should also be considered to help ensure the overall usability and equity for all persons using federated identity services.</p>

<p>In its role as the verifier, the IdP needs to be aware of equity considerations related to identity proofing, attribute validation, and enrollment as enumerated in <a href="/800-63-4/sp800-63a/equity/#sec11" latex-href="#ref-SP800-63A">[SP800-63A] Sec. 9</a> and equity considerations concerning authenticators as enumerated in <a href="/800-63-4/sp800-63b/equity/#sec11" latex-href="#ref-SP800-63B">[SP800-63B] Sec. 9</a>. An RP offering FAL3 will also need to be aware of these same authenticator considerations when processing bound authenticators and holder-of-key assertions.</p>

<p>Since the federation process takes place over a network protocol between multiple active parties, the experience of authenticating using the federation system may present equity problems, such as the following examples:</p>

<ul>
  <li>Completing the entire federation transaction without timing out may be difficult for subscribers without a reliable network connection, such as those in rural areas.</li>
  <li>It may be difficult to provide informed consent for a runtime decision regarding the release of attributes for subscribers with intellectual, developmental, learning, or neurocognitive difficulties.</li>
  <li>Systems with sufficient processing power, network access, and other features required to interact with both the IdP and the RP simultaneously may be too costly or beyond some subscribers’ technological skill to access or use.</li>
  <li>Subscribers that share devices may find allowlist-based systems difficult to manage securely, as other users of the device could silently gain unintended access to an RP through a session still active at the IdP.</li>
  <li>It could be prohibitively difficult to re-establish an account at the RP for subscribers who lose access to their IdP for any of a variety of reasons.</li>
</ul>

<p>Additionally, subscribers in disadvantaged populations could be more susceptible to monitoring and tracking through federation systems, as discussed in <a href="/800-63-4/sp800-63c/privacy/#privacy">Sec. 7</a>.
If the IdP knows the subscriber is part of a disadvantaged population, the IdP could specifically target the subscriber by profiling them and their access to the set of RPs, and use the data gathered against the subscriber.
Alternatively, the IdP could learn that that the subscriber is part of a disadvantaged population by watching the RP connections. For example, if the IdP sees that the subscriber logs into social services, the IdP has learned things about the subscriber’s socioeconomic status that were not disclosed  to the IdP. The IdP could then use this to unfairly target the subscriber and provide a lower quality of service.
Additionally, subscribers in disadvantaged populations are at a greater risk of having their data correlated between a set of colluding RPs. For example, a set of RPs could share subscriber attributes and behavior among them in order to justify denial of the RP’s services to the subscriber.
As such, IdPs and RPs are encouraged to use privacy-enhancing techniques equally across subscriber populations.</p>

<p>When consent dialogs and notifications are sent to users, the content of these should be tailored to different subscriber populations in order to facilitate subscriber understanding and avoid thoughtless click-through.</p>

<p>IdPs are required to disclose the method of proofing used for each subscriber as recorded in the subscriber account. This includes all available forms of proofing and exception processes, and possibly compensating controls, as defined in the trust agreement. IdPs and CSPs should not single out subscribers who have had to make use of exception handling or compensating controls beyond the proofing information contained in their subscriber account to avoid bias processing against certain subscriber populations.</p>

<p>Since federation transactions are intended to cross security domain boundaries, discrepancies between the interests of the IdP and the RP could pose additional considerations. This difference in requirements has to be addressed in the trust agreement that governs the connection between these parties, and practices such as transparent reporting can help address some forms of disparities. Furthermore, the availability of alternative IdPs (for the RP) and RPs (for the IdP) for a given service can help enhance the equity of the system overall. For example in a public-private partnership, if a private IdP is used to access a federal RP, or a federal IdP is used to access a private RP, the public and private systems could be driven by different motivations and bound by different requirements in terms of equity, accessibility, and transparency.</p>

<p>Normative requirements have been established requiring IdPs and RPs to mitigate the problems in this area that are expected to be most common. However, normative requirements are unlikely to have anticipated all potential equity problems. Potential equity problems also will vary for different applications. Accordingly, IdPs and RPs need to provide mechanisms for subscribers to report inequitable authentication requirements and to advise them on potential alternative authentication strategies.</p>

<p>This guideline allows the binding of additional federated identifiers to an RP subscriber account to minimize the risk of IdP access loss (see <a href="/800-63-4/sp800-63c/Federation/#rp-account">Sec. 3.7</a>). However, a subscriber might find it difficult to have multiple IdP accounts that are acceptable to the RP at the same time. This inequity can be addressed by having the RP having its own account recovery process that allows for the secure linking of multiple federated identifiers to the RP subscriber account.</p>

<p>RPs need to be aware that not all subscribers will necessarily have access to the same IdPs. The RPs can institute locally authenticated accounts for such subscribers, and later allow binding of those accounts to federated identifiers.</p>

<h1 id="examples" data-section="10">
  
  
    Examples <a href="#examples" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<p>This appendix contains several example scenarios of federation used in conjunction with the requirements in these guidelines.</p>

<p>The scenarios in this section are for illustrative purposes and do not convey additional requirements beyond those imposed by these guidelines.</p>
<h2 id="mapping-fals-to-common-federation-protocols" data-section="10">
  
  
    Mapping FALs to Common Federation Protocols <a href="#mapping-fals-to-common-federation-protocols" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Of protocols commonly in use today, OpenID Connect <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> and SAML <a href="/800-63-4/sp800-63c/references/#ref-SAML">[SAML]</a> both provide a variety of capabilities that can be leveraged to reach the requirements at different FALs. <a href="/800-63-4/sp800-63c/examples/#table-5">Table 5</a> provides examples of specific options in these protocols that could be deployed to reach a given FAL. It’s important to note that these guidelines do not represent a normative mapping to the given FALs and the entirety of the federation process has to be considered when establishing an FAL. Additionally, each FAL could be reached by processes, deployments, and procedures that are not listed in this table.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/examples/#table-5" name="table-5">Table 5. FAL Protocol Examples</a></p>

<table latex-table="5" latex-caption="FAL Protocol Examples" latex-columns="p@0.10\textwidth,p@0.42\textwidth,p@0.42\textwidth">
  <thead>
    <tr>
      <th> </th>
      <th>OIDC</th>
      <th>SAML</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>FAL1</td>
      <td>All core flows in <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> (Authorization Code, Implicit, and Hybrid) can all be configured to require signing of the assertion (the ID Token) using JSON Web Signatures. Assertions are presented in a variety of front and back channel methods. Each of these flows can be built using both static and dynamic client registration. Profiles such as <a href="/800-63-4/sp800-63c/references/#ref-OIDC-basic">[OIDC-Basic]</a> and <a href="/800-63-4/sp800-63c/references/#ref-OIDC-implicit">[OIDC-Implicit]</a> can provide additional guidance for interoperable deployments.</td>
      <td>The <a href="/800-63-4/sp800-63c/references/#ref-SAML-WebSSO">[SAML-WebSSO]</a> profile allows for the signing of assertions using XML D-Sig and presentation of the assertion using the front channel. SAML deployments are generally set up with a static registration, sometimes managed through a federation authority, which can meet the requirements at this FAL and above.</td>
    </tr>
    <tr>
      <td>FAL2</td>
      <td>Flows that present the ID Token in the back channel (such as Authorization Code and Hybrid) can provide a level of injection protection.</td>
      <td>The Artifact Binding of SAML defined in <a href="/800-63-4/sp800-63c/references/#ref-SAML-bindings">[SAML-Bindings]</a> allows for a back-channel presentation of SAML assertions that can provide a level of injection protection.</td>
    </tr>
    <tr>
      <td>FAL3</td>
      <td>The ID Token can include the claims necessary for Holder-of-Key and Bound Authenticator assertion presentations, though to date there are not industry standard profiles for doing so.</td>
      <td>The SAML Holder-of-Key profile can fit the assertion requirements at this level, if combined with other deployment choices.</td>
    </tr>
  </tbody>
</table>

<p>For OpenID Connect in particular, it is common practice to give access to both an identity API (the UserInfo Endpoint) as well as additional APIs. While the security of API access is outside the scope of these guidelines (which are concerned with the identity assertion primarily), it is sensible for an OpenID Connect implementation to want to increase the security of all API calls in tandem with the FAL. For example, in addition to requiring a Holder-of-Key assertion at FAL3, which requires verification of a subscriber-held key, an OpenID Connect system might also require sender-constrained access tokens for API access, which require the verification of a key held by the RP for each API call.</p>
<h2 id="direct-connection-to-an-agencys-idp" data-section="10">
  
  
    Direct Connection to an Agency’s IdP <a href="#direct-connection-to-an-agencys-idp" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Agency A, which issues and manages subscriber accounts, sets up and operates an OpenID Connect IdP in order to make these subscriber accounts available online through a federation process.</p>

<p>The RP enters into a pairwise trust agreement with the IdP to accept assertions for subscribers from Agency A. The RP declares the set of attributes that it needs from the IdP as part of this agreement. The trust agreement stipulates that the subscriber is the authorized party for determining the release of attributes in the federation transaction.</p>

<p>The IdP generates a federated identifier for the subscriber account by taking the unique internal identifier for the subscriber account (such as an employee record number) and passing it through a one-way cryptographic function to create a unique identifier for the subscriber account. Such an identifier does not allow an RP to calculate the internal identifier but will be stable across attribute changes.</p>

<p>Per the terms of the trust agreement, the subscriber is prompted by the IdP the first time they log on to the RP. The IdP asks for the subscriber’s consent at runtime to share their attributes with the RP, displaying to the subscriber the RP’s requested uses for these attributes on the consent screen. The IdP also prompts the subscriber to allow the IdP to remember this consent decision. This stored decision causes the IdP to act on the stored consent in a future request and not prompt the subscriber if the same RP requests the same attributes.</p>

<p>The assertion, formatted as an OpenID Connect ID Token, contains the minimum set of attributes to facilitate the federated log in. Apart from the federated identifier, the assertion contains no identifying information about the subscriber. In addition to the assertion, the RP is given an OAuth 2.0 access token that allows the RP to access the identity API hosted by the IdP, the OpenID Connect UserInfo Endpoint. The RP can choose to call this API to get additional attributes as needed, such as the first time the subscriber uses the RP. Since this RP follows a just-in-time provisioning model, when the RP sees the subscriber’s federated identifier for the first time, the RP creates an RP subscriber account for that federated identifier and calls the identity API to populate the RP subscriber account with the subscriber’s attributes. For future authentications with this subscriber, the RP can decide if its cache of attributes is reasonably recent enough or if it should be refreshed by calling the identity API.</p>
<h2 id="multilateral-federation-network" data-section="10">
  
  
    Multilateral Federation Network <a href="#multilateral-federation-network" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Agencies A, B, and C each have an IdP running OpenID Connect for their subscriber accounts. All three agencies join a multilateral federation run by an independent agency set up to provide inter-agency connections. The federation authority independently verifies that each IdP represents the agency in question. The federation authority publishes the discovery records of the IdPs for all agencies that are part of the multilateral federation. This publication allows RPs within the federation to discover which IdP is to be used to access accounts for a given agency under the rules of the federation agreement.</p>

<p>RPs X and Y wish to allow logins from agencies A, B, and C, and the RPs declare their intent and a list of required attributes to the federation authority. The federation authority assesses both RP requests and adds them to the multilateral federation’s trust agreement. This allows both RPs to register at each of the three separate IdPs as needed for each agency.</p>

<p>Both RPs interface directly with each of the three IdPs and not through a federation proxy. When a new IdP or RP is added to the multilateral federation agreement, the existing IdPs and RPs are notified of the new component and its parameters.</p>

<p>The IdPs and RPs establish a shared signaling channel under the auspices of the federation authority. This allows any IdP and any RP to report suspicious or malicious behavior that involves a specific account to the rest of the members under the federation authority.</p>
<h2 id="issuance-of-a-credential-to-a-digital-wallet" data-section="10">
  
  
    Issuance of a Credential to a Digital Wallet <a href="#issuance-of-a-credential-to-a-digital-wallet" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>Agency B makes its subscriber accounts available for federation through the use of digital wallet technology. The agency’s agreement for issuing credentials into wallets is facilitated by a federation authority that is set up to manage digital wallets across the federal government. The federation authority establishes the identity of the CSP for each agency under the multilateral agreement, and it ensures that only the CSP for Agency B can onboard subscriber-controlled wallets for Agency B within the multilateral trust agreement.</p>

<p>A subscriber has a digital wallet running on their device that they want to use with their subscriber account from Agency B. Within these guidelines, the digital subscriber-controlled wallet needs to be onboarded by the CSP before it can act as an IdP. To begin this process, the subscriber directs their digital wallet software to Agency B’s CSP. The subscriber uses a biometric factor to activate their digital wallet, and the digital wallet makes an onboarding request to the CSP for the subscriber account. This onboarding request includes proof of a key held by the digital wallet. The CSP verifies the wallet’s proof and processes any additional attestations from the wallet device.</p>

<p>The subscriber authenticates to the CSP during the onboarding process. The CSP prompts the subscriber with the terms of the trust agreement from the federation authority, and asks the subscriber to confirm that they wish to issue an identity to the digital wallet in question. The subscriber is informed of the sets of attributes that are made available to the wallet.</p>

<p>The CSP creates an attribute bundle that includes the subscriber’s attributes as well as a reference to the digital wallet’s key. The CSP signs this attribute bundle with its own key and returns the bundle to the digital wallet.</p>

<p>When the subscriber needs to authenticate to an RP, the RP sends a query to the subscriber’s wallet for a credential that fits the RP’s needs. The RP has a trust agreement with the same federation authority, agreeing to trust identities issued under the multilateral trust agreement’s rules. The digital wallet, acting as an IdP, identifies that the RP’s request can be fulfilled by the attribute bundle issued from Agency B’s CSP. The digital wallet prompts the subscriber to activate the IdP function of the digital wallet software using a local biometric factor. The digital wallet prompts the subscriber to confirm that they want to present the requested attributes to the RP in question. When the subscriber accepts, the IdP function of the digital wallet creates an assertion for the RP that is signed with the digital wallet’s keys. The assertion includes the attribute bundle from the CSP, which itself is covered by the signature from the IdP function. The IdP delivers the assertion to the RP.</p>

<p>The RP receives the signed assertion and validates the signature of the attribute bundle from the CSP, using the CSP’s keys identified by the federation authority. The RP then validates the signature of the assertion using the key identified in the assertion. When these checks pass successfully, the RP creates an RP subscriber account to represent the subscriber at the RP, based on the information in the assertion.</p>
<h2 id="enterprise-sso" data-section="10">
  
  
    Enterprise Application Single-Sign-On <a href="#enterprise-sso" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>For enterprise applications, it is a common pattern for the organization to make the application available to all potential subscribers within the agency, through the use of an allowlist and pre-provisioned accounts.</p>

<p>In this scenario, Agency E establishes a pairwise agreement with an RP to provide an enterprise-class service to all employees of Agency E through the agency’s OpenID Connect IdP. As part of this trust agreement, the IdP allows access to a SCIM-based provisioning API for the RP. The IdP creates a federated identifier for each subscriber account and uses the provisioning API to push the federated identifiers and their associated attributes to the RP. In this way, the RP can pre-provision an RP subscriber account for every subscriber in the IdP’s system, allowing the RP to offer functions like access rights, data sharing, and messaging to all accounts on the system, whether or not a specific account has logged in to the RP yet.</p>

<p>Under the terms of the trust agreement, the RP is placed on an allowlist with the IdP. The allowlist entry states that:</p>

<ul>
  <li>The subscriber has an active subscriber account at Agency E</li>
  <li>The subscriber has authenticated with the IdP at AAL2 or greater</li>
  <li>The RP is allowed to request only the federated identifier and basic authentication event information, since all other necessary attributes will be available through the provisioning API</li>
  <li>The federation transaction is at FAL2</li>
</ul>

<p>Consequently, subscribers are not prompted for consent at runtime because the agency consented to use the service on behalf of all accounts at the time the RP was onboarded. This gives subscribers a seamless single sign-on experience, even though a federation protocol is being used across security domain boundaries. Since the IdP does not use any runtime decisions, any deviation from the allowlist parameters causes the federation transaction to fail.</p>

<p>The RP subscriber accounts are synchronized using the provisioning API. When a new subscriber account is created, modified, or deleted at the IdP, the IdP updates the status of the RP subscriber account using the provisioning API. This allows the RP to always have an up-to-date status for each subscriber account. For example, when the subscriber account is terminated at the IdP, the provisioning API signals to the RP that the corresponding RP subscriber account is to be terminated immediately. The RP removes all locally cached attributes for the account in question, except for the identifiers and references in audit and access logs.</p>
<h2 id="fal3-smart-card" data-section="10">
  
  
    FAL3 With a Smart Card <a href="#fal3-smart-card" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A subscriber has a cryptographic authenticator on a smart card. The certificate on this smart card can be verified independently by both the IdP and RP thanks to the use of a shared PKI system stipulated by the trust agreement. This type of authenticator can be used in a holder-of-key assertion at FAL3.</p>

<p>The subscriber starts the federation process and authenticates to the IdP using their authenticator. The IdP creates an assertion that includes a flag indicating that the assertion is intended for use at FAL3. The assertion also contains the certificate common name (CN) and thumbprint of the certificate to be used as a bound authenticator.</p>

<p>When the RP receives the assertion, the RP processes the assertion as usual and sees the FAL3 flag and the certificate attributes. The subscriber authenticates to the RP using their authenticator, and the RP verifies that the certificate presented by the subscriber matches the certificate in the assertion from the IdP. When these match, the RP creates a secure session with the subscriber at FAL3.</p>
<h2 id="fal3-nonpki" data-section="10">
  
  
    FAL3 With a non-PKI Authenticator <a href="#fal3-nonpki" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A subscriber has a hardware cryptographic authenticator that speaks the WebAuthn protocol. This authenticator is not tied to any PKI system, and in fact the authenticator device presents completely different and unlinked keys to both the IdP and RP during its normal authentication process. This kind of authenticator can still be used at FAL3 if the RP manages the bound authenticator.</p>

<p>In this example, when the subscriber uses this authentication device at the IdP, it presents proof of Key1. When the subscriber uses the same device at the RP, it presents proof of Key2. These are logically two separate authenticators, but from the perspective of the subscriber, they are using the same device in multiple places.</p>

<p>To start a federation transaction, the subscriber authenticates to the IdP using Key1. The IdP then creates an assertion that is flagged as FAL3. Since the IdP has no visibility into the existence and use of Key2, the assertion says that the subscriber is using a bound authenticator to reach FAL3. When the RP processes this assertion, the RP checks the RP subscriber account associated with the federated identifier in the assertion to find an RP bound authenticator for that account using Key2. The RP prompts the subscriber to authenticate using Key2. When that key is verified, the RP creates a secure session with the subscriber at FAL3.</p>
<h2 id="fal3-with-referred-token-binding" data-section="10">
  
  
    FAL3 With Referred Token Binding <a href="#fal3-with-referred-token-binding" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A subscriber authenticates to their IdP using a certificate that is trusted by the IdP but not known to the RP, since the IdP and RP are not in a shared PKI environment. However, the IdP and RP support the referred token binding extension of TLS. When the subscriber presents their certificate to the IdP, the IdP creates an assertion with the CN and thumbprint of the subscriber’s certificate. Along with the assertion or assertion reference, the IdP returns token binding headers. When these headers are presented to the RP, the RP can use them to associate the contents of the assertion with the subscriber’s bound authenticator. The RP still has to verify the certificate, but the token binding allows the RP to do so without having to separately trust the certificate chain of the authenticator’s certificate.</p>
<h2 id="ephemeral-federated-attribute-exchange" data-section="10">
  
  
    Ephemeral Federated Attribute Exchange <a href="#ephemeral-federated-attribute-exchange" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>An RP needs to access a specific attribute for a subscriber, such as proof of age or affiliation with a known entity like a specific agency, without needing to know the identity of the subscriber. The RP requests only the derived attribute values that it needs in order to process its transaction, in this case a simple boolean of whether the subscriber is of age or is affiliated with the entity. The federation process creates an authenticated session between the RP and the subscriber. However, the RP uses an ephemeral provisioning mechanism, retaining only a record of the transaction and no further identifying attributes of the subscriber. The IdP provides a pairwise pseudonymous identifier to the RP. Since the IdP knows of the ephemeral nature of the RP subscriber account, the IdP can provide a distinct PPI to the RP on each request without affecting the subscriber’s usage of the RP. The IdP prompts the subscriber at runtime to release the derived attributes, preventing the RP from silently polling subscriber accounts against changes in information over time.</p>
<h2 id="authorized-party-example" data-section="10">
  
  
    Multiple Different Authorized Parties and Trust Agreements <a href="#authorized-party-example" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>As a subscriber uses services at multiple RPs, different trust agreements can come into play, and those agreements can have different requirements and experiences. In this scenario, the subscriber has an account through a single IdP which they use at three different RPs, each with a different kind of trust agreement and different requirements for consent and notification.</p>

<dl>
  <dt>Organizational Authorized Party:</dt>
  <dd>An apriori trust agreement is established for an agency connecting to an enterprise service (the RP) to be made available to all subscribers at the agency. The authorized party for this trust agreement is the agency, and the IdP is configured with an allowlist entry for the RP with the set of common attributes requested by the RP for its use. When a subscriber logs in to the enterprise service, they are not prompted with any runtime decisions regarding the service, since the trust agreement establishes this connection as trusted. The details of this trust agreement are available to the subscriber from the IdP, including the list of attributes that are released to the RP and for what purpose.</dd>
  <dt>Individual Authorized Party:</dt>
  <dd>A separate a priori trust agreement is established by the agency for another service (a different RP), and this service is made available to all subscribers at the same agency. This trust agreement stipulates that the subscriber is the authorized party for release of attribute information to the RP. When logging in to the service, each subscriber is prompted for their consent to release their attributes to the RP. The prompt includes the context for the subscriber to make an appropriate security decision, including a link to the details of the trust agreement and a list of attributes being released and their purpose of use. The IdP allows the subscriber to save this consent decision so that when this subscriber logs in to this same RP in the future, the subscriber is not prompted again for their consent so long as the trust agreement and the request from the RP have not changed.</dd>
  <dt>Subscriber-driven Service Access:</dt>
  <dd>A subscriber-driven trust agreement is established when the subscriber goes to access an RP that is otherwise unknown by their IdP. The RP informs the subscriber about the uses of all attributes being requested from the IdP, and the IdP prompts the subscriber for consent to release their attributes to the RP. The IdP also warns the subscriber that the RP is unknown to the agency, and provides the subscriber with information received by the RP to help the subscriber make a secure decision.</dd>
</dl>

<p>All of these scenarios are involve the same subscriber account.</p>
<h2 id="shared-ppi" data-section="10">
  
  
    Shared Pairwise Pseudonymous Identifiers for Multiple RPs <a href="#shared-ppi" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A group of three applications is deployed in support of a specific mission, giving collaboration, document storage, and calendar capabilities. Due to the nature of the separate applications, they are deployed as separate RPs, but all are bound to the same IdP using a common trust agreement. The trust agreement stipulates that the three RPs are to be issued a shared PPI, so that the applications can coordinate individual subscriber accounts with each other but not with any other applications in the deployed environment. The IdP uses an algorithm to generate a shared PPI that incorporates a randomized identifier for the set of applications as well as a unique identifier for each subscriber accounts. As a result, all three RPs get the same PPI for each subscriber, but no other RP is issued that same identifier.</p>
<h2 id="rp-auth" data-section="10">
  
  
    RP Authentication to an IdP <a href="#rp-auth" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>

<p>A federation transaction typically takes place over multiple network calls. Throughout this process, it is important for the IdP and RP to know that they are talking to the same party that they were in a previous step, and ultimately to the party that they expect to be in the transaction with in the first place.</p>

<p>Different techniques exist that provide different degrees of assurance, depending on the federation protocol in use and the needs of the system. For example, the Authorization Code Flow of <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> allows the RP to register a shared secret or private key with the IdP prior to the transaction, allowing the IdP to strongly authenticate the RP’s request in the back channel to retrieve the assertion. In addition, the Proof Key for Code Exchange protocol in <a href="/800-63-4/sp800-63c/references/#ref-RFC7636">[RFC7636]</a> allows the RP to dynamically create an unguessable secret that is transmitted in hashed form in the front channel and then transmitted in full in the back channel along with the assertion reference. These techniques can of course be combined for even greater assurance.</p>

<p>Federation authorities can also facilitate the authentication process. If the RP registers its public key and identifier with the federation authority, the IdP needs only to retrieve the appropriate keys from the federation authority instead of requiring the RP to register itself ahead of time.</p>

<p>Technical profiles of specific federation protocols are out of scope of these guidelines, but high security profiles such as <a href="/800-63-4/sp800-63c/references/#ref-FAPI">[FAPI]</a> provide extensive guidelines for implementers to deploy secure federation protocols.</p>

<h1 id="references">
  
  
    References <a href="#references" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This section is informative.</em></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-A-130" name="ref-A-130">[A-130]</a> Office of Management and Budget (2016) Managing Information as a Strategic Resource. (The White House, Washington, DC), OMB Circular A-130, July 28, 2016. Available at <a href="https://obamawhitehouse.archives.gov/sites/default/files/omb/assets/OMB/circulars/a130/a130revised.pdf">https://obamawhitehouse.archives.gov/sites/default/files/omb/assets/OMB/circulars/a130/a130revised.pdf</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-EO13985" name="ref-EO13985">[EO13985]</a> Biden J (2021) Advancing Racial Equity and Support for Underserved Communities Through the Federal Government. (The White House, Washington, DC), Executive Order 13985, January 25, 2021. <a href="https://www.federalregister.gov/documents/2021/01/25/2021-01753/advancing-racial-equity-and-support-for-underserved-communities-through-the-federal-government">https://www.federalregister.gov/documents/2021/01/25/2021-01753/advancing-racial-equity-and-support-for-underserved-communities-through-the-federal-government</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-FAPI" name="ref-FAPI">[FAPI]</a> Fett D, Bradley J, Heenan J (2024), <em>FAPI 2.0 Security Profile (draft)</em>. (OpenID Foundation, San Ramon, CA). <a href="https://openid.bitbucket.io/fapi/fapi-2_0-security-profile.html">https://openid.bitbucket.io/fapi/fapi-2_0-security-profile.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-FEDRAMP" name="ref-FEDRAMP">[FEDRAMP]</a> General Services Administration (2022), <em>How to Become FedRAMP Authorized</em>. Available at <a href="https://www.fedramp.gov/">https://www.fedramp.gov/</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-FIPS140" name="ref-FIPS140">[FIPS140]</a> National Institute of Standards and Technology (2019) Security Requirements for Cryptographic Modules. (U.S. Department of Commerce, Washington, DC), Federal Information Processing Standards Publication (FIPS) 140-3. <a href="https://doi.org/10.6028/NIST.FIPS.140-3">https://doi.org/10.6028/NIST.FIPS.140-3</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-ISOIEC9241" name="ref-ISOIEC9241">[ISO/IEC9241-11]</a> International Standards Organization (2018) <em>ISO/IEC 9241-11 Ergonomics of human-system interaction – Part 11: Usability: Definitions and concepts</em> (ISO, Geneva, Switzerland). Available at <a href="https://www.iso.org/standard/63500.html">https://www.iso.org/standard/63500.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-ISOIEC18013" name="ref-ISOIEC18013">[ISO/IEC18013-5]</a> International Standards Organization (2021) <em>ISO/IEC 18013-5 Personal identification — ISO-compliant driving licence — Part 5: Mobile driving licence (mDL) application</em> (ISO, Geneva, Switzerland). Available at <a href="https://www.iso.org/obp/ui/en/#iso:std:iso-iec:18013:-5:ed-1:v1:en">https://www.iso.org/obp/ui/en/#iso:std:iso-iec:18013:-5:ed-1:v1:en</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062" name="ref-NISTIR8062">[NISTIR8062]</a> Brooks S, Garcia M, Lefkovitz N, Lightman S, Nadeau E (2017) An Introduction to Privacy Engineering and Risk Management in Federal Systems. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Interagency or Internal Report (IR) 8062, January 2017. <a href="https://doi.org/10.6028/NIST.IR.8062">https://doi.org/10.6028/NIST.IR.8062</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-nistir8112" name="ref-nistir8112">[NISTIR8112]</a> Grassi PA, Lefkovitz NB, Nadeau EM, Galluzzo RJ, Dinh AT (2018) Attribute Metadata: A proposed Schema for Evaluating Federated Attributes. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Interagency or Internal Report (IR) 8112. <a href="https://pages.nist.gov/NISTIR-8112/NISTIR-8112.html">https://pages.nist.gov/NISTIR-8112/NISTIR-8112.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-OIDC" name="ref-OIDC">[OIDC]</a> Sakimura N, Bradley J, Jones M, de Medeiros B, Mortimore C (2014) OpenID Connect Core 1.0 incorporating errata set 1 (OpenID Foundation, San Ramon, CA). <a href="https://openid.net/specs/openid-connect-core-1_0.html">https://openid.net/specs/openid-connect-core-1_0.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-OIDC-basic" name="ref-OIDC-basic">[OIDC-Basic]</a>
Sakimura N, Bradley J, Jones M, de Medeiros B, Mortimore C (2022) OpenID Connect Basic Client Implementer’s Guide 1.0 (OpenID Foundation, San Ramon, CA). <a href="https://openid.net/specs/openid-connect-basic-1_0.html">https://openid.net/specs/openid-connect-basic-1_0.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-OIDC-implicit" name="ref-OIDC-implicit">[OIDC-Implicit]</a>
Sakimura N, Bradley J, Jones M, de Medeiros B, Mortimore C (2022) OpenID Connect Implicit Client Implementer’s Guide 1.0 (OpenID Foundation, San Ramon, CA). <a href="https://openid.net/specs/openid-connect-implicit-1_0.html">https://openid.net/specs/openid-connect-implicit-1_0.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-OIDC-registration" name="ref-OIDC-registration">[OIDC-Registration]</a>
Sakimura N, Bradley J, Jones M (2023) OpenID Connect Dynamic Client Registration 1.0 incorporating errata set 2 (OpenID Foundation, San Ramon, CA). <a href="https://openid.net/specs/openid-connect-registration-1_0.html">https://openid.net/specs/openid-connect-registration-1_0.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-RFC5246" name="ref-RFC5246">[RFC5246]</a> Rescorla E, Dierks T (2008) The Transport Layer Security (TLS) Protocol Version 1.2. (Internet Engineering Task Force (IETF)), IETF Request for Comments (RFC) 5246. <a href="https://doi.org/10.17487/RFC5246">https://doi.org/10.17487/RFC5246</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-RFC5280" name="ref-RFC5280">[RFC5280]</a> Cooper D, Santesson S, Farrell S, Boeyen S, Housley R, Polk W (2008) Internet X.509 Public Key Infrastructure Certification and Certificate Revocation List (CRL) Profile. (Internet Engineering Task Force (IETF)), IETF Request for Comments (RFC) 5280. <a href="https://doi.org/10.17487/RFC5280">https://doi.org/10.17487/RFC5280</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-RFC7591" name="ref-RFC7591">[RFC7591]</a> Richer J, Jones M, Bradley J, Machulak M, Hunt P (2015) OAuth 2.0 Dynamic Client Registration Protocol. (Internet Engineering Task Force, Reston, VA), RFC 7591. <a href="https://doi.org/10.17487/RFC7591">https://doi.org/10.17487/RFC7591</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-RFC7636" name="ref-RFC7636">[RFC7636]</a> Sakimura N, Bradley J, Agarwal N (2015) Proof Key For Code Exchange by OAuth Public Clients. (Internet Engineering Task Force, Reston, VA), RFC 7636. <a href="https://doi.org/10.17487/RFC7636">https://doi.org/10.17487/RFC7636</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-rfc9325" name="ref-rfc9325">[RFC9325]</a> Sheffer Y, Saint-Andre P, Fossati T (2022) Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS). (Internet Engineering Task Force (IETF)), IETF Request for Comments (RFC) 9325. <a href="https://doi.org/10.17487/RFC9325">https://doi.org/10.17487/RFC9325</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SAML" name="ref-SAML">[SAML]</a> Ragouzis N, Hughes J, Philpott R, Maler E, Madsen P, Scavo T (2008) Security Assertion Markup Language (SAML) V2.0 Technical Overview. (Organization for Advancement of Structured Information Standards (OASIS) Open, Woburn, MA), SAML 2.0. <a href="https://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0.html">https://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0.html</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SAML-bindings" name="ref-SAML-bindings">[SAML-Bindings]</a> Cantor S, Frederick H, Kemp J, Philpott R, Maler M (2005) Bindings for the OASIS Security Assertion Markup Language (SAML) V2.0. (Organization for Advancement of Structured Information Standards (OASIS) Open, Woburn, MA), SAML 2.0. <a href="https://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf">https://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SAML-WebSSO" name="ref-SAML-WebSSO">[SAML-WebSSO]</a> Hughes J, Cantor S, Hodges J, Hirsch F, Mishra P, Philpott R, Maler E (2005) Profiles for the OASIS Security Assertion Markup Language (SAML) V2.0. (Organization for Advancement of Structured Information Standards (OASIS) Open, Woburn, MA), SAML Profiles 2.0. <a href="https://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf">https://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-Section508" name="ref-Section508">[Section508]</a> General Services Administration (2022) <em>IT Accessibility Laws and Policies</em>. Available at <a href="https://www.section508.gov/manage/laws-and-policies/">https://www.section508.gov/manage/laws-and-policies/</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SD-JWT" name="ref-SD-JWT">[SD-JWT]</a> Fett D, Yasuda K, Campbell B (2024) Selective Disclosure for JWTs (SD-JWT). (Internet Engineering Task Force, Reston, VA). Active Internet Draft. <a href="https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt/">https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt/</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-52" name="ref-SP800-52">[SP800-52]</a> McKay K, Cooper D (2019) Guidelines for the Selection, Configuration, and Use of Transport Layer Security (TLS) Implementations. (National Institute of Standards and Technology), NIST Special Publication (SP) 800-52 Rev. 2. <a href="https://doi.org/10.6028/NIST.SP.800-52r2">https://doi.org/10.6028/NIST.SP.800-52r2</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-53" name="ref-SP800-53">[SP800-53]</a> Joint Task Force (2020) Security and Privacy Controls for Information Systems and Organizations. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-53 Rev. 5, Includes updates as of December 10, 2020. <a href="https://doi.org/10.6028/NIST.SP.800-53r5">https://doi.org/10.6028/NIST.SP.800-53r5</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-63" name="ref-SP800-63">[SP800-63]</a> Temoshok D, Proud-Madruga D, Choong YY, Galluzzo R, Gupta S, LaSalle C, Lefkovitz N, Regenscheid A (2024) Digital Identity Guidelines. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-63-4 2pd. <a href="https://doi.org/10.6028/NIST.SP.800-63-4.2pd">https://doi.org/10.6028/NIST.SP.800-63-4.2pd</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-63A" name="ref-SP800-63A">[SP800-63A]</a> Temoshok D, Abruzzi C, Choong YY, Fenton JL, Galluzzo R, LaSalle C, Lefkovitz N, Regenscheid A (2024) Digital Identity Guidelines: Identity Proofing and Enrollment. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-63A-4 2pd. <a href="https://doi.org/10.6028/NIST.SP.800-63a-4.2pd">https://doi.org/10.6028/NIST.SP.800-63a-4.2pd</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-63B" name="ref-SP800-63B">[SP800-63B]</a> Temoshok D, Fenton JL, Choong YY, Lefkovitz N, Regenscheid A, Galluzzo R, Richer JP (2024) Digital Identity Guidelines: Authentication and Authenticator Management. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-63B-4 ipd. <a href="https://doi.org/10.6028/NIST.SP.800-63b-4.2pd">https://doi.org/10.6028/NIST.SP.800-63b-4.2pd</a></p>

<p><a href="/800-63-4/sp800-63c/references/#ref-SP800-131A" name="ref-SP800-131A">[SP800-131A]</a> Barker E,
Roginsky A (2019) Transitioning the Use of Cryptographic Algorithms and Key Lengths. (National Institute of Standards and Technology, Gaithersburg, MD), NIST Special Publication (SP) 800-131Ar2. <a href="https://doi.org/10.6028/NIST.SP.800-131Ar2">https://doi.org/10.6028/NIST.SP.800-131Ar2</a></p>

<h1 id="abbr" data-section="A">
  
  
    List of Symbols, Abbreviations, and Acronyms <a href="#abbr" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<dl>
  <dt>1:1 Comparison</dt>
  <dd>One-to-One Comparison</dd>
  <dt>ABAC</dt>
  <dd>Attribute-Based Access Control</dd>
  <dt>AAL</dt>
  <dd>Authentication Assurance Level</dd>
  <dt>CAPTCHA</dt>
  <dd>Completely Automated Public Turing test to tell Computer and Humans Apart</dd>
  <dt>CSP</dt>
  <dd>Credential Service Provider</dd>
  <dt>CSRF</dt>
  <dd>Cross-Site Request Forgery</dd>
  <dt>DNS</dt>
  <dd>Domain Name System</dd>
  <dt>FAL</dt>
  <dd>Federation Assurance Level</dd>
  <dt>FEDRAMP</dt>
  <dd>Federal Risk and Authorization Management Program</dd>
  <dt>IAL</dt>
  <dd>Identity Assurance Level</dd>
  <dt>IdP</dt>
  <dd>Identity Provider</dd>
  <dt>JOSE</dt>
  <dd>JSON Object Signing and Encryption</dd>
  <dt>JWT</dt>
  <dd>JSON Web Token</dd>
  <dt>MAC</dt>
  <dd>Message Authentication Code</dd>
  <dt>PIA</dt>
  <dd>Privacy Impact Assessment</dd>
  <dt>PII</dt>
  <dd>Personally Identifiable Information</dd>
  <dt>PIN</dt>
  <dd>Personal Identification Number</dd>
  <dt>PKI</dt>
  <dd>Public Key Infrastructure</dd>
  <dt>PPI</dt>
  <dd>Pairwise Pseudonymous Identifier</dd>
  <dt>RMF</dt>
  <dd>Risk Management Framework</dd>
  <dt>RP</dt>
  <dd>Relying Party</dd>
  <dt>SAML</dt>
  <dd>Security Assertion Markup Language</dd>
  <dt>SAOP</dt>
  <dd>Senior Agency Official for Privacy</dd>
  <dt>SCIM</dt>
  <dd>System for Cross-domain Identity Management</dd>
  <dt>SORN</dt>
  <dd>System of Records Notice</dd>
  <dt>TLS</dt>
  <dd>Transport Layer Security</dd>
  <dt>XSS</dt>
  <dd>Cross-Site Scripting</dd>
</dl>

<h1 id="def-and-acr" data-section="B">
  
  
    Glossary <a href="#def-and-acr" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p>A wide variety of terms are used in the realm of digital identity. While many definitions are consistent with earlier versions of SP 800-63, some have changed in this revision. Many of these terms lack a single, consistent definition, warranting careful attention to how the terms are defined here.</p>

<dl>
  <dt>account linking</dt>
  <dd>The association of multiple <em>federated identifiers</em> with a single <em>RP subscriber account</em>, or the management of those associations.</dd>
  <dt>account resolution</dt>
  <dd>The association of an <em>RP subscriber account</em> with information already held by the <em>RP</em> prior to the <em>federation transaction</em> and outside of a <em>trust agreement</em>.</dd>
  <dt>activation factor</dt>
  <dd>An additional <em>authentication factor</em> that is used to enable successful <em>authentication</em> with a <em>multi-factor authenticator</em>.</dd>
  <dt>allowlist</dt>
  <dd>A documented list of specific elements that are allowed, per policy decision. In <em>federation</em> contexts, this is most commonly used to refer to the list of <em>RPs</em> allowed to connect to an <em>IdP</em> without subscriber intervention. This concept has historically been known as a <em>whitelist</em>.</dd>
  <dt>approved cryptography</dt>
  <dd>An encryption algorithm, <em>hash function</em>, random bit generator, or similar technique that is <em>Federal Information Processing Standard</em> (FIPS)-approved or NIST-recommended. Approved algorithms and techniques are either specified or adopted in a FIPS or NIST recommendation.</dd>
  <dt>assertion</dt>
  <dd>A statement from an <em>IdP</em> to an <em>RP</em> that contains information about an authentication event for a subscriber. Assertions can also contain identity <em>attributes</em> for the subscriber.</dd>
  <dt>assertion reference</dt>
  <dd>A data object, created in conjunction with an <em>assertion</em>, that is used by the <em>RP</em> to retrieve an assertion over an <em>authenticated</em> protected channel.</dd>
  <dt>assertion presentation</dt>
  <dd>The method by which an <em>assertion</em> is transmitted to the <em>RP</em>.</dd>
  <dt>asymmetric keys</dt>
  <dd>Two related keys, comprised of a <em>public key</em> and a <em>private key</em>, that are used to perform complementary operations such as encryption and decryption or signature <em>verification</em> and generation.</dd>
  <dt>attribute</dt>
  <dd>A quality or characteristic ascribed to someone or something. An identity attribute is an attribute about the identity of a subscriber.</dd>
  <dt>attribute bundle</dt>
  <dd>A package  of <em>attribute values</em> and <em>derived attribute values</em> from a <em>CSP</em>. The package has necessary cryptographic protection to allow <em>validation</em> of the bundle independent from interaction with the CSP or <em>IdP</em>. Attribute bundles are often used with subscriber-controlled wallets.</dd>
  <dt>attribute provider</dt>
  <dd>The provider of an <em>identity API</em> that provides access to a subscriber’s attributes without necessarily asserting that the subscriber is present to the <em>RP</em>.</dd>
  <dt>attribute value</dt>
  <dd>A complete statement that asserts an identity attribute of a subscriber, independent of format. For example, for the <em>attribute</em> “birthday,” a value could be “12/1/1980” or “December 1, 1980.”</dd>
  <dt>audience restriction</dt>
  <dd>The restriction of a message to a specific target audience to prevent a receiver from unknowingly <em>processing</em> a message intended for another recipient. In <em>federation protocols</em>, <em>assertions</em> are audience <em>restricted</em> to specific <em>RPs</em> to prevent an RP from accepting an assertion generated for a different RP.</dd>
  <dt>authenticate</dt>
  <dd>See <em>authentication</em>.</dd>
  <dt>authenticated protected channel</dt>
  <dd>An encrypted communication channel that uses <em>approved cryptography</em> where the connection initiator (client) has authenticated the recipient (server). Authenticated protected channels are encrypted to provide confidentiality and protection against active intermediaries and are frequently used in the user <em>authentication</em> process. <em>Transport Layer Security</em> (TLS) and Datagram Transport Layer Security (DTLS) <a href="/800-63-4/sp800-63c/references/#ref-rfc9325">[RFC9325]</a> are examples of authenticated protected channels in which the certificate presented by the recipient is verified by the initiator. Unless otherwise specified, authenticated protected channels do not require the server to authenticate the client. Authentication of the server is often accomplished through a certificate chain that leads to a trusted root rather than individually with each server.</dd>
  <dt>authenticated session</dt>
  <dd>See <em>protected session</em>.</dd>
  <dt>authentication</dt>
  <dd>The process by which a <em>claimant</em> proves possession and control of one or more <em>authenticators</em> bound to a <em>subscriber account</em> to demonstrate that they are the subscriber associated with that account.</dd>
  <dt>Authentication Assurance Level (AAL)</dt>
  <dd>A category describing the strength of the authentication process.</dd>
  <dt>authenticator</dt>
  <dd>Something that the subscriber possesses and controls (e.g., a <em>cryptographic module</em> or <em>password</em>) and that is used to <em>authenticate</em> a <em>claimant’s</em> identity. See <em>authenticator type</em> and <em>multi-factor authenticator</em>.</dd>
  <dt>authenticator binding</dt>
  <dd>The establishment of an association between a specific <em>authenticator</em> and a <em>subscriber account</em> that allows the <em>authenticator</em> to be used to <em>authenticate</em> for that subscriber account, possibly in conjunction with other authenticators.</dd>
  <dt>authorize</dt>
  <dd>A decision to grant access, typically automated by evaluating a <em>subject</em>’s <em>attributes</em>.</dd>
  <dt>authorized party</dt>
  <dd>In <em>federation</em>, the organization, person, or entity that is responsible for making decisions regarding the release of information within the <em>federation transaction</em>, most notably subscriber <em>attributes</em>. This is often the subscriber (when runtime decisions are used) or the party operating the <em>IdP</em> (when <em>allowlists</em> are used).</dd>
  <dt>back-channel communication</dt>
  <dd>Communication between two systems that relies on a direct connection without using redirects through an intermediary such as a browser.</dd>
  <dt>bearer assertion</dt>
  <dd>An <em>assertion</em> that can be presented on its own as proof of the identity of the presenter.</dd>
  <dt>blocklist</dt>
  <dd>A documented list of specific elements that are blocked, per policy decision. This concept has historically been known as a <em>blacklist</em>.</dd>
  <dt>challenge-response protocol</dt>
  <dd>An <em>authentication protocol</em> in which the <em>verifier</em> sends the <em>claimant</em> a challenge (e.g., a random value or <em>nonce</em>) that the claimant combines with a secret (e.g., by hashing the challenge and a <em>shared secret</em> together or by applying a <em>private-key</em> operation to the challenge) to generate a response that is sent to the verifier. The verifier can independently verify the response generated by the claimant (e.g., by re-computing the hash of the challenge and the shared secret and comparing to the response or performing a public-key operation on the response) and establish that the claimant possesses and controls the secret.</dd>
  <dt>core attributes</dt>
  <dd>The set of identity <em>attributes</em> that the <em>CSP</em> has determined and documented to be required for <em>identity proofing</em>.</dd>
  <dt>credential service provider (CSP)</dt>
  <dd>A trusted entity whose functions include <em>identity proofing</em> <em>applicants</em> to the identity service and registering <em>authenticators</em> to <em>subscriber accounts</em>. A CSP may be an independent third party.</dd>
  <dt>cross-site request forgery (CSRF)</dt>
  <dd>An attack in which a subscriber who is currently <em>authenticated</em> to an <em>RP</em> and connected through a secure session browses an attacker’s website, causing the subscriber to unknowingly invoke unwanted actions at the RP.

    <p>For example, if a bank website is vulnerable to a CSRF attack, it may be possible for a subscriber to unintentionally <em>authorize</em> a large money transfer by clicking on a malicious link in an email while a connection to the bank is open in another browser window.</p>
  </dd>
  <dt>cross-site scripting (XSS)</dt>
  <dd>A vulnerability that allows attackers to inject malicious code into an otherwise benign website. These scripts acquire the permissions of scripts generated by the target website to compromise the confidentiality and integrity of data transfers between the website and clients. Websites are vulnerable if they display user-supplied data from requests or forms without sanitizing the data so that it is not executable.</dd>
  <dt>derived attribute value</dt>
  <dd>A statement that asserts a limited identity <em>attribute</em> of a subscriber without containing the attribute value from which it is derived, independent of format. For example, instead of requesting the attribute “birthday,” a derived value could be “older than 18”. Instead of requesting the attribute for “physical address,” a derived value could be “currently residing in this district.” Previous versions of these guidelines referred to this construct as an “attribute reference.”</dd>
  <dt>digital identity</dt>
  <dd>An <em>attribute</em> or set of attributes that uniquely describes a <em>subject</em> within a given context.</dd>
  <dt>digital signature</dt>
  <dd>An <em>asymmetric key</em> operation in which the <em>private key</em> is used to digitally sign data and the <em>public key</em> is used to verify the signature. Digital signatures provide <em>authenticity</em> protection, integrity protection, and <em>non-repudiation</em> support but not confidentiality or <em>replay attack</em> protection.</dd>
  <dt>disassociability</dt>
  <dd>Enabling the <em>processing</em> of PII or events without association to individuals or devices beyond the operational requirements of the system. <a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062">[NISTIR8062]</a></dd>
  <dt>entropy</dt>
  <dd>The amount of uncertainty that an attacker faces to determine the value of a secret. Entropy is usually stated in bits. A value with <em>n</em> bits of entropy has the same degree of uncertainty as a uniformly distributed <em>n</em>-bit random value.</dd>
  <dt>equity</dt>
  <dd>The consistent and systematic fair, just, and impartial treatment of all individuals, including individuals who belong to underserved communities that have been denied such treatment, such as Black, Latino, and Indigenous and Native American persons, Asian Americans and Pacific Islanders, and other persons of color; members of religious minorities; lesbian, gay, bisexual, transgender, and queer (LGBTQ+) persons; persons with disabilities; persons who live in rural areas; and persons otherwise adversely affected by persistent poverty or inequality. <a href="/800-63-4/sp800-63c/references/#ref-EO13985">[EO13985]</a></dd>
  <dt>Federal Information Processing Standard (FIPS)</dt>
  <dd>Under the Information Technology Management Reform Act (Public Law 104-106), the Secretary of Commerce approves the standards and guidelines that the National Institute of Standards and Technology (NIST) develops for federal computer systems. NIST issues these standards and guidelines as Federal Information Processing Standards (FIPS) for government-wide use. NIST develops FIPS when there are compelling federal government requirements, such as for security and interoperability, and there are no acceptable industry standards or solutions. See background information for more details.

    <p>FIPS documents are available online on the FIPS home page: <a href="https://www.nist.gov/itl/fips.cfm">https://www.nist.gov/itl/fips.cfm</a></p>
  </dd>
  <dt>federated identifier</dt>
  <dd>The combination of a <em>subject identifier</em> within an <em>assertion</em> and an <em>identifier</em> for the <em>IdP</em> that issued that assertion. When combined, these pieces of information uniquely identify the <em>subscriber</em> in the context of a <em>federation transaction</em>.</dd>
  <dt>federation</dt>
  <dd>A process that allows for the conveyance of identity and authentication information across a set of <em>networked</em> systems.</dd>
  <dt>Federation Assurance Level (FAL)</dt>
  <dd>A category that describes the process used in a <em>federation transaction</em> to communicate authentication events and subscriber <em>attributes</em> to an <em>RP</em>.</dd>
  <dt>federation protocol</dt>
  <dd>A technical protocol that is used in a <em>federation transaction</em> between <em>networked</em> systems.</dd>
  <dt>federation proxy</dt>
  <dd>A component that acts as a logical <em>RP</em> to a set of <em>IdPs</em> and a logical IdP to a set of RPs, bridging the two systems with a single component. These are sometimes referred to as “brokers.”</dd>
  <dt>federation transaction</dt>
  <dd>A specific instance of <em>processing</em> an authentication using a <em>federation</em> process for a specific <em>subscriber</em> by conveying an <em>assertion</em> from an <em>IdP</em> to an <em>RP</em>.</dd>
  <dt>front-channel communication</dt>
  <dd>Communication between two systems that relies on passing messages through an intermediary, such as using redirects through the subscriber’s browser.</dd>
  <dt>hash function</dt>
  <dd>A function that maps a bit string of arbitrary length to a fixed-length bit string. Approved hash functions satisfy the following properties:

    <ol>
      <li>
        <p>One-way — It is computationally infeasible to find any input that maps to any pre-specified output.</p>
      </li>
      <li>
        <p>Collision-resistant — It is computationally infeasible to find any two distinct inputs that map to the same output.</p>
      </li>
    </ol>
  </dd>
  <dt>identifier</dt>
  <dd>A data object that is associated with a single, unique entity (e.g., individual, device, or <em>session</em>) within a given context and is never assigned to any other entity within that context.</dd>
  <dt>identity</dt>
  <dd>See <em>digital identity</em></dd>
  <dt>identity API</dt>
  <dd>A protected API accessed by an <em>RP</em> to access the <em>attributes</em> of a specific subscriber.</dd>
  <dt>Identity Assurance Level (IAL)</dt>
  <dd>A category that conveys the degree of confidence that the <em>subject</em>’s <em>claimed identity</em> is their real identity.</dd>
  <dt>identity provider (IdP)</dt>
  <dd>The party in a <em>federation transaction</em> that creates an <em>assertion</em> for the subscriber and transmits the assertion to the <em>RP</em>.</dd>
  <dt>injection attack</dt>
  <dd>An attack in which an attacker supplies untrusted input to a program. In the context of federation, the attacker presents an untrusted <em>assertion</em> or <em>assertion reference</em> to the <em>RP</em> in order to create an <em>authenticated</em> <em>session</em> with the RP.</dd>
  <dt>login</dt>
  <dd>Establishment of an <em>authenticated</em> <em>session</em> between a person and a system. Also known as <em>“sign in”</em>, <em>“log on”</em>, and <em>“sign on.”</em></dd>
  <dt>message authentication code (MAC)</dt>
  <dd>A cryptographic checksum on data that uses a <em>symmetric key</em> to detect both accidental and intentional modifications of the data. MACs provide <em>authenticity</em> and integrity protection, but not <em>non-repudiation</em> protection.</dd>
  <dt>network</dt>
  <dd>An open communications medium, typically the Internet, used to transport messages between the <em>claimant</em> and other parties. Unless otherwise stated, no assumptions are made about the network’s security; it is assumed to be open and subject to active (e.g., impersonation, <em>session</em> hijacking) and passive (e.g., eavesdropping) attacks at any point between the parties (e.g., claimant, <em>verifier</em>, <em>CSP</em>, <em>RP</em>).</dd>
  <dt>nonce</dt>
  <dd>A value used in security protocols that is never repeated with the same key. For example, nonces used as challenges in <em>challenge-response authentication protocols</em> must not be repeated until authentication keys are changed. Otherwise, there is a possibility of a <em>replay attack</em>. Using a nonce as a challenge is a different requirement than a random challenge, because a nonce is not necessarily unpredictable.</dd>
  <dt>pairwise pseudonymous identifier</dt>
  <dd>A <em>pseudonymous identifier</em> generated by an IdP for use at a specific <em>RP</em>.</dd>
  <dt>personal information</dt>
  <dd>See <em>personally identifiable information</em>.</dd>
  <dt>personally identifiable information (PII)</dt>
  <dd>Information that can be used to distinguish or trace an individual’s identity, either alone or when combined with other information that is linked or linkable to a specific individual. <a href="/800-63-4/sp800-63c/references/#ref-A-130">[A-130]</a></dd>
  <dt>predictability</dt>
  <dd>Enabling reliable assumptions by individuals, owners, and operators about PII and its <em>processing</em> by an information system. <a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062">[NISTIR8062]</a></dd>
  <dt>private key</dt>
  <dd>In <em>asymmetric key</em> cryptography, the private key (i.e., a secret key) is a mathematical key used to create <em>digital signatures</em> and, depending on the algorithm, decrypt messages or files that are encrypted with the corresponding <em>public key</em>. In <em>symmetric key</em> cryptography, the same private key is used for both encryption and decryption.</dd>
  <dt>processing</dt>
  <dd>Operation or set of operations performed upon PII that can include, but is not limited to, the collection, retention, logging, generation, transformation, use, disclosure, transfer, and disposal of PII. <a href="/800-63-4/sp800-63c/references/#ref-NISTIR8062">[NISTIR8062]</a></dd>
  <dt>protected session</dt>
  <dd>A <em>session</em> in which messages between two participants are encrypted and integrity is protected using a set of <em>shared secrets</em> called “session keys.”

    <p>A protected session is said to be <em>authenticated</em> if — during the session — one participant proves possession of one or more <em>authenticators</em> in addition to the session keys, and if the other party can verify the identity associated with the authenticators. If both participants are authenticated, the protected session is said to be <em>mutually authenticated</em>.</p>
  </dd>
  <dt>Provisioning API</dt>
  <dd>A protected API that allows an <em>RP</em> to access identity <em>attributes</em> for multiple subscribers for the purposes of provisioning and managing RP <em>subscriber accounts</em>.</dd>
  <dt>pseudonymous identifier</dt>
  <dd>A meaningless but unique <em>identifier</em> that does not allow the <em>RP</em> to infer anything regarding the subscriber but that does permit the RP to associate multiple interactions with a single subscriber.</dd>
  <dt>public key</dt>
  <dd>The public part of an <em>asymmetric key</em> pair that is used to verify signatures or encrypt data.</dd>
  <dt>public key certificate</dt>
  <dd>A digital document issued and digitally signed by the <em>private key</em> of a certificate authority that binds an <em>identifier</em> to a subscriber’s <em>public key</em>. The certificate indicates that the subscriber identified in the certificate has sole control of and access to the private key. See also <a href="/800-63-4/sp800-63c/references/#ref-RFC5280">[RFC5280]</a>.</dd>
  <dt>public key infrastructure (PKI)</dt>
  <dd>A set of policies, processes, server platforms, software, and workstations used to administer certificates and public-_private key_ pairs, including the ability to issue, maintain, and revoke <em>public key certificates</em>.</dd>
  <dt>reauthentication</dt>
  <dd>The process of confirming the subscriber’s continued presence and intent to be <em>authenticated</em> during an extended usage <em>session</em>.</dd>
  <dt>relying party (RP)</dt>
  <dd>An entity that relies upon a <em>verifier</em>’s <em>assertion</em> of a subscriber’s identity, typically to process a transaction or grant access to information or a system.</dd>
  <dt>replay attack</dt>
  <dd>An attack in which the attacker is able to replay previously captured messages (between a legitimate <em>claimant</em> and a <em>verifier</em>) to masquerade as that claimant to the verifier or vice versa.</dd>
  <dt>risk assessment</dt>
  <dd>The process of identifying, estimating, and prioritizing risks to organizational operations (i.e., mission, functions, image, or reputation), organizational assets, individuals, and other organizations that result from the operation of a system. A risk assessment is part of <em>risk management</em>, incorporates threat and vulnerability analyses, and considers mitigations provided by security <em>controls</em> that are planned or in-place. It is synonymous with “risk analysis.”</dd>
  <dt>risk management</dt>
  <dd>The program and supporting processes that manage information security risk to organizational operations (including mission, functions, image, reputation), organizational assets, individuals, and other organizations and includes (i) establishing the context for risk-related activities, (ii) assessing risk, (iii) responding to risk once determined, and (iv) monitoring risk over time.</dd>
  <dt>RP subscriber account</dt>
  <dd>An account established and managed by the <em>RP</em> in a federated system based on the RP’s view of the <em>subscriber account</em> from the <em>IdP</em>. An RP subscriber account is associated with one or more <em>federated identifiers</em> and allows the subscriber to access the account through a <em>federation transaction</em> with the IdP.</dd>
  <dt>security domain</dt>
  <dd>A set of systems under a common administrative and access control.</dd>
  <dt>session</dt>
  <dd>A persistent interaction between a subscriber and an <em>endpoint</em>, either an <em>RP</em> or a <em>CSP</em>. A session begins with an authentication event and ends with a session termination event. A session is bound by the use of a session secret that the subscriber’s software (e.g., a browser, application, or OS) can present to the RP to prove association of the session with the authentication event.</dd>
  <dt>session hijack attack</dt>
  <dd>An attack in which the attacker is able to insert themselves between a <em>claimant</em> and a <em>verifier</em> subsequent to a successful authentication exchange between the latter two parties. The attacker is able to pose as a subscriber to the verifier or vice versa to control <em>session</em> data exchange. Sessions between the claimant and the <em>RP</em> can be similarly compromised.</dd>
  <dt>single sign-on (SSO)</dt>
  <dd>An authentication process by which one account and its <em>authenticators</em> are used to access multiple applications in a seamless manner, generally implemented with a <em>federation protocol</em>.</dd>
  <dt>subject</dt>
  <dd>A person, organization, device, hardware, <em>network</em>, software, or service. In these guidelines, a subject is a <em>natural person</em>.</dd>
  <dt>subscriber</dt>
  <dd>An individual enrolled in the <em>CSP</em> identity service.</dd>
  <dt>subscriber account</dt>
  <dd>An account established by the <em>CSP</em> containing information and <em>authenticators</em> registered for each subscriber enrolled in the CSP identity service.</dd>
  <dt>symmetric key</dt>
  <dd>A <em>cryptographic key</em> used to perform both the cryptographic operation and its inverse. (e.g., to encrypt and decrypt or create a <em>message authentication code</em> and to verify the code).</dd>
  <dt>Transport Layer Security (TLS)</dt>
  <dd>An authentication and security protocol widely implemented in browsers and web servers. TLS is defined by <a href="/800-63-4/sp800-63c/references/#ref-RFC5246">[RFC5246]</a>. TLS is similar to the older SSL protocol, and TLS 1.0 is effectively SSL version 3.1. SP 800-52, Guidelines for the Selection and Use of Transport Layer Security (TLS) Implementations <a href="/800-63-4/sp800-63c/references/#ref-SP800-52">[SP800-52]</a>, specifies how TLS is to be used in government applications.</dd>
  <dt>trust agreement</dt>
  <dd>A set of conditions under which a <em>CSP</em>, <em>IdP</em>, and <em>RP</em> are allowed to participate in a <em>federation transaction</em> for the purposes of establishing an authentication <em>session</em> between the subscriber and the RP.</dd>
  <dt>usability</dt>
  <dd>The extent to which a product can be used by specified users to achieve specified goals with effectiveness, efficiency, and satisfaction in a specified context of use. <a href="/800-63-4/sp800-63c/references/#ref-ISOIEC9241">[ISO/IEC9241-11]</a></dd>
  <dt>verifier</dt>
  <dd>An entity that verifies the <em>claimant’s</em> identity by verifying the claimant’s possession and control of one or more <em>authenticators</em> using an <em>authentication protocol</em>. To do this, the verifier needs to confirm the binding of the authenticators with the <em>subscriber account</em> and check that the subscriber account is active.</dd>
</dl>

<h1 id="changelog" data-section="C">
  
  
    Changelog <a href="#changelog" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>

<p><em>This appendix is informative.</em> It provides an overview of the changes to SP 800-63C since its initial release.</p>

<ul>
  <li>
    <p>Added discussion of equity considerations and requirements.</p>
  </li>
  <li>
    <p>Established trust agreements and registration/discovery (key establishment) as discrete steps in the federation process.</p>
  </li>
  <li>
    <p>All FALs have requirements around establishment of trust agreements and registration.</p>
  </li>
  <li>
    <p>FAL definitions no longer have encryption requirements; encryption is triggered by passing PII in an assertion through an untrusted party regardless of FAL.</p>
  </li>
  <li>
    <p>FAL2 requires injection protection.</p>
  </li>
  <li>
    <p>FAL3 allows more general bound authenticators including RP-managed authenticators, in addition to classical holder-of-key assertions.</p>
  </li>
  <li>
    <p>Communication of IAL/AAL/FAL required.</p>
  </li>
  <li>
    <p>Updated language to be more inclusive.</p>
  </li>
  <li>
    <p>Added definition and discussion of RP subscriber accounts.</p>
  </li>
  <li>
    <p>Added attribute provisioning models and discussion.</p>
  </li>
  <li>
    <p>Subscriber-controlled wallet model added, with specific requirements separated from general-purpose IdPs.</p>
  </li>
  <li>
    <p>Restructured core document sections to address common, general-purpose, and subscriber-controlled wallet requirements in separate sections.</p>
  </li>
  <li>
    <p>Redress requirements for IdPs and RPs added.</p>
  </li>
  <li>
    <p>Enterprise and dynamic use cases added throughout, with explicit examples.</p>
  </li>
</ul>






  </div>
</div>
<footer role="contentInfo" class="site-footer">
  <div class="section-container">
    <div class="section-content">
    </div>
  </div>
</footer>

<script type="text/javascript">
    function loadSearch() {
        var sjs = SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/800-63-4/search.json'
        });
    }
    $(function() {
      
      // Convert all links to on-page within document in collapsed view
      $('.container a[href^="/800-63-4/sp800-63c/"], .container a[href^="../"]').filter('a[href*="#"]').each(function(i, el) {
          var $el = $(el);
          var newPath = $el.attr('href').replace(/(.*)(\#.+)/, "$2");
          //console.log('1: ' + $el.attr('href') + ' :: ' + newPath);
          $el.attr('href', newPath);
      });
      // Convert all cross-document links when in collapsed view
      $('.container a[href^="/800-63-4/"]').not('a[href*="sp800-63c/"]').each(function(i, el) {
          var $el = $(el);
          var newPath = $el.attr('href').replace(new RegExp('(/800-63-4)/([^/]+)(/.*)?/(#.*)?'), '$1/$2.html$4');
          //console.log('2: ' + $el.attr('href') + ' :: ' + newPath);
          $el.attr('href', newPath);
      });
      
      // highlight normative language by adding classes
      $('strong').filter(':contains("SHALL"), :contains("SHALL NOT"), :contains("SHOULD"), :contains("SHOULD NOT"), :contains("MAY"), :contains("NEED NOT"), :contains("CAN"), :contains("CANNOT"), :contains("CAPITALS")').each(function(i, el) {
        var $el;
        $el = $(el);
        $el.addClass('normative');
      });
      // highlight the target
      $('a:target').parent().addClass('target');
      $(':target').addClass('target');
      $(window).on('hashchange', function(e) {
        $('.target').removeClass('target');
        $('a:target').parent().addClass('target');
        $(':target').addClass('target');
      });
    });
</script>


</body>
</html>