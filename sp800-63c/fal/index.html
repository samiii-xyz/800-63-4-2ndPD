<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
    <link rel="canonical" href="/800-63-4/sp800-63c/fal/">

    <!-- Google Analytics -->
    <!--<script type="text/javascript" id="_fed_an_js_tag" src="http://www.nist.gov/js/federated-analytics.all.min.js?agency=NIST&subagency=mml&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script> -->
    <!-- DAP Analytics -->
    <script type="text/javascript" id="_fed_an_ua_tag"
            src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&subagency=NIST&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>

	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
	<script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript"></script>
	<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
	<script src="https://unpkg.com/simple-jekyll-search/dest/simple-jekyll-search.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/800-63-4/static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTStyle.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTPages.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <title>Federation Assurance Level</title>
    <meta property="og:title" content="Federation Assurance Level"/>
    

    
    <meta name="description" content="NIST Special Publication 800-63 Digital Identity Guidelines">
    <meta property="og:description" content="NIST Special Publication 800-63 Digital Identity Guidelines"/>
    
</head>


<body>

<nav class="navbar navbar-default navbar-fixed-left" role="navigation">
	<ul class="nav navbar-nav">
      <li id="search-box">
        <input type="text" id="search-input" placeholder="Search..." onFocus="loadSearch()">
        <ul id="results-container"></ul>
      </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/">Home</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63/introduction/">SP 800-63</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63a/introduction/">SP 800-63A</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63b/introduction/">SP 800-63B</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="active">
          
              <a href="/800-63-4/sp800-63c/introduction/">SP 800-63C</a>
          
          
          
        
            
            
            
            <ul class="subnav">
            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/abstract/">Abstract</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/reviewers/">Reviewers</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/preface/">Preface</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/introduction/"><span class="section">1</span>Introduction</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class="active"><a href="/800-63-4/sp800-63c/fal/"><span class="section">2</span>FAL</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/Federation/"><span class="section">3</span>Federation</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/GenIdP/"><span class="section">4</span>General-Purpose IdP</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/Wallets/"><span class="section">5</span>Wallets</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/security/"><span class="section">6</span>Security</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/privacy/"><span class="section">7</span>Privacy</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/usability/"><span class="section">8</span>Usability</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/equity/"><span class="section">9</span>Equity</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/examples/"><span class="section">10</span>Examples</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/references/">References</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/abbreviations/"><span class="section">A</span>Abbreviations</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/glossary/"><span class="section">B</span>Glossary</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63c/changelog/"><span class="section">C</span>Changelog</a></li>
                
              
              

            
          
            </ul>
          
          
          
        </li>
      
      
      
  </ul>

</nav>


<div class="page-switch">

View this document as: <a href="/800-63-4/sp800-63c.html">a single page</a> | <b>multiple pages</b>.

</div>

<div class="container">
  <div class="row">





  

  

<h1 id="fal" data-section="2">
  
  
    Federation Assurance Level (FAL) <a href="#fal" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>
    

<p><em>This section is normative.</em></p>

<p>This section defines <em>federation assurance levels</em> (FALs) and the requirements for securing federation transactions at each FAL. In order to fulfill the requirements for a a given FAL, the federation transaction <strong>SHALL</strong> meet or exceed all requirements listed for that FAL.</p>

<p>Each FAL is characterized by a set of requirements that increase the security and complexity as the FAL increases. These requirements are listed here and expanded in other sections of this document:</p>

<dl>
  <dt>Audience Restriction</dt>
  <dd>The assertion presented in the federation protocol is targeted to a specific RP and the RP can confirm that it is the intended audience of the assertion.</dd>
  <dt>Injection Protection</dt>
  <dd>The RP is strongly protected from an attacker presenting an assertion in circumstances outside a current federation transaction request. (See <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a> for details on injection protection.)</dd>
  <dt>Trust Agreement Establishment</dt>
  <dd>The agreement to participate in a federation transaction for the purposes of creating an authenticated session for the subscriber at the RP. (See <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> for details of the trust agreement.)</dd>
  <dt>Identifier and Key Establishment</dt>
  <dd>The IdP and RP have exchanged identifiers and key material to allow for the verification of assertions and other artifacts during future federation transactions. (See <a href="/800-63-4/sp800-63c/Federation/#identifiers-keys">Sec. 3.5</a> for details of key establishment.)</dd>
  <dt>Presentation</dt>
  <dd>The assertion can be presented to the RP either on its own (as a bearer assertion) or in concert with an authenticator presented by the subscriber.</dd>
</dl>

<p><a href="/800-63-4/sp800-63c/fal/#table-1">Table 1</a> provides a non-normative summary of aspects for each FAL. Each successive level subsumes and fulfills all requirements of lower levels (e.g., a federation process at FAL3 can be accepted at FAL2 or FAL1 since FAL3 satisfies all the requirements of these lower levels). Combinations not found in <a href="/800-63-4/sp800-63c/fal/#table-1">Table 1</a> are possible, and agencies can choose to implement stronger protections in one or more areas of requirements at a given FAL.</p>

<p latex-ignore="true"><a href="/800-63-4/sp800-63c/fal/#table-1" name="table-1">Table 1. Federation Assertion Levels</a></p>

<table latex-table="1" latex-caption="Federation Assurance Levels">
  <thead>
    <tr>
      <th style="text-align: center">Requirement</th>
      <th>FAL1</th>
      <th>FAL2</th>
      <th>FAL3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Audience Restriction</td>
      <td>Multiple RPs allowed per assertion, Single RP per assertion recommended</td>
      <td>Single RP per assertion</td>
      <td>Single RP per assertion</td>
    </tr>
    <tr>
      <td style="text-align: center">Injection Protection</td>
      <td>Recommended for all transactions</td>
      <td>Required; transaction begins at the RP</td>
      <td>Required; transaction begins at the RP</td>
    </tr>
    <tr>
      <td style="text-align: center">Trust Agreement Establishment</td>
      <td>Subscriber-driven or A priori</td>
      <td>A priori</td>
      <td>A priori</td>
    </tr>
    <tr>
      <td style="text-align: center">Identifier and Key Establishment</td>
      <td>Dynamic or Static</td>
      <td>Dynamic or Static</td>
      <td>Static</td>
    </tr>
    <tr>
      <td style="text-align: center">Presentation</td>
      <td>Bearer Assertion</td>
      <td>Bearer Assertion</td>
      <td>Holder-of-Key Assertion or Bound Authenticator</td>
    </tr>
  </tbody>
</table>

<p>While many different federation implementation options are possible, the FAL is intended to provide clear guidance representing increasingly secure deployment options. See <a href="/800-63-4/sp800-63/introduction/#introduction" latex-href="#ref-SP800-63">[SP800-63]</a> for details on how to choose the most appropriate FAL.</p>

<blockquote>
  <p>Note: In these guidelines, assertions, attribute bundles, and other elements of the federation protocol are protected by asymmetric digital signatures or symmetric MACs. When either asymmetric or symmetric cryptography is specifically required, the terms “sign” and “signature” will be qualified as appropriate to indicate the requirement. When either option is possible, the terms “sign” and “signature” are used without a qualifier.</p>
</blockquote>
<h2 id="falcommon" data-section="2">
  
  
    Common FAL Requirements <a href="#falcommon" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>At all FALs, all federation transactions <strong>SHALL</strong> comply with the requirements in <a href="/800-63-4/sp800-63c/Federation/#common">Sec. 3</a> to deliver an assertion to the RP and create an authenticated session at the RP. Examples of assertions used in federation protocols include the ID Token in OpenID Connect <a href="/800-63-4/sp800-63c/references/#ref-OIDC">[OIDC]</a> and the Security Assertion Markup Language <a href="/800-63-4/sp800-63c/references/#ref-SAML">[SAML]</a> Assertion format.</p>

<p>At all FALs, the RP needs to trust the IdP to provide valid assertions representing the subscriber’s authentication event and <strong>SHALL</strong> validate the assertion.</p>

<p>IdPs and RPs <strong>SHALL</strong> employ appropriately tailored security controls from the moderate baseline security controls defined in <a href="/800-63-4/sp800-63c/references/#ref-SP800-53">[SP800-53]</a> or an equivalent federal (e.g., <a href="/800-63-4/sp800-63c/references/#ref-FEDRAMP">[FEDRAMP]</a>) or industry standard that the organization has determined for the information systems, applications, and online services that these guidelines are used to protect. IdPs and RPs <strong>SHALL</strong> ensure that the minimum assurance-related controls for the appropriate systems, or equivalent, are satisfied. Additional security controls are discussed in <a href="/800-63-4/sp800-63c/Federation/#security-controls">Sec. 3.10</a>.</p>

<p>If no FAL is specified by the trust agreement or federation transaction, the requirements of this section still apply.</p>

<p>An IdP or RP can be capable of operating at multiple FALs simultaneously, depending on use case and needs. For example, an IdP could provide FAL3 federation transactions to a high-risk RP while providing FAL2 to an RP with a lower risk profile. Similarly, an RP could require FAL2 for normal actions but require the subscriber to re-authenticate with FAL3 for higher impact or more sensitive actions. This capability extends to other dimensions, as an IdP could simultaneously have access to subscriber accounts that have been proofed at any IAL and allow authentication at any AAL. However, an RP talking to that IdP could have restrictions on the lowest IAL and AAL it is willing to accept for access. As a consequence, it is imperative that the trust agreement establish the xALs allowed and required for different use cases.</p>
<h2 id="fal1" data-section="2">
  
  
    Federation Assurance Level 1 (FAL1) <a href="#fal1" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>FAL1 provides a basic level of protection for federation transactions, allowing for a wide range of use cases and deployment decisions.</p>

<p>At FAL1, the IdP <strong>SHALL</strong> sign the assertion using approved cryptography. The RP <strong>SHALL</strong> validate the signature using the key associated with the expected IdP. The signature protects the integrity of the assertion contents and allows for the IdP to be verified as the source of the assertion.</p>

<p>All assertions at FAL1 <strong>SHALL</strong> be audience-restricted to a specific RP or set of RPs, and the RP <strong>SHALL</strong> validate that it is one of the targeted RPs for the given assertion.</p>

<p>At FAL1, the trust agreement <strong>MAY</strong> be established by the subscriber during the federation transaction. Note that at FAL1, it is still possible for the trust agreement to be established a priori by the RP and IdP.</p>

<p>At FAL1, the federation protocol <strong>SHOULD</strong> apply injection protection as discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>. The federation transaction <strong>SHOULD</strong> be initiated by the RP.</p>
<h2 id="fal2" data-section="2">
  
  
    Federation Assurance Level 2 (FAL2) <a href="#fal2" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>FAL2 provides a high level of protection for federation transactions, providing protections against a variety of attacks against federated systems. All the requirements for FAL1 apply at FAL2 except where overridden by more specific or stringent requirements here.</p>

<p>At FAL2, the assertion <strong>SHALL</strong> be strongly protected from injection attacks, as discussed in <a href="/800-63-4/sp800-63c/Federation/#injection-protection">Sec. 3.10.1</a>. The federation transaction <strong>SHALL</strong> be initiated by the RP.</p>

<p>At FAL2, the assertion <strong>SHALL</strong> audience restricted to a single RP.</p>

<p>At FAL2, an a priori trust agreement <strong>SHALL</strong> be established prior to the federation transaction taking place.</p>

<p>IdPs operated by or on behalf of federal agencies that present assertions at FAL2 or higher <strong>SHALL</strong> protect keys used for signing or encrypting those assertions with mechanisms validated at <a href="/800-63-4/sp800-63c/references/#ref-FIPS140">[FIPS140]</a> Level 1 or higher.</p>
<h2 id="fal3" data-section="2">
  
  
    Federation Assurance Level 3 (FAL3) <a href="#fal3" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>FAL3 provides a very high level of protection for federation transactions, establishing very high confidence that the subscriber asserted by the IdP is the subscriber present in the authenticated session. All the requirements at FAL1 and FAL2 apply at FAL3 except where overridden by more specific or stringent requirements here.</p>

<p>At FAL3, the RP <strong>SHALL</strong> verify that the subscriber is in control of an authenticator in addition to the assertion. This authenticator is either identified in a holder-of-key assertion as described in <a href="/800-63-4/sp800-63c/Federation/#idp-managed-bound-authn">Sec 3.14</a> or is a bound authenticator as described in <a href="/800-63-4/sp800-63c/Federation/#bound-authn">Sec. 3.15</a>.</p>

<p>At FAL3, the trust agreement <strong>SHALL</strong> be established such that the IdP can identify and trust the RP to abide by all aspects of the trust agreement prior to any federation transaction taking place. To facilitate this, the key material used to authenticate the RP and IdP to each other is associated with the identifiers for the RP and IdP in a static fashion using a trusted mechanism. For example, a public key file representing the RP is uploaded to the IdP during a static registration process, and the RP downloads the IdP’s public key from a URL indicated in the trust agreement. Alternatively, the trust agreement can dictate that the RP and IdP can upload their respective public keys to a federation authority and then download each other’s keys from that same trusted authority.</p>

<p>IdPs operated by or on behalf of federal agencies that present assertions at FAL3 <strong>SHALL</strong> protect keys used for signing or encrypting those assertions with mechanisms validated at <a href="/800-63-4/sp800-63c/references/#ref-FIPS140">[FIPS140]</a> Level 1 or higher.</p>
<h2 id="request-xals" data-section="2">
  
  
    Requesting and Processing xALs <a href="#request-xals" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>Since an IdP is capable of asserting the identities of many different subscribers with a variety of authenticators using a variety of federation parameters, the IAL, AAL, and FAL could vary across different federation transactions, even to the same RP.</p>

<p>IdPs <strong>SHALL</strong> support a mechanism for RPs to specify a set of minimum acceptable xALs as part of the trust agreement and <strong>SHOULD</strong> support the RP specifying a more strict minimum set at runtime as part of the federation transaction. When an RP requests a particular xAL, the IdP <strong>SHOULD</strong> fulfill that request, if possible, and <strong>SHALL</strong> indicate the resulting xAL in the assertion. For example, if the subscriber has an active session that was authenticated at AAL1, but the RP has requested AAL2, the IdP needs to prompt the subscriber for AAL2 authentication to step up the security of the session at the IdP during the subscriber’s interaction at the IdP, if possible. The IdP sends the resulting AAL as part of the returned assertion, whether it is AAL1 (the step-up authentication was not met) or AAL2 (the step-up authentication was met successfully).</p>

<p>The IdP <strong>SHALL</strong> inform the RP of the following information for each federation transaction:</p>

<ul>
  <li>The IAL of the subscriber account being presented to the RP, or an indication that no IAL claim is being made</li>
  <li>The AAL of the currently active session of the subscriber at the IdP, or an indication that no AAL claim is being made</li>
  <li>The FAL of the federation transaction</li>
</ul>

<p>The RP gets this xAL information from a combination of the terms of the trust agreement as described in <a href="/800-63-4/sp800-63c/Federation/#trust-agreement">Sec. 3.4</a> and information included in the assertion as described in <a href="/800-63-4/sp800-63c/GenIdP/#assertions">Sec. 4.9</a> and <a href="/800-63-4/sp800-63c/Wallets/#assertion-contents">Sec. 5.8</a>. If the xAL is unchanging for all messages between the IdP and RP, the xAL information <strong>SHALL</strong> be included in the terms of the trust agreement between the IdP and RP. If the xAL could be within a range of possible values specified by the trust agreement, the xAL information <strong>SHALL</strong> be included as part of the assertion contents.</p>

<p>The IdP <strong>MAY</strong> indicate that no claim is made to the IAL or AAL for a given federation transaction. In such cases, no default value is assigned to the resulting xAL by the RP. That is to say, a federation transaction without an IAL declaration in either the trust agreement or the assertion is functionally considered to have “no IAL” and the RP cannot assume the account meets “IAL1”, the lowest numbered IAL described in this suite.</p>

<p>The RP <strong>SHALL</strong> determine the minimum IAL, AAL, and FAL it is willing to accept for access to any offered functionality. An RP <strong>MAY</strong> vary its functionality based on the IAL, AAL, and FAL of a specific federated authentication. For example, an RP can allow federation transactions at AAL2 for common functionality (e.g., viewing the status of a dam system) but require AAL3 be used for higher risk functionality (e.g., changing the flow rates of a dam system). Similarly, an RP could restrict management functionality to only certain subscriber accounts which have been identity proofed at IAL2, while allowing federation transactions from all subscriber accounts regardless of IAL.</p>

<p>In a federation process, only the IdP has direct access to the details of the subscriber account, which determines the applicable IAL, and the authentication event at the IdP, which determines the applicable AAL. Consequently, the IdP declares the IAL, AAL, and intended FAL for each federation transaction.</p>

<p>The RP <strong>SHALL</strong> ensure that it meets its obligations in the federation transaction for the FAL declared in the assertion. For example, the RP needs to ensure the presentation method meets the injection protection requirements at FAL2 and above, and that the appropriate bound authenticator is presented at FAL3.</p>


  



  </div>
</div>
<footer role="contentInfo" class="site-footer">
  <div class="section-container">
    <div class="section-content">
    </div>
  </div>
</footer>

<script type="text/javascript">
    function loadSearch() {
        var sjs = SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/800-63-4/search.json'
        });
    }
    $(function() {
      
      // highlight normative language by adding classes
      $('strong').filter(':contains("SHALL"), :contains("SHALL NOT"), :contains("SHOULD"), :contains("SHOULD NOT"), :contains("MAY"), :contains("NEED NOT"), :contains("CAN"), :contains("CANNOT"), :contains("CAPITALS")').each(function(i, el) {
        var $el;
        $el = $(el);
        $el.addClass('normative');
      });
      // highlight the target
      $('a:target').parent().addClass('target');
      $(':target').addClass('target');
      $(window).on('hashchange', function(e) {
        $('.target').removeClass('target');
        $('a:target').parent().addClass('target');
        $(':target').addClass('target');
      });
    });
</script>


</body>
</html>