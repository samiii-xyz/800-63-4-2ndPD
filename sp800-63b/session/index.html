<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
    <link rel="canonical" href="/800-63-4/sp800-63b/session/">

    <!-- Google Analytics -->
    <!--<script type="text/javascript" id="_fed_an_js_tag" src="http://www.nist.gov/js/federated-analytics.all.min.js?agency=NIST&subagency=mml&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script> -->
    <!-- DAP Analytics -->
    <script type="text/javascript" id="_fed_an_ua_tag"
            src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DOC&subagency=NIST&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>

	<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
	<script src="https://code.jquery.com/jquery-3.6.2.min.js" type="text/javascript"></script>
	<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
	<script src="https://unpkg.com/simple-jekyll-search/dest/simple-jekyll-search.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/800-63-4/static/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTStyle.css">
    <link rel="stylesheet" href="/800-63-4/static/css/NISTPages.css">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <title>Session Management</title>
    <meta property="og:title" content="Session Management"/>
    

    
    <meta name="description" content="NIST Special Publication 800-63 Digital Identity Guidelines">
    <meta property="og:description" content="NIST Special Publication 800-63 Digital Identity Guidelines"/>
    
</head>


<body>

<nav class="navbar navbar-default navbar-fixed-left" role="navigation">
	<ul class="nav navbar-nav">
      <li id="search-box">
        <input type="text" id="search-input" placeholder="Search..." onFocus="loadSearch()">
        <ul id="results-container"></ul>
      </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/">Home</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63/introduction/">SP 800-63</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63a/introduction/">SP 800-63A</a>
          
          
          
          
          
        </li>
      
        
        
        
        <li class="active">
          
              <a href="/800-63-4/sp800-63b/introduction/">SP 800-63B</a>
          
          
          
        
            
            
            
            <ul class="subnav">
            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/abstract/">Abstract</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/reviewers/">Reviewers</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/preface/">Preface</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/introduction/"><span class="section">1</span>Introduction</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/aal/"><span class="section">2</span>AAL</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/authenticators/"><span class="section">3</span>Authenticators</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/events/"><span class="section">4</span>Events</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class="active"><a href="/800-63-4/sp800-63b/session/"><span class="section">5</span>Session</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/security/"><span class="section">6</span>Security</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/privacy/"><span class="section">7</span>Privacy</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/usability/"><span class="section">8</span>Usability</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/equity/"><span class="section">9</span>Equity</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/references/">References</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/passwords/"><span class="section">A</span>Passwords</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/syncable/"><span class="section">B</span>Syncable</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/abbreviations/"><span class="section">C</span>Abbreviations</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/glossary/"><span class="section">D</span>Glossary</a></li>
                
              
              

            
              
              
              
                
                
                
                
                
                    <li class=""><a href="/800-63-4/sp800-63b/changelog/"><span class="section">E</span>Change Log</a></li>
                
              
              

            
          
            </ul>
          
          
          
        </li>
      
        
        
        
        <li class="">
          
              <a href="/800-63-4/sp800-63c/introduction/">SP 800-63C</a>
          
          
          
          
          
        </li>
      
      
      
  </ul>

</nav>


<div class="page-switch">

View this document as: <a href="/800-63-4/sp800-63b.html">a single page</a> | <b>multiple pages</b>.

</div>

<div class="container">
  <div class="row">





  

  

<h1 id="sec7" data-section="5">
  
  
    Session Management <a href="#sec7" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h1>
    

<p><em>This section is normative.</em></p>

<p>Once an authentication event has occurred, it is often desirable to allow the subscriber to continue using the application across multiple subsequent interactions without requiring them to repeat the authentication event. This is particularly the case with federation scenarios (described in <a href="/800-63-4/sp800-63c/introduction/#introduction" latex-href="#ref-SP800-63C">[SP800-63C]</a>) in which the authentication event necessarily involves the coordination of several components and parties across a network.</p>

<p>To facilitate this behavior, a <em>session</em> <strong>MAY</strong> be started in response to an authentication event and continue until it is terminated. The session <strong>MAY</strong> be terminated for any number of reasons, including but not limited to an inactivity timeout or an explicit logout event. The session <strong>MAY</strong> be extended through a reauthentication event (described in <a href="/800-63-4/sp800-63b/session/#sessionreauthn">Sec. 5.2</a>) in which the subscriber repeats some of the initial authentication process or performs a full authentication, thereby reestablishing the authenticated session.</p>

<p>Session management is preferable to the continual presentation of credentials, as the poor usability of continual presentation often creates incentives for workarounds (e.g., caching activation factors), thereby negating authentication intent and obscuring the freshness of the authentication event.</p>
<h2 id="session-bindings" data-section="5">
  
  
    Session Bindings <a href="#session-bindings" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>A session occurs between the software (i.e., the session subject) that a subscriber is running (e.g., browser, application, or operating system) and the RP or CSP that the subscriber is accessing (i.e., the session host). A session secret <strong>SHALL</strong> be shared between the subscriber’s software and the accessed service. This secret binds the two ends of the session and allows the subscriber to continue using the service over time. The secret <strong>SHALL</strong> be presented directly by the subscriber’s software, or possession of the secret <strong>SHALL</strong> be proven using a cryptographic mechanism.</p>

<p>The continuity of authenticated sessions <strong>SHALL</strong> be based upon the possession of a session secret that is issued by the verifier at the time of authentication and optionally refreshed during the session. The nature of a session depends on the application, such as:</p>

<ul>
  <li>A web browser session with a “session” cookie or</li>
  <li>An instance of a mobile application that retains a session secret.</li>
</ul>

<p>Session secrets <strong>SHOULD NOT</strong> be persistent (i.e., retained across a restart of the associated application or a reboot of the host device) because they are tied to specific sessions that a restart or reboot would end. Cookies and similar “remember my browser” features <strong>SHALL NOT</strong> be used instead of authentication except as provided for reauthentication at AAL2 in <a href="/800-63-4/sp800-63b/session/#aal2reauth">Sec. 2.2.3</a> when the inactivity limit has been exceeded but the time limit has not.</p>

<p>The secret used for session binding <strong>SHALL</strong> be generated by the session host in direct response to an authentication event. A session <strong>SHOULD</strong> inherit the AAL properties of the authentication event that triggered its creation. A session <strong>MAY</strong> be considered at a lower AAL than the authentication event but <strong>SHALL NOT</strong> be considered at a higher AAL than the authentication event.</p>

<p>The secrets used for session binding <strong>SHALL</strong> meet all of the following requirements:</p>

<ol>
  <li>Secrets are established during or immediately following authentication.</li>
  <li>Secrets are established using input from an approved random bit generator as described in <a href="/800-63-4/sp800-63b/authenticators/#randomness">Sec. 3.2.12</a>, and are at least 64 bits in length.</li>
  <li>Secrets are erased or invalidated by the session subject when the subscriber logs out.</li>
  <li>Secrets are either transferred from the session host to the RP or CSP via an authenticated protected channel or derived from keys that are established as part of establishing a valid, mutually authenticated protected channel.</li>
  <li>Secrets will time out and are not accepted after the times specified in <a href="/800-63-4/sp800-63b/aal/#aal1reauth">Sec. 2.1.3</a>, <a href="/800-63-4/sp800-63b/aal/#aal2reauth">Sec. 2.2.3</a>, and <a href="/800-63-4/sp800-63b/aal/#aal3reauth">Sec. 2.3.3</a>, as appropriate for the AAL.</li>
  <li>Secrets are unavailable to intermediaries between the host and the subscriber’s endpoint.</li>
</ol>

<p>In addition, secrets used for session binding <strong>SHOULD</strong> be erased on the subscriber endpoint when they log out or when the secret is deemed to have expired. They <strong>SHOULD NOT</strong> be placed in insecure locations (e.g., HTML5 Local Storage) due to the potential exposure of local storage to cross-site scripting (XSS) attacks.</p>

<p>Following authentication, authenticated sessions <strong>SHALL NOT</strong> fall back to an insecure transport (e.g., from https to http).</p>

<p>POST/PUT content <strong>SHALL</strong> contain a session identifier that the RP <strong>SHALL</strong> verify to protect against cross-site request forgery.</p>

<p>Several mechanisms exist for managing a session over time. The following sections give different examples, additional requirements, and considerations for each example technology. Additional informative guidance is available in the OWASP <em>Session Management Cheat Sheet</em> <a href="/800-63-4/sp800-63b/references/#ref-OWASP-session">[OWASP-session]</a>.</p>

<p>Sessions <strong>SHOULD</strong> provide a readily accessible mechanism for subscribers to terminate (i.e., log off) their session when their interaction is complete. Session logoff gives the subscriber additional confidence and control over the security of their session, particularly in situations where the endpoint might be accessible to others.</p>
<h3 id="sesscookies" data-section="5">
  
  
    Browser Cookies <a href="#sesscookies" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>
    

<p>Browser cookies are the predominant mechanism by which a session is created and tracked when a subscriber accesses a service. Cookies are not authenticators but are suitable as short-term secrets for the duration of a session.</p>

<p>Cookies used for session maintenance:</p>

<ol>
  <li><strong>SHALL</strong> be tagged to be accessible only on secure (HTTPS) sessions.</li>
  <li><strong>SHALL</strong> be accessible to the minimum practical hostnames and paths.</li>
  <li><strong>SHOULD</strong> be tagged as inaccessible via JavaScript (HttpOnly).</li>
  <li><strong>SHOULD</strong> be tagged to expire at or soon after the session’s validity period. This requirement is intended to limit the accumulation of cookies but <strong>SHALL NOT</strong> be relied upon to enforce session timeouts.</li>
  <li><strong>SHOULD</strong> have the “__Host-“ prefix and set “Path=/”.</li>
  <li><strong>SHOULD</strong> set “SameSite=Lax” or “SameSite=Strict”.</li>
  <li><strong>SHOULD</strong> contain only an opaque string (e.g., a session identifier) and <strong>SHALL NOT</strong> contain cleartext personal information.</li>
</ol>
<h3 id="access-tokens" data-section="5">
  
  
    Access Tokens <a href="#access-tokens" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h3>
    

<p>An access token (e.g., OAuth <a href="/800-63-4/sp800-63b/references/#ref-rfc6749">[RFC6749]</a>) is used to allow an application to access a set of services on a subscriber’s behalf following an authentication event. The RP <strong>SHALL NOT</strong> interpret the presence of an OAuth access token as an indicator of the subscriber’s presence in the absence of other signals. The OAuth access token and any associated refresh tokens could be valid long after the authentication session has ended and the subscriber has left the application.</p>
<h2 id="sessionreauthn" data-section="5">
  
  
    Reauthentication <a href="#sessionreauthn" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>Periodic reauthentication of sessions <strong>SHALL</strong> be performed to confirm the subscriber’s continued presence at an authenticated session (i.e., that the subscriber has not walked away without logging out).</p>

<p>Session management uses two types of timeouts. An <em>overall timeout</em> limits the duration of an authenticated session to a specific period following authentication or a previous reauthentication. An <em>inactivity timeout</em> terminates a session without activity from the subscriber for a specific period. For both types of timeouts, the RP <strong>MAY</strong> alert the subscriber that the session is about to be terminated and allow the subscriber to make the session active or reauthenticate as appropriate before the session expires. When either timeout expires, the session <strong>SHALL</strong> be terminated. Session activity <strong>SHALL</strong> reset the inactivity timeout, and successful reauthentication during a session <strong>SHALL</strong> reset both timeouts.</p>

<p>The overall and inactivity timeout expiration limits depend on several factors, including the AAL of the session, the environment in which the session is conducted (e.g., whether the subscriber is in a restricted area), the type of endpoint being used (e.g., mobile application or web-based), whether the endpoint is a managed device<sup id="fnref:managed" role="doc-noteref"><a href="#fn:managed" class="footnote">1</a></sup>, and the nature of the application itself. Agencies <strong>SHALL</strong> establish and document the inactivity and overall time limits being enforced in a system security plan such as that described in <a href="/800-63-4/sp800-63b/references/#ref-SP800-39">[SP800-39]</a>.</p>

<p>Detailed requirements for each AAL are given in <a href="/800-63-4/sp800-63b/aal/#aal1reauth">Sec. 2.1.3</a>, <a href="/800-63-4/sp800-63b/aal/#aal2reauth">Sec. 2.2.3</a>, and <a href="/800-63-4/sp800-63b/aal/#aal3reauth">Sec. 2.3.3</a>.</p>

<p>Special considerations apply to session management and reauthentication when using a federation protocol and IdP to authenticate at the RP, as described in <a href="/800-63-4/sp800-63c/introduction/#introduction" latex-href="#ref-SP800-63C">[SP800-63C]</a>, special considerations apply to session management and reauthentication. The federation protocol communicates an authentication event at the IdP to the RP using an assertion, and the RP then begins an authenticated session based on the successful validation of this assertion. Since the IdP and RP manage sessions separately from each other and the federation protocol does not connect the session management between the IdP and RP, the termination of the subscriber’s sessions at an IdP and an RP are independent of each other. Likewise, the subscriber’s sessions at multiple different RPs are established and terminated independently of each other.</p>

<p>Consequently, when an RP session expires and the RP requires reauthentication, it is possible that the session at the IdP has not expired and that a new assertion could be generated from this session at the IdP without explicitly reauthenticating the subscriber. The IdP can communicate the time and details of the authentication event to the RP, but it is up to the RP to determine whether the reauthentication requirements have been met. <a href="/800-63-4/sp800-63c/GenIdP/#federation-session" latex-href="#ref-SP800-63C">Section 4.7 of [SP800-63C]</a> provides additional details and requirements for session management within a federation context.</p>

<div latex-literal="true" class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\clearpage
</code></pre></div></div>
<h2 id="monitoring" data-section="5">
  
  
    Session Monitoring <a href="#monitoring" class="header-link"><i class="fa fa-link"></i></a>
  
  
</h2>
    

<p>Session monitoring (sometimes called <em>continuous authentication</em>) is the ongoing evaluation of session characteristics to detect possible fraud during a session.</p>

<p>Session monitoring <strong>MAY</strong> be performed by the RP, in coordination with the CSP/verifier, as a risk reduction measure. When potential fraud is detected during a session, the RP <strong>SHOULD</strong> take action in conjunction with the CSP/verifier, such as to reauthenticate, terminate the session, or notify appropriate support personnel. Session characteristics that <strong>MAY</strong> be evaluated include:</p>

<ul>
  <li>Usage patterns, velocity, and timing</li>
  <li>Behavioral biometric characteristics (e.g., typing cadence)</li>
  <li>Device and browser characteristics</li>
  <li>Geolocation</li>
  <li>IP address characteristics (e.g., whether the IP address is in a block known for abuse)</li>
</ul>

<p>Most of these characteristics have privacy implications. Collection, storage of expected subscriber characteristics, and processing of session characteristics <strong>SHALL</strong> be included in the privacy risk assessment described in <a href="/800-63-4/sp800-63b/privacy/#sec9">Sec. 7</a>.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:managed" role="doc-endnote">
      <p>Managed devices include personal computers, laptops, mobile devices, virtual machines, or infrastructure components that are equipped with a management agent that allows information technology staff to discover, maintain, and control them. <a href="#fnref:managed" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>


  



  </div>
</div>
<footer role="contentInfo" class="site-footer">
  <div class="section-container">
    <div class="section-content">
    </div>
  </div>
</footer>

<script type="text/javascript">
    function loadSearch() {
        var sjs = SimpleJekyllSearch({
          searchInput: document.getElementById('search-input'),
          resultsContainer: document.getElementById('results-container'),
          json: '/800-63-4/search.json'
        });
    }
    $(function() {
      
      // highlight normative language by adding classes
      $('strong').filter(':contains("SHALL"), :contains("SHALL NOT"), :contains("SHOULD"), :contains("SHOULD NOT"), :contains("MAY"), :contains("NEED NOT"), :contains("CAN"), :contains("CANNOT"), :contains("CAPITALS")').each(function(i, el) {
        var $el;
        $el = $(el);
        $el.addClass('normative');
      });
      // highlight the target
      $('a:target').parent().addClass('target');
      $(':target').addClass('target');
      $(window).on('hashchange', function(e) {
        $('.target').removeClass('target');
        $('a:target').parent().addClass('target');
        $(':target').addClass('target');
      });
    });
</script>


</body>
</html>